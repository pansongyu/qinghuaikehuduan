{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\script\\ui\\uiChild/assets\\script\\ui\\uiChild\\club_room_child.js"],"names":["cc","Class","extends","require","properties","bg_join","SpriteFrame","bg_touxiang","OnCreateInit","FormManager","app","ShareDefine","HeroManager","heroName","GetHeroProperty","heroId","WeChatManager","ComTool","LocalDataManager","gameCreateConfig","SysDataManager","GetTableDict","GetTuiGuangUrl","TuiGuangUrl","GetConfigProperty","heroID","ShortHeroID","GetPid","long_url","NetManager","SendPack","GetShorTuiGuangUrl","bind","FailTuiGuangUrl","serverPack","randUrl","GetRandBaseUrl","SetConfigProperty","requestUrl","jsonStr","replace","ShareUrl","eval","url_short","InitShowInfo","clubroomList","userData","GetFormProperty","roomData","SetRoomInfo","ShowPlayer","OnShow","node","active","InitJoinBtn","playerList","i","length","PlayerInfo","headImageUrl","touxiang","GetWndNode","InitHeroHeadImage","WeChatHeadImage","getComponent","OnLoad","ShowHeroHead","Sprite","spriteFrame","ShowRoomJoin","ShowForm","key","gameType","posList","roomCfg","roomID","roomKey","playerNum","clubName","setID","Array","pid","push","toLowerCase","gameCfg","SetWndProperty","setCount","GameType2Name","GetWanFa","height","gameTypeID","GametTypeNameDict","GametTypeID2Name","getChildByName","j","getCurSelectRenShu","needIndex","GetHasPlayerNum","nowJoin","Click_btn_Share","GamePlayManager","WeChatShare","title","weChatAppShareUrl","joinPlayerCount","gamedesc","autoCardIdx","que","teshuwanfan","WanFa","console","log","BeginShare","text","ShareText","SuccessTcnUrl","FailTcnUrl","shareUrl","SDKManager","event","OnClick_Join","SysNotifyManager","ShowSysMsg","Client","JoinRoomCheckSubGame","wanfa","RoomCfgManager","substring"],"mappings":"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","file":"club_room_child.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\script\\ui\\uiChild","sourcesContent":["/*\n UIGMTool_Child2 GM工具子界面\n */\n\ncc.Class({\n    extends: require(\"BaseChildForm\"),\n\n    properties: {\n        bg_join:cc.SpriteFrame,\n        bg_touxiang:cc.SpriteFrame,\n    },\n\n    //创建界面回掉\n    OnCreateInit:function(){\n        this.FormManager = app.FormManager();\n        this.ShareDefine = app.ShareDefine();\n        this.HeroManager=app.HeroManager();\n        this.heroName = this.HeroManager.GetHeroProperty(\"name\");\n        this.heroId=this.HeroManager.GetHeroProperty(\"pid\");\n        this.WeChatManager = app.WeChatManager();\n        this.ComTool = app.ComTool();\n        this.LocalDataManager=app.LocalDataManager();\n        this.gameCreateConfig = this.SysDataManager.GetTableDict(\"gameCreate\");\n        this.GetTuiGuangUrl();\n    },\n    //获取用户推广Url\n    GetTuiGuangUrl:function(){\n        this.TuiGuangUrl = this.LocalDataManager.GetConfigProperty(\"SysSetting\", \"TuiGuangUrl\");\n        if(this.TuiGuangUrl == ''){\n            let heroID = app.HeroManager().GetHeroProperty(\"pid\");\n            let ShortHeroID=this.ComTool.GetPid(heroID);\n            let long_url=\"http://api.t.sina.com.cn/short_url/shorten.json?source=3271760578&url_long=https://fb.qicaiqh.com:88/\"+ShortHeroID+'/';\n            app.NetManager().SendPack(\"game.CShortenGenerate\",{\"url\":long_url},this.GetShorTuiGuangUrl.bind(this),this.FailTuiGuangUrl.bind(this));\n        }\n    },\n    FailTuiGuangUrl:function(serverPack){\n        let heroID = app.HeroManager().GetHeroProperty(\"pid\");\n        let ShortHeroID=this.ComTool.GetPid(heroID);\n        let randUrl=this.GetRandBaseUrl();\n        this.TuiGuangUrl='http://'+randUrl+\"/\"+ShortHeroID+\"/\";\n        this.LocalDataManager.SetConfigProperty(\"SysSetting\", \"TuiGuangUrl\",this.TuiGuangUrl);\n    },\n    GetShorTuiGuangUrl:function(serverPack){\n        if(typeof(serverPack.requestUrl)==\"undefined\"){\n            return;\n        }\n        let jsonStr=serverPack.requestUrl;\n        jsonStr=jsonStr.replace('[','');\n        jsonStr=jsonStr.replace(']','');\n        let ShareUrl=eval('(' + jsonStr + ')');\n        this.TuiGuangUrl=ShareUrl.url_short;\n        this.LocalDataManager.SetConfigProperty(\"SysSetting\", \"TuiGuangUrl\",this.TuiGuangUrl);\n\n    },\n    InitShowInfo:function () {\n        let clubroomList=app['clubroomList'];\n        let userData = this.GetFormProperty(\"UserData\");\n        let roomData=clubroomList[userData];\n        this.roomData=roomData;\n        this.SetRoomInfo(userData,roomData);\n        this.ShowPlayer();\n    },\n    //显示\n    OnShow:function(){\n        this.node.active=true;\n        this.InitShowInfo();\n    },\n    ShowPlayer:function(){\n        this.InitJoinBtn();\n        let playerList=this.playerList;\n        for(let i=0;i<playerList.length;i++){\n            if(i>3){\n                //最多显示5人\n                break;\n            }\n            let PlayerInfo=playerList[i];\n            //用户头像创建\n            let heroID = PlayerInfo[\"pid\"];\n            let headImageUrl = PlayerInfo[\"headImageUrl\"];\n            let touxiang=this.GetWndNode('more/join_btn/btn_join'+(i+1));\n            if(heroID>0){\n                if(headImageUrl){\n                    this.WeChatManager.InitHeroHeadImage(heroID, headImageUrl);\n                    let WeChatHeadImage=touxiang.getComponent(\"WeChatHeadImage\");\n                    WeChatHeadImage.OnLoad();\n                        WeChatHeadImage.ShowHeroHead(heroID,headImageUrl);\n                }else{\n                    touxiang.getComponent(cc.Sprite).spriteFrame=this.bg_touxiang;\n                }\n            }else{\n                touxiang.getComponent(cc.Sprite).spriteFrame=this.bg_join;\n            }\n        }\n    },\n    ShowRoomJoin:function(){\n        this.FormManager.ShowForm('UIClubRoomJoin',this.roomData);\n    },\n    SetRoomInfo:function (key,roomData) {\n         let gameType=roomData.gameType;\n         let playerList=roomData.posList;\n         let roomCfg=roomData.roomCfg;\n         let roomID=roomData.roomID;\n         let roomKey=roomData.roomKey;\n         let playerNum=roomCfg.playerNum;\n         let clubName=roomData.clubName;\n         let setID=roomData.setID;\n\n         this.playerNum=playerNum;\n         this.playerList=new Array();\n         for(let i=0;i<playerList.length;i++){\n            if(playerList[i]){\n                if(playerList[i].pid>0){\n                    this.playerList.push(playerList[i]);\n                }\n            }\n         }\n\n         this.gameType=gameType.toLowerCase();\n         this.gameCfg=roomData.roomCfg;\n         this.roomKey=roomKey;\n         this.roomID=roomID;\n         this.SetWndProperty(\"lb_roomkey\", \"text\",roomKey);\n         this.SetWndProperty(\"lb_clubname\", \"text\",clubName);\n         this.SetWndProperty(\"lb_setcount\", \"text\",setID+'/'+roomCfg.setCount);\n         this.SetWndProperty(\"lb_gamename\", \"text\",this.GameType2Name(gameType));\n         this.SetWndProperty(\"lb_wanfa\", \"text\",this.GetWanFa(roomCfg));\n         if(setID>0){\n            //开始了关闭加入按钮\n            this.SetWndProperty('more','active',false);\n            this.node.height=60;\n         }else{\n            this.SetWndProperty('more','active',true);\n            this.node.height=130;\n         }\n    },\n    GameType2Name:function(gameType){\n        let gameTypeID=this.ShareDefine.GametTypeNameDict[gameType];\n        return this.ShareDefine.GametTypeID2Name[gameTypeID];\n    },\n    InitJoinBtn:function(){\n        let playerNum=this.playerNum;\n        //初始化头像背景\n        for(let i=1;i<=5;i++){\n            this.node.getChildByName('more').getChildByName('join_btn').getChildByName('btn_join'+i).getComponent(cc.Sprite).spriteFrame=this.bg_join;\n        }\n        for(let i=1;i<=playerNum;i++){\n            if(i>5){\n                break;\n            }\n            this.SetWndProperty(\"more/join_btn/btn_join\"+i, \"active\",true);\n        }\n        let j=playerNum+1;\n        for(;j<=5;j++){\n            this.SetWndProperty(\"more/join_btn/btn_join\"+j, \"active\",false);\n        }\n    },\n    getCurSelectRenShu:function(needIndex){\n        return needIndex;\n    },\n    GetHasPlayerNum:function(){\n        let nowJoin = 0;\n        for(let i=0;i<this.playerList.length;i++){\n            if(0 != this.playerList[i].pid)\n                nowJoin++;\n        }\n        return nowJoin;\n    },\n    Click_btn_Share:function(){\n        var GamePlayManager = require('GamePlayManager');\n        let gameType = this.gameType;\n        var WeChatShare= GamePlayManager.WeChatShare(gameType,this.gameCfg);\n        let title = null;\n        if(WeChatShare['special']){\n           title =WeChatShare['special'];\n        }else{\n           title =WeChatShare['title'];\n        }\n        let weChatAppShareUrl =WeChatShare['url'];\n        let setCount = this.gameCfg[\"setCount\"];  //多少局\n        let roomKey = this.roomKey;  //房间号\n\n        let joinPlayerCount = this.getCurSelectRenShu(this.gameCfg.playerNum);  //几人场\n        let nowJoin = this.GetHasPlayerNum();\n        title=title.replace('{房间号}',roomKey);\n        let gamedesc =\"\";\n        gamedesc=joinPlayerCount+\"人场\";\n        gamedesc=gamedesc+\",\"+setCount+\"圈\";\n        let autoCardIdx= this.gameCfg[\"paymentRoomCardType\"]; \n        if(0 == autoCardIdx)\n            gamedesc=gamedesc+\",房主出钻\";\n        else if(1 == autoCardIdx)\n            gamedesc=gamedesc+\",平分钻石\";\n        else\n            gamedesc=gamedesc+\",大赢家出钻\";\n        let que=joinPlayerCount-nowJoin;\n        gamedesc+=\",\"+nowJoin+\"缺\"+que;\n        let teshuwanfan=this.WanFa;\n        if(teshuwanfan){\n            gamedesc += \",\" + teshuwanfan;\n        }\n        console.log(\"Click_btn_weixin:\",title);\n        console.log(\"Click_btn_weixin:\",gamedesc);\n        console.log(\"Click_btn_weixin:\",weChatAppShareUrl);\n        \n        //this.SDKManager.Share(title, gamedesc, weChatAppShareUrl, \"0\");\n        this.FormManager.ShowForm('UIRoomCopy',roomKey,title,gamedesc,weChatAppShareUrl);\n    },\n    //启动微信房间分享\n    BeginShare:function(roomKey,text){\n        this.ShareText=text;\n        this.roomKey=roomKey;\n        //校服\n        let long_url=\"http://api.t.sina.com.cn/short_url/shorten.json?source=3271760578&url_long=https://fb.qicaiqh.com:88/room\"+roomKey;\n        app.NetManager().SendPack(\"game.CShortenGenerate\",{\"url\":long_url},this.SuccessTcnUrl.bind(this),this.FailTcnUrl.bind(this));\n    },\n    \n    SuccessTcnUrl:function(serverPack){\n        let shareUrl=\"https://fb.qicaiqh.com:88/\"+app.ComTool().GetPid(app.HeroManager().GetHeroProperty(\"pid\"))+\"/\";\n        if(this.TuiGuangUrl){\n            text=this.ShareText+\"\\n\"+\"下载地址:\"+shareUrl;\n        }else{\n            if(url_short){\n                text=this.ShareText;\n            }else{\n                text=this.ShareText;\n            }\n        }\n        this.SDKManager.ShareText(text,\"0\");\n    },\n\n    //微信分享获取短域名失败分享\n    FailTcnUrl:function(event){\n        let shareUrl=\"https://fb.qicaiqh.com:88/\"+app.ComTool().GetPid(app.HeroManager().GetHeroProperty(\"pid\"))+\"/\";\n        let text=this.ShareText+\"\\n\"+\"下载地址:\"+shareUrl;\n        this.SDKManager.ShareText(text,\"0\");\n    },\n    OnClick_Join:function(){\n        let nowJoin = this.GetHasPlayerNum();\n        if(nowJoin >= this.playerNum){\n            app.SysNotifyManager().ShowSysMsg(\"房间人数已满\");\n            return;\n        }                       \n        app.Client.JoinRoomCheckSubGame(this.gameType, this.roomKey);\n    },\n    GetWanFa:function(gameCfg){\n        let wanfa=app.RoomCfgManager().WanFa(this.gameType,gameCfg);\n        this.WanFa=wanfa;\n        return wanfa.substring(0, 8) + '...';\n    },\n    //-------------点击函数-------------\n\n});"]}