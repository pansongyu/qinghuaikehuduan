{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\script\\sdk/assets\\script\\sdk\\FacebookAppManager.js"],"names":["app","require","FacebookAppManager","BaseClass","extend","Init","JS_Name","ShareDefine","SysDataManager","HeroAccountManager","NetManager","ControlManager","HeroManager","SysNotifyManager","LocalDataManager","dataInfo","Log","Login","NativeManager","CallToNative","OnNativeNotifyFacebookLogin","console","log","OnNativeNotifyFacebookUserInfo","accessTokenInfo","headImgUrl","nickName","userId","accessToken","SendLoginByFacebook","sdkAccountID","LoginAccountBySDK","SDKType_FacebookApp","g_FacebookAppManager","exports","GetModel"],"mappings":";;;;;;AAAA;;;AAGA,IAAIA,MAAMC,QAAQ,KAAR,CAAV;;AAEA,IAAIC,qBAAqBF,IAAIG,SAAJ,CAAcC,MAAd,CAAqB;;AAE7CC,OAAM,gBAAY;AACjB,OAAKC,OAAL,GAAe,oBAAf;;AAEA,OAAKC,WAAL,GAAmBP,IAAIO,WAAJ,EAAnB;AACA,OAAKC,cAAL,GAAsBR,IAAIQ,cAAJ,EAAtB;AACA,OAAKC,kBAAL,GAA0BT,IAAIS,kBAAJ,EAA1B;AACA,OAAKC,UAAL,GAAkBV,IAAIU,UAAJ,EAAlB;AACA,OAAKC,cAAL,GAAsBX,IAAIW,cAAJ,EAAtB;AACA,OAAKC,WAAL,GAAmBZ,IAAIY,WAAJ,EAAnB;AACA,OAAKC,gBAAL,GAAwBb,IAAIa,gBAAJ,EAAxB;AACA,OAAKC,gBAAL,GAAwBd,IAAIc,gBAAJ,EAAxB;;AAGA,OAAKC,QAAL,GAAgB,EAAhB;;AAEA,OAAKC,GAAL,CAAS,MAAT;AACA,EAlB4C;;AAoB7C;AACAC,QAAO,iBAAY;AAClBjB,MAAIkB,aAAJ,GAAoBC,YAApB,CAAiC,iBAAjC,EAAoD,EAApD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EA3C4C;;AA6C7C;AACAC,8BAA6B,qCAAUL,QAAV,EAAoB;AAChDM,UAAQC,GAAR,CAAY,wCAAZ,EAAsDP,QAAtD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAzD4C;;AA2D7C;AACAQ,iCAAgC,0CAAY;AAC3CF,UAAQC,GAAR,CAAY,2CAAZ,EAAyDP,QAAzD;AACA,MAAIS,kBAAkB;AACrBC,eAAYV,SAAS,YAAT,CADS;AAErBW,aAAUX,SAAS,UAAT,CAFW;AAGrBY,WAAQZ,SAAS,QAAT,CAHa;AAIrBa,gBAAab,SAAS,aAAT;AAJQ,GAAtB;;AAOA,OAAKA,QAAL,GAAgBS,eAAhB;AACA,OAAKK,mBAAL,CAAyBL,eAAzB,EAA0CT,SAAS,aAAT,CAA1C,EAAmE,CAAnE;AACA,EAvE4C;;AAyE7C;AACAc,sBAAqB,6BAAUL,eAAV,EAA2BI,WAA3B,EAAwCE,YAAxC,EAAsD;AAC1ET,UAAQC,GAAR,CAAY,yBAAZ;AACA,OAAKb,kBAAL,CAAwBsB,iBAAxB,CAA0C,KAAKxB,WAAL,CAAiByB,mBAA3D,EAAgFJ,WAAhF,EAA6FJ,eAA7F,EAA8GM,YAA9G;AACA;;AA7E4C,CAArB,CAAzB;;AAkFA,IAAIG,uBAAuB,IAA3B;;AAEA;;;AAGAC,QAAQC,QAAR,GAAmB,YAAY;AAC9B,KAAI,CAACF,oBAAL,EAA2B;AAC1BA,yBAAuB,IAAI/B,kBAAJ,EAAvB;AACA;AACD,QAAO+B,oBAAP;AACA,CALD","file":"FacebookAppManager.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\sdk","sourcesContent":["/*\n\tFacebookAppManager.js   类似微信的聊天软件sdk\n */\nvar app = require('app');\n\nvar FacebookAppManager = app.BaseClass.extend({\n\n\tInit: function () {\n\t\tthis.JS_Name = \"FacebookAppManager\";\n\n\t\tthis.ShareDefine = app.ShareDefine();\n\t\tthis.SysDataManager = app.SysDataManager();\n\t\tthis.HeroAccountManager = app.HeroAccountManager();\n\t\tthis.NetManager = app.NetManager();\n\t\tthis.ControlManager = app.ControlManager();\n\t\tthis.HeroManager = app.HeroManager();\n\t\tthis.SysNotifyManager = app.SysNotifyManager();\n\t\tthis.LocalDataManager = app.LocalDataManager();\n\n\n\t\tthis.dataInfo = {};\n\n\t\tthis.Log(\"Init\");\n\t},\n\n\t// Facebook授权\n\tLogin: function () {\n\t\tapp.NativeManager().CallToNative(\"OnFacebookLogin\", []);\n\t\t// 如果本地缓存了accessToken\n\t\t// let accessTokenInfo = this.LocalDataManager.GetConfigProperty(\"Account\", \"AccessTokenInfo\");\n\t\t// let accessToken = \"\";\n\t\t// let sdkAccountID = 0;\n\t\t// let AccountType = 0;\n\t\t// // 直接登录服务器\n\t\t// if (accessTokenInfo) {\n\t\t// \tsdkAccountID = accessTokenInfo[\"userId\"];\n\t\t// \taccessToken = accessTokenInfo[\"accessToken\"];\n\t\t// \tAccountType = accessTokenInfo[\"AccountType\"];\n\t\t// }\n\t\t// this.dataInfo = accessTokenInfo;\n\t\t// if (sdkAccountID && AccountType == this.ShareDefine.SDKType_FacebookApp) {\n\t\t// \t//使用上次的授权缓存token\n\t\t// \tconsole.log(\"Facebook login 缓存了token，直接验证\");\n\t\t// \tthis.SendLoginByFacebook(accessTokenInfo, accessToken, 0);\n\t\t// }\n\t\t// else {\n\t\t// \tapp.NativeManager().CallToNative(\"OnFacebookLogin\", []);\n\t\t// }\n\t},\n\n\t// Facebook 登录\n\tOnNativeNotifyFacebookLogin: function (dataInfo) {\n\t\tconsole.log(\"OnNativeNotifyFacebookLogin dataInfo: \", dataInfo);\n\t\t// let accessTokenInfo = {\n\t\t// \theadImgUrl: dataInfo[\"headImgUrl\"],\n\t\t// \tnickName: dataInfo[\"nickName\"],\n\t\t// \tuserId: dataInfo[\"userId\"],\n\t\t// \taccessToken: dataInfo[\"accessToken\"],\n\t\t// }\n\n\t\t// this.dataInfo = accessTokenInfo;\n\t\t// this.SendLoginByFacebook(accessTokenInfo, dataInfo[\"accessToken\"], 0);\n\t},\n\n\t// Facebook 用户信息\n\tOnNativeNotifyFacebookUserInfo: function () {\n\t\tconsole.log(\"OnNativeNotifyFacebookUserInfo dataInfo: \", dataInfo);\n\t\tlet accessTokenInfo = {\n\t\t\theadImgUrl: dataInfo[\"headImgUrl\"],\n\t\t\tnickName: dataInfo[\"nickName\"],\n\t\t\tuserId: dataInfo[\"userId\"],\n\t\t\taccessToken: dataInfo[\"accessToken\"],\n\t\t}\n\n\t\tthis.dataInfo = accessTokenInfo;\n\t\tthis.SendLoginByFacebook(accessTokenInfo, dataInfo[\"accessToken\"], 0);\n\t},\n\n\t// 发送授权登录\n\tSendLoginByFacebook: function (accessTokenInfo, accessToken, sdkAccountID) {\n\t\tconsole.log(\"Facebook login 开始发送授权登录\");\n\t\tthis.HeroAccountManager.LoginAccountBySDK(this.ShareDefine.SDKType_FacebookApp, accessToken, accessTokenInfo, sdkAccountID);\n\t},\n\n\n});\n\nvar g_FacebookAppManager = null;\n\n/**\n * 绑定模块外部方法\n */\nexports.GetModel = function () {\n\tif (!g_FacebookAppManager) {\n\t\tg_FacebookAppManager = new FacebookAppManager();\n\t}\n\treturn g_FacebookAppManager;\n}"]}