{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\script\\scene\\Layer/assets\\script\\scene\\Layer\\TopLayer.js"],"names":["app","require","cc","Class","extends","properties","OnCreate","sceneType","JS_Name","join","ModalDelayTick","showModalTick","showModalEventType","waitNetEffectNode","Client","GetGlobalEffectNode","node","addChild","OnCloseModalLayer","OnBeforeExitScene","PushGlobalEffectNode","OnUpdate","nowTick","OnShowModalLayerEffect","active","ErrLog","OnTopEvent","eventType","reConnectTip","console","log","CloseReConnectTip","isOpenNet","OnShowModalLayer","StartReConnect","Log","Date","now"],"mappings":"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","file":"TopLayer.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\script\\scene\\Layer","sourcesContent":["/*\n 场景模态置顶层\n */\nvar app = require(\"app\");\n\ncc.Class({\n\textends: require(\"BaseComponent\"),\n\n\tproperties: {\n\t},\n\n\tOnCreate: function (sceneType) {\n\t\tthis.JS_Name = [sceneType, \"TopLayer\"].join(\"_\");\n\n\t\t//TopLv相关延迟多少毫秒显示\n\t\tthis.ModalDelayTick = 1500;\n\t\tthis.showModalTick = 0;\n\t\tthis.showModalEventType = \"\";\n\n\t\t//等待通信特效\n\t\tthis.waitNetEffectNode = app.Client.GetGlobalEffectNode(\"WaitNet\");\n\t\tif(this.waitNetEffectNode){\n\t\t\tthis.node.addChild(this.waitNetEffectNode);\n\t\t}\n\t\t//创建默认关闭状态\n\t\tthis.OnCloseModalLayer();\n\t},\n\n\tOnBeforeExitScene:function(){\n\t\tif(this.waitNetEffectNode){\n\t\t\tapp.Client.PushGlobalEffectNode(this.waitNetEffectNode);\n\t\t\tthis.waitNetEffectNode = null;\n\t\t}\n\t},\n\n\tOnUpdate:function(nowTick){\n\t\tif (this.showModalTick && this.showModalTick <= nowTick) {\n\t\t\tthis.OnShowModalLayerEffect();\n\t\t}\n\t},\n\n\t//显示特效\n\tOnShowModalLayerEffect:function(){\n\t\t//清空显示事件\n\t\tthis.showModalTick = 0;\n\n\t\tswitch(this.showModalEventType){\n\n\t\t\tcase \"OpenNet\":\n\t\t\t\tif(this.waitNetEffectNode){\n\t\t\t\t\tthis.waitNetEffectNode.active = true;\n\t\t\t\t}else{\n\t\t\t\t\tthis.ErrLog(\"waitNetEffectNode not find\");\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\tcase \"CreateForm\":\n\t\t\t\tif(this.waitNetEffectNode){\n\t\t\t\t\tthis.waitNetEffectNode.active = true;\n\t\t\t\t}else{\n\t\t\t\t\tthis.ErrLog(\"waitNetEffectNode not find\");\n\t\t\t\t}\n\t\t\t\tbreak\n\n\t\t\tdefault:\n\t\t\t\tthis.ErrLog(\"OnShowModalLayerEffect(%s) error\", this.showModalEventType);\n\t\t\t\tbreak\n\t\t}\n\t},\n\n\tOnTopEvent:function(eventType){\n\t\t//console.log('OnTopEvent EventType' + eventType);\n\t\tswitch(eventType){\n\t\t\tcase \"ReceiveNet\":\n\t\t\t\tif (app.Client.reConnectTip.active) {\n\t\t\t\t\tconsole.log(\"收到消息，关闭断线重连提示\");\n\t\t\t\t\tapp.Client.CloseReConnectTip();\n\t\t\t\t}\n\t\t\t\tthis.OnCloseModalLayer();\n\t\t\t\tthis.isOpenNet = false;\n\t\t\t\tthis.showModalEventType = \"\";\n\t\t\t\t// if(app.Client.bStartReConnect)\n\t\t\t\tbreak\n\t\t\tcase \"OpenNet\":\n\t\t\t\tthis.OnShowModalLayer();\n\t\t\t\tthis.isOpenNet = true;\n\t\t\t\tthis.showModalEventType = eventType;\n\t\t\t\tbreak\n\t\t\tcase \"StartReConnect\":\n\t\t\t\tapp.Client.StartReConnect();\n\t\t\t\tthis.node.active = true;\n\t\t\t\tbreak;\n\t\t\tcase \"CreateForm\":\n\t\t\t\tif(this.isOpenNet){\n\t\t\t\t\tthis.Log(\"CreateForm 等待通信结束\");\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tthis.OnShowModalLayer();\n\t\t\t\t\tthis.showModalEventType = eventType;\n\t\t\t\t}\n\t\t\t\tbreak\n\n\t\t\tcase \"CreateFormEnd\":\n\t\t\t\tif(this.isOpenNet){\n\t\t\t\t\tthis.Log(\"CreateFormEnd 等待通信结束\");\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tthis.showModalEventType = \"\";\n\t\t\t\t\tthis.OnCloseModalLayer();\n\t\t\t\t}\n\t\t\t\tbreak\n\n\t\t\tcase \"Close\":\n\t\t\t\tthis.showModalEventType = \"\";\n\t\t\t\tthis.OnCloseModalLayer();\n\t\t\t\tbreak\n\n\t\t\tdefault:\n\t\t\t\t// this.ErrLog(\"OnTopEvent(%s) error\", eventType);\n\t\t\t\tbreak\n\t\t}\n\t},\n\n\t//显示模态层提示\n\tOnShowModalLayer:function(){\n\t\tthis.node.active = true;\n\t\t//注册显示事件的Tick\n\t\tthis.showModalTick = Date.now() + this.ModalDelayTick;\n\t\tif(this.waitNetEffectNode){\n\t\t\tthis.waitNetEffectNode.active = false;\n\t\t}\n\t},\n\n\t//关闭场景模态层\n\tOnCloseModalLayer:function(){\n\t\tthis.node.active = false;\n\t\t//清空显示事件\n\t\tthis.showModalTick = 0;\n\t\tif(this.waitNetEffectNode){\n\t\t\tthis.waitNetEffectNode.active = false;\n\t\t}\n\t},\n\n});\n"]}