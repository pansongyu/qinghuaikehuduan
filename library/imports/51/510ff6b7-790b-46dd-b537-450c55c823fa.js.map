{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\script\\ui/assets\\script\\ui\\BaseChildForm.js"],"names":["app","require","BaseChildForm","cc","Class","extends","properties","frontNode","Node","backNode","deviation","OnCreate","parent","childComponentName","index","userData","pos","JS_Name","join","Parent","_dataInfo","parentEventFuncDict","InitBaseData","OnCreateInit","ShowFormName","node","setPosition","initClickX","InitScrollEffect","unuse","stopAllActions","DeleteFormAllEffect","ClearFormAllChildComponent","reuse","active","OnLoad","Destroy","OnDestroy","destroy","ShowForm","argList","OnShow","apply","error","ErrLog","stack","CloseForm","OnClose","ShowOrCloseForm","OnParentEvent","eventName","argDict","parentEventFunc","Log","IsFormShow","GetParent","on","OnFront_TouchMove","OnFront_TouchStart","OnFront_TouchEnd","OnFront_TouchCancel","event","width","director","getWinSize","ClickPositionX","getLocationX","frontPosition","getPositionX","DistanceX","touchPosX","getLocation","x","nodeX","setPositionX","RegEvent","func","RegParentEvent","OnClick_Close","module","exports"],"mappings":"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","file":"BaseChildForm.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\ui","sourcesContent":["/*\n BaseChildForm 子界面基类(又界面控制创建和销毁,一般是BaseForm的子界面,或者BaseChildForm的子界面(可以无限嵌套下去))\n */\n\nvar app = require(\"app\");\n\n\nvar BaseChildForm = cc.Class({\n\n\textends: require(\"BaseForm\"),\n\n\tproperties: {\n\t\tfrontNode:cc.Node,\n\t\tbackNode:cc.Node,\n        deviation:0,\n\t},\n\n\tOnCreate:function(parent, childComponentName, index, userData, pos=null){\n\t\tthis.JS_Name = [childComponentName, index].join(\"_\");\n\n\t\tthis.Parent = parent;\n\n\t\t//界面数据\n\t\tthis._dataInfo = {\n\t\t\t\"FormName\":childComponentName,\n\t\t\t\"UserData\":userData,\n\t\t\t\"ChildIndex\":index,\n\t\t};\n\n\t\t//注册父类事件分发\n\t\tthis.parentEventFuncDict = {};\n\n\t\tthis.InitBaseData();\n\n\t\tthis.OnCreateInit();\n\n\t\tthis.ShowFormName();\n\n\t\tif(pos){\n\t\t\tthis.node.setPosition(pos);\n\t\t}\n\n        this.initClickX = 0;\n\n\t\tthis.InitScrollEffect();\n\n    },\n\n\t//------------回掉函数----------------\n\n\t//被对象池回收\n\tunuse: function () {\n\t\tthis.node.stopAllActions();\n\t\tthis.DeleteFormAllEffect();\n\t\tthis.ClearFormAllChildComponent();\n\t},\n\n\t//对象池释放复用\n\treuse: function () {\n\t\tthis.node.active = true;\n\t},\n\n\t// 加载创建界面\n\tOnLoad: function () {\n\n\t},\n\n\t//销毁界面\n\tDestroy:function(){\n\n\t\tthis.OnDestroy();\n\t\t//销毁节点\n\t\tthis.node.destroy();\n\t},\n\n\n\t//显示界面\n\tShowForm:function(...argList){\n\t\ttry {\n\t\t\tthis.node.active = true;\n\t\t\tthis.OnShow.apply(this, argList);\n\t\t}\n\t\tcatch(error){\n\t\t\tthis.ErrLog(\"ShowForm:%s\", error.stack);\n\t\t}\n\n\t},\n\n\t//关闭界面\n\tCloseForm:function(){\n\t\tthis.node.active = false;\n\t\tthis.OnClose();\n\t},\n\n\t//开启或者关闭界面\n\tShowOrCloseForm:function(){\n\t\tthis.ErrLog(\"ShowOrCloseForm cant call\")\n\t},\n\n\t//响应父类事件\n\tOnParentEvent:function(eventName, argDict){\n\t\tlet parentEventFunc = this.parentEventFuncDict[eventName];\n\t\tif(!parentEventFunc){\n\t\t\tthis.Log(\"OnParentEvent(%s) not parentEventFunc\", eventName);\n\t\t\treturn;\n\t\t}\n\t\tparentEventFunc.apply(this, [argDict]);\n\t},\n\n\t//--------------获取接口-----------------\n\t//界面是否显示中\n\tIsFormShow:function(){\n\t\tthis.ErrLog(\"IsFormShow cant call\")\n\t},\n\n\t//-------------获取接口-------------------\n\t//获取界面父类\n\tGetParent:function(){\n\t\treturn this.Parent;\n\t},\n\n\t//-------------滑动出现删除控件效果-----------------\n\tInitScrollEffect:function () {\n\t\tif(this.frontNode){\n            this.frontNode.on(\"touchmove\", this.OnFront_TouchMove, this);\n            this.frontNode.on(\"touchstart\", this.OnFront_TouchStart, this);\n            this.frontNode.on(\"touchend\", this.OnFront_TouchEnd, this);\n            this.frontNode.on(\"touchcancel\", this.OnFront_TouchCancel, this);\n\t\t}\n    },\n\tOnFront_TouchEnd:function (event) {\n        // let MoveNodeParent = this.frontNode.parent;\n        // let MoveNodeWorldPositionX = MoveNodeParent.parent.convertToWorldSpaceAR(MoveNodeParent.getPosition()).x + MoveNodeParent.width/2;\n        // let DeleteBtnNodeWorldPositionX = this.backNode.parent.convertToWorldSpaceAR(this.backNode.getPosition()).x;\n\t\t// this.Log(MoveNodeWorldPositionX, DeleteBtnNodeWorldPositionX);\n    },\n\tOnFront_TouchCancel:function () {\n\n    },\n\tOnFront_TouchStart:function (event) {\n        let width = cc.director.getWinSize().width / 2;\n\t\tlet ClickPositionX = event.getLocationX() - width;\n\t\tlet frontPosition = this.frontNode.getPositionX();\n        this.DistanceX = ClickPositionX - frontPosition;\n    },\n\tOnFront_TouchMove:function (event) {\n\t\tif(!this.backNode){\n\t\t\tthis.ErrLog(\"OnFront_TouchMove not find backNode %s\", this.backNode);\n\t\t\treturn;\n\t\t}\n\t\tif(!this.DistanceX){\n\t\t\tthis.ErrLog(\"OnFront_TouchMove not find initClickX %s\", this.initClickX);\n\t\t\treturn;\n\t\t}\n        let width = cc.director.getWinSize().width / 2;\n        let touchPosX = event.getLocation().x - width;\n        let nodeX = touchPosX - this.DistanceX ;\n        if(nodeX >= 0){\n            nodeX = 0;\n        }\n        let deviation = this.backNode.width+this.deviation;\n        if(nodeX <= -deviation){\n            nodeX = -deviation;\n        }\n\t\tthis.frontNode.setPositionX(nodeX);\n    },\n\t//------------快捷功能函数-------------\n\n\t//注冊事件函数\n\tRegEvent:function(eventName, func){\n\t\tthis.ErrLog(\"RegEvent cant call\")\n\t},\n\n\t/**\n\t * 注册父类相应事件回调函数\n\t */\n\tRegParentEvent:function(event, func){\n\t\tthis.parentEventFuncDict[event] = func;\n\t},\n\n\t//-------------点击函数-------------\n\t//关闭界面\n\tOnClick_Close:function(){\n\t\tthis.ErrLog(\"OnClick_Close cant call\")\n\t},\n\t//--------------子类重载接口---------------\n\n\t//每次显示界面被调用\n\tOnShow:function(){\n\t},\n\n\n});\n\nmodule.exports = BaseChildForm;\n\n\n"]}