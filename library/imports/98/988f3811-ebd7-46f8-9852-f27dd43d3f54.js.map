{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\script\\scene/assets\\script\\scene\\BaseScene.js"],"names":["app","require","cc","Class","extends","properties","BackgroundLayer","Prefab","SceneEffectLayer","UILayer","GuideLayer","TopLayer","OnLoad","SceneManager","LocalDataManager","sceneType","GetSceneType","JS_Name","SoundManager","SysDataManager","ShareDefine","SceneInfo","GetTableDict","LayerLv_Background","LayerLv_ModelShadow","LayerLv_Model","LayerLv_ModelHP","LayerLv_SceneEffect","LayerLv_UI","LayerLv_Guide","LayerLv_Top","LayerLv_Debug","node","on","OnTouchStart","OnTouchMove","OnTouchEnd","OnTouchCancel","OnSpriteModelMoveToEnd","OnSpriteModelBeHitEnd","InitLayer","ShowMap","OnCreate","BackgroundLayerComponent","SceneEffectLayerNodeComponent","TopLayerNodeComponent","GuideLayerNodeComponent","ModelShadowLayerNode","ModelLayerNode","ModelHPLayerNode","UILayerNode","backgroundLayerNode","instantiate","addChild","getComponent","ModelLayer","ModelShadowLayer","ModelHPLayer","sceneEffectLayerNode","guideLayerNode","ErrLog","topLayerNode","debugModel","Client","GetDebugModel","event","update","dt","nowTick","Date","now","OnUpdate","error","stack","OnBaseTimer","passSecond","OnTimer","OnBeforeExitScene","removeChild","OnSwithSceneEnd","OnShowDefaultForm","OnEventHide","OnEventShow","OnTopEvent","eventType","ShowHelp","eventID","eventNode","OnShakeScene","rightDeltaPos","v2","leftDeltaPos","action","sequence","moveBy","runAction","cloneAction","clone","CreateSceneSpriteModel","modelName","imageName","modelRes","pos","userData","isShowHead","isShowShadow","zOrlderLv","CreateSceneSpriteModelByImagePath","imagePath","fileNameList","OnCreateSceneSpriteModelEnd","modelComponent","DeleteSceneSpriteModel","GetModelParent","parent","getChildByName","Log","Node","AddSceneEffect","effectName","effectRes","repeatCount","DeleteSceneEffect","OnReload"],"mappings":"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","file":"BaseScene.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\scene","sourcesContent":["/*\n    场景基类接口\n*/\nvar app = require(\"app\");\n\ncc.Class({\n    extends: require(\"BaseComponent\"),\n\n    properties: {\n\t    BackgroundLayer:cc.Prefab,\n\t    SceneEffectLayer:cc.Prefab,\n\t    UILayer:cc.Prefab,\n\t    GuideLayer:cc.Prefab,\n\t    TopLayer:cc.Prefab,\n    },\n\n    //--------------回掉函数----------------\n    // 加载创建\n    OnLoad: function () {\n\n\t    let SceneManager = app.SceneManager();\n        this.LocalDataManager = app.LocalDataManager();\n\t    //获取当前的地图ID\n        let sceneType = SceneManager.GetSceneType();\n        this.sceneType = sceneType;\n        this.JS_Name = sceneType;\n\n\t    this.SoundManager = app.SoundManager();\n\t    this.SysDataManager = app.SysDataManager();\n\t    this.ShareDefine = app.ShareDefine();\n\n\t    this.SceneInfo = this.SysDataManager.GetTableDict(\"SceneInfo\");\n\n\t    this.LayerLv_Background = 0;\n\t    this.LayerLv_ModelShadow = 1;\n\t    this.LayerLv_Model = 2;\n\t    this.LayerLv_ModelHP = 3;\n\t    this.LayerLv_SceneEffect = 4;\n\t    this.LayerLv_UI = 5;\n\t    this.LayerLv_Guide = 6;\n\t    this.LayerLv_Top = 7;\n\t    this.LayerLv_Debug = 8;\n\n        this.node.on(\"touchstart\", this.OnTouchStart, this);\n        this.node.on(\"touchmove\", this.OnTouchMove, this);\n        this.node.on(\"touchend\", this.OnTouchEnd, this);\n        this.node.on(\"touchcancel\", this.OnTouchCancel, this);\n\n        this.node.on(\"SpriteModelMoveToEnd\", this.OnSpriteModelMoveToEnd, this);\n        this.node.on(\"SpriteModelBeHitEnd\", this.OnSpriteModelBeHitEnd, this);\n\n\t    //--------------创建场景层--------------\n\t    this.InitLayer();\n\n        this.ShowMap();\n\n        this.OnCreate();\n    },\n\n\t//初始化场景层相关\n\tInitLayer:function(){\n\n\t\tthis.BackgroundLayerComponent = null;\n\t\tthis.SceneEffectLayerNodeComponent = null;\n\t\tthis.TopLayerNodeComponent = null;\n\t\tthis.GuideLayerNodeComponent = null;\n\n\t\tthis.ModelShadowLayerNode = null;\n\t\tthis.ModelLayerNode = null;\n\t\tthis.ModelHPLayerNode = null;\n\n\t\tthis.UILayerNode = null;\n\n\t\t//-----------可选层---------------\n\t\t//需要显示场景背景是创建的层\n\t\tif(this.BackgroundLayer){\n\t\t\tlet backgroundLayerNode = cc.instantiate(this.BackgroundLayer);\n\t\t\tthis.node.addChild(backgroundLayerNode, this.LayerLv_Background);\n\t\t\tthis.BackgroundLayerComponent = backgroundLayerNode.getComponent(\"BackgroundLayer\");\n\t\t\tthis.BackgroundLayerComponent.OnCreate(this.sceneType);\n\t\t}\n\n\t\t//需要创建场景模型是才需要的层 如果存在ModelLayer 如果不需要显示阴影和HP允许ModelShadowLayer，ModelHPLayer不存在\n\t\tif(this.ModelLayer){\n\t\t\tthis.ModelLayerNode = cc.instantiate(this.ModelLayer);\n\t\t\tthis.node.addChild(this.ModelLayerNode, this.LayerLv_Model);\n\t\t\tthis.ModelLayerNode.getComponent(\"ModelLayer\").OnCreate(this.sceneType);\n\t\t}\n\n\t\tif(this.ModelShadowLayer){\n\t\t\tthis.ModelShadowLayerNode = cc.instantiate(this.ModelShadowLayer);\n\t\t\tthis.node.addChild(this.ModelShadowLayerNode, this.LayerLv_ModelShadow);\n\t\t\tthis.ModelShadowLayerNode.getComponent(\"ModelShadowLayer\").OnCreate(this.sceneType);\n\t\t}\n\n\t\tif(this.ModelHPLayer){\n\t\t\tthis.ModelHPLayerNode = cc.instantiate(this.ModelHPLayer);\n\t\t\tthis.node.addChild(this.ModelHPLayerNode, this.LayerLv_ModelHP);\n\t\t\tthis.ModelHPLayerNode.getComponent(\"ModelHPLayer\").OnCreate(this.sceneType);\n\t\t}\n\n\t\t//需要播放场景特效是创建的层\n\t\tif(this.SceneEffectLayer){\n\t\t\tlet sceneEffectLayerNode = cc.instantiate(this.SceneEffectLayer);\n\t\t\tthis.node.addChild(sceneEffectLayerNode, this.LayerLv_SceneEffect);\n\t\t\tthis.SceneEffectLayerNodeComponent = sceneEffectLayerNode.getComponent(\"SceneEffectLayer\");\n\t\t\tthis.SceneEffectLayerNodeComponent.OnCreate(this.sceneType);\n\t\t}\n\n\t\t//新手引导层\n\t\tif(this.GuideLayer){\n\t\t\tlet guideLayerNode = cc.instantiate(this.GuideLayer);\n\t\t\tthis.node.addChild(guideLayerNode, this.LayerLv_Guide);\n\t\t\tthis.GuideLayerNodeComponent = guideLayerNode.getComponent(\"GuideLayer\");\n\t\t\tthis.GuideLayerNodeComponent.OnCreate(this.sceneType);\n\t\t}\n\n\t\t//----------以下是必须存在的层-----------------\n\n\t\t//场景UI层\n\t\tif(this.UILayer){\n\t\t\tthis.UILayerNode = cc.instantiate(this.UILayer);\n\t\t\tthis.node.addChild(this.UILayerNode, this.LayerLv_UI);\n\t\t\tthis.UILayerNode.getComponent(\"UILayer\").OnCreate(this.sceneType);\n\t\t}\n\t\telse{\n\t\t\tthis.ErrLog(\"InitLayer not find UILayer\");\n\t\t}\n\n\t\t//置顶模态层\n\t\tif(this.TopLayer){\n\t\t\tlet topLayerNode = cc.instantiate(this.TopLayer);\n\t\t\tthis.node.addChild(topLayerNode, this.LayerLv_Top);\n\t\t\tthis.TopLayerNodeComponent = topLayerNode.getComponent(\"TopLayer\");\n\t\t\tthis.TopLayerNodeComponent.OnCreate(this.sceneType);\n\t\t}\n\t\telse{\n\t\t\tthis.ErrLog(\"InitLayer not find TopLayer\");\n\t\t}\n\n\t\tthis.debugModel = null;\n\t\tlet debugModel = app.Client.GetDebugModel();\n\t\tif(debugModel){\n\t\t\tthis.node.addChild(debugModel.node, this.LayerLv_Top);\n\t\t\tthis.debugModel = debugModel;\n\t\t}\n\n\t},\n\n    //-------------点击事件--------------\n    OnTouchStart:function(event){\n    },\n\n    OnTouchMove:function(event){\n    },\n\n    OnTouchEnd:function(event){\n    },\n\n    OnTouchCancel:function(event){\n    },\n\n    //场景模型移动结束回掉\n    OnSpriteModelMoveToEnd:function(event){\n\n    },\n\n    //模型被击移动结束\n    OnSpriteModelBeHitEnd:function(event){\n    },\n\n    //每帧回掉\n    update: function (dt) {\n        try {\n\t        let nowTick = Date.now();\n\t        if(this.GuideLayerNodeComponent){\n\t\t        this.GuideLayerNodeComponent.OnUpdate(nowTick);\n\t        }\n\n\t        if(this.debugModel){\n\t\t        this.debugModel.OnUpdate(dt);\n\t        }\n\n\t        this.TopLayerNodeComponent.OnUpdate(nowTick);\n\n            this.OnUpdate(dt);\n        }\n        catch(error){\n\t\t    this.ErrLog(\"update：%s\", error.stack);\n        }\n\n    },\n\n    //100毫秒毁掉\n    OnBaseTimer:function(passSecond){\n        this.OnTimer(passSecond)\n    },\n\n    //场景准备退出前\n    OnBeforeExitScene:function(){\n\n\t    if(this.SceneEffectLayerNodeComponent){\n\t\t    this.SceneEffectLayerNodeComponent.OnBeforeExitScene();\n\t    }\n\n\t    //退出场景移除debug\n\t    if(this.debugModel){\n\t\t\tthis.node.removeChild(this.debugModel.node);\n\t\t    this.debugModel = null;\n\t    }\n\n\t    this.TopLayerNodeComponent.OnBeforeExitScene();\n\n\t    if(this.GuideLayerNodeComponent){\n\t\t    this.GuideLayerNodeComponent.OnBeforeExitScene();\n\t    }\n    },\n\n    //进入场景\n    OnSwithSceneEnd:function(){\n    },\n\n\t//显示动态设置的默认界面\n\tOnShowDefaultForm:function(){\n\n\t},\n\n    //应用切入后台\n    OnEventHide:function(){\n    },\n\n    //应用显示\n    OnEventShow:function(){\n    },\n\n\t//-----------置顶模态层--------------\n\t//显示顶层特效\n\tOnTopEvent:function(eventType){\n\t\tthis.TopLayerNodeComponent.OnTopEvent(eventType);\n\t},\n\n    //--------------新手引导-------------------\n    \n    //显示新手引导控件\n    ShowHelp:function(eventID, eventNode){\n\t    if(!this.GuideLayerNodeComponent){\n\t\t    this.ErrLog(\"ShowHelp(%s) error\", eventID);\n\t\t    return\n\t    }\n\t    this.GuideLayerNodeComponent.ShowHelp(eventID, eventNode);\n    },\n\n    //--------------操作函数------------------\n    //显示地图背景图\n    ShowMap:function(){\n\t    // let mapID = app.SceneManager().GetMapID();\n\t    // if(!mapID){\n\t\t   //  return\n\t    // }\n\t    // if(!this.BackgroundLayerComponent){\n\t\t   //  this.ErrLog(\"ShowMap not find BackgroundLayerComponent\");\n\t\t   //  return\n\t    // }\n\t    // this.BackgroundLayerComponent.ShowMap(mapID);\n    },\n\n\t//场景震动\n\tOnShakeScene:function(){\n\t\tlet rightDeltaPos = cc.v2(6,0);\n\t\tlet leftDeltaPos = cc.v2(-6,0);\n\n\t\tlet action = cc.sequence(\n\t\t\t\t\t\t\t\t\tcc.moveBy(0.025,cc.v2(3,0)),\n\t\t\t\t\t\t\t\t\tcc.moveBy(0.025,leftDeltaPos),\n\t\t\t\t\t\t\t\t\tcc.moveBy(0.025,rightDeltaPos),\n\t\t\t\t\t\t\t\t\tcc.moveBy(0.025,cc.v2(-3,0))\n\t\t\t\t\t\t\t\t);\n\n\t\tthis.UILayerNode.runAction(action);\n\n\t\tif(this.BackgroundLayerComponent){\n\t\t\tlet cloneAction = action.clone();\n\t\t\tthis.BackgroundLayerComponent.node.runAction(cloneAction);\n\t\t}\n\t},\n\n\n    //--------------模型相关-----------------\n\n    //创建场景精灵模型\n    CreateSceneSpriteModel:function(modelName, imageName, modelRes, pos, userData=0, isShowHead=1, isShowShadow=1, zOrlderLv=0){\n\n    },\n\n    //创建界面精灵模型\n    CreateSceneSpriteModelByImagePath:function(modelName, imagePath, modelRes, pos, userData=0, isShowHead=1, isShowShadow=1, zOrlderLv=0, fileNameList=[]){\n\n    },\n\n    //创建模型完成回调\n    OnCreateSceneSpriteModelEnd:function(modelName, imageName, modelRes, userData, pos, modelComponent, zOrlderLv){\n        \n    },\n\n    DeleteSceneSpriteModel:function(modelName){\n\n    },\n\n    //获取模型父类\n    GetModelParent:function(imageName, modelRes, userData){\n\n\t    if(!this.ModelLayerNode){\n\t\t    this.ErrLog(\"GetModelParent(%s) not ModelLayerNode\", imageName)\n\t\t    return\n\t    }\n        //如果创建的是没有贴图的模型\n        //TODO:模型预制自身包含图片 需要获取图片名字创建一个父类\n        if(!imageName){\n            return this.ModelLayerNode;\n        }\n\n        let parent = this.ModelLayerNode.getChildByName(imageName);\n        if(!parent){\n            this.Log(\"创建模型父类(%s)\", imageName);\n            parent = new cc.Node(imageName);\n            this.ModelLayerNode.addChild(parent);\n        }\n\n        return parent\n\n    },\n\n    //---------------特效相关---------------------\n\n    //创建场景特效\n    AddSceneEffect:function(effectName, effectRes, repeatCount=0, userData=0){\n\t    return this.SceneEffectLayerNodeComponent.AddSceneEffect(effectName, effectRes, repeatCount, userData);\n    },\n\n    DeleteSceneEffect:function(modelComponent){\n\t    this.SceneEffectLayerNodeComponent.DeleteSceneEffect(modelComponent);\n    },\n\n    //--------------子类重载-----------------\n    OnCreate:function(){\n\n    },\n\n    //每帧回掉\n    OnUpdate:function(dt){\n        \n    },\n\n    OnTimer:function(passSecond){\n\n    },\n    //切换账号\n    OnReload:function(){\n\n    },\n});\n"]}