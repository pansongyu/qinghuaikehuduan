{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\script\\ui/assets\\script\\ui\\UIDXSelectJoinChair.js"],"names":["app","require","cc","Class","extends","Component","properties","default_headIcon","SpriteFrame","onLoad","m_roomId","okF","onShow","data","lb_room_info","find","node","playerNodes","posList","gameRule","cfg","kexuan","roomKey","str","setID","setCount","playerMinNum","playerNum","huangdiduijiangli","i","length","kexuanwanfa","includes","getComponent","Label","string","pid","HeadImageUrl","headImageUrl","WeChatManager","InitHeroHeadImage","e","FormManager","ShowForm","ShareDefine","ConfirmBuyGoTo","name","message","console","error","children","player_node","active","btn_head","getChildByName","Sprite","spriteFrame","WeChatHeadImage","ShowHeroHead","onSelectPos","event","NetManager","SendPack","Number","args","warn","gameType","GametTypeID2PinYin","Client","EnterSubGame","start"],"mappings":"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","file":"UIDXSelectJoinChair.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\ui","sourcesContent":["let app = require(\"app\");\ncc.Class({\n    extends: cc.Component,\n    properties: {\n        default_headIcon: cc.SpriteFrame,\n    },\n\n    onLoad() {\n        this.m_roomId = null;\n        this.okF = null;\n    },\n\n    onShow(data, okF) {\n        this.okF = okF;\n        this.lb_room_info = cc.find('center_wanfa/lb_room_info', this.node);\n        this.playerNodes = cc.find('playerNodes', this.node);\n        let posList = data['roomPosInfoList'];\n        //玩法\n        let {cfg: gameRule} = data;\n        const kexuan = ['超时弃牌', '头家反带', '允许中途加入', '头家闷吃'];\n        this.m_roomId = data.roomKey;\n        let str = ` \n房间号:${data.roomKey}\n当前第${data.setID}/${gameRule.setCount}局\n人数:${gameRule.playerMinNum}-${gameRule.playerNum}\n`;/*\n${gameRule.fangfei[0] == 0 ? '房主支付' : (gameRule.fangfei[0] == 1 ? 'AA支付' : '胜家支付')}*/\n        if (gameRule.huangdiduijiangli) str += `皇帝对奖励\n`;\n        for (let i = 0; i < kexuan.length; i++) {\n            if (gameRule.kexuanwanfa.includes(i)) {\n                str += `${kexuan[i]}\n`;\n            } else {\n                if (i == 2) {\n                    str += `不${kexuan[i]}\n`;\n                }\n            }\n        }\n        this.lb_room_info.getComponent(cc.Label).string = str;\n\n        //\n        try {\n            for (let i in posList) {\n                let pid = posList[i].pid;\n                let HeadImageUrl = posList[i].headImageUrl;\n                if (pid && HeadImageUrl) {\n                    app.WeChatManager().InitHeroHeadImage(pid, HeadImageUrl);\n                }\n            }\n        } catch (e) {\n            app.FormManager().ShowForm(\"UIMessage\", null, app.ShareDefine().ConfirmBuyGoTo, 0, 0, '获取用户头像错误:' + e.name + '|' + e.message);\n            console.error('错误', e);\n        }\n        //\n        for (let i in this.playerNodes.children) {\n            try {\n                let player_node = this.playerNodes.children[i];\n                if (i >= gameRule.playerNum) {\n                    player_node.active = false;\n                    continue;\n                }\n                //\n                let btn_head = player_node.getChildByName('btn_head');\n                if (posList[i] == null || !posList[i].pid) {\n                    player_node.getChildByName('img_txk').active = false;\n                    player_node.getChildByName('bt_img_kw').active = true;\n                    player_node.getChildByName('lb_name').getComponent(cc.Label).string = '';\n                    btn_head.getComponent(cc.Sprite).spriteFrame = null;\n                } else {\n                    player_node.getChildByName('img_txk').active = true;\n                    player_node.getChildByName('bt_img_kw').active = false;\n                    //\n                    player_node.getChildByName('lb_name').getComponent(cc.Label).string = posList[i].name;\n                    let WeChatHeadImage = btn_head.getComponent(\"WeChatHeadImage\");\n                    if (posList[i].headImageUrl) {\n                        WeChatHeadImage.ShowHeroHead(posList[i].pid,posList[i].headImageUrl);\n                    } else {\n                        btn_head.getComponent(cc.Sprite).spriteFrame = this.default_headIcon;\n                    }\n                }\n            } catch (e) {\n                app.FormManager().ShowForm(\"UIMessage\", null, app.ShareDefine().ConfirmBuyGoTo, 0, 0, '错误了' + e.name + '|' + e.message);\n                console.error('错误', e);\n            }\n        }\n    },\n\n    onSelectPos(event, i) {\n        //0为退出\n        if (i == 0) {\n            this.node.active = false;\n            return;\n        }\n        app.NetManager().SendPack(\"room.CBaseEnterRoom\", {\n            \"roomKey\": this.m_roomId,\n            \"posID\": Number(i - 1)//位置减1 下标0起\n        }, (args) => {\n            console.warn('进入房间成功', args);\n            //\n            let {gameType} = args;\n            let name = app.ShareDefine().GametTypeID2PinYin[gameType];\n            app.Client.EnterSubGame(name,null,this.m_roomId);\n            //\n            this.okF && this.okF();\n            this.node.active = false;\n        }, () => {\n            this.node.active = false;\n        });\n    },\n\n    start() {\n    },\n\n    // update (dt) {},\n});\n"]}