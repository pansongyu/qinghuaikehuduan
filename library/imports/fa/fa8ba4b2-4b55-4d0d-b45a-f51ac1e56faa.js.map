{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\script\\ui\\club/assets\\script\\ui\\club\\UIUserSetBaoMingFei.js"],"names":["app","require","cc","Class","extends","properties","OnCreateInit","OnShow","data","lb_TargetPercent","node","getChildByName","getComponent","RichText","string","name","substr","pid","lb_curPercent","Label","lb_maxPercent","lb_maxValue","doShareValue","minShareValue","doShareFixedValue","minShareFixedValue","shareType","shareFixedValue","EditBox","maxValue","minValue","shareValue","InitShareType","isChange","SetIsChange","SetNotChange","ToggleContainer","Toggle","isChecked","GetShareType","toggle1","toggle3","OnClick","btnName","btnNode","percentStr","parseFloat","SysNotifyManager","ShowSysMsg","sendPack","ClubManager","GetUnionSendPackHead","value","type","self","NetManager","SendPack","serverPack","Client","OnEvent","CloseForm","opClubId","clubId","opPid","FormManager","ShowForm","unionFlag","ErrLog"],"mappings":"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","file":"UIUserSetBaoMingFei.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\script\\ui\\club","sourcesContent":["var app = require(\"app\");\ncc.Class({\n    extends: require(\"BaseForm\"),\n\n    properties: {\n\n    },\n\n    OnCreateInit: function () {\n\n    },\n    /*\n    let data = {\n                    \"name\":playerData.name,\n                    \"pid\":app.ComTool().GetPid(playerData.pid),\n                    \"shareValue\":serverPack.shareValue,\n                    \"shareFixedValue\":serverPack.shareFixedValue,\n                    \"doShareValue\":serverPack.doShareValue,\n                    \"shareType\":serverPack.shareType,\n                }\n    */\n    OnShow: function (data) {\n        this.data = data;\n        let lb_TargetPercent = this.node.getChildByName(\"lb_TargetPercent\").getComponent(cc.RichText);\n        lb_TargetPercent.string = \"<color=#705d52>修改</c><color=#f8772c>\" + data.name.substr(0,9) + \"（ID:\" + data.pid + \"）\" + \"</color><color=#705d52>的报名费分成</c>\";\n        let lb_curPercent = this.node.getChildByName(\"lb_curPercent\").getComponent(cc.Label);\n        let lb_maxPercent = this.node.getChildByName(\"lb_maxPercent\").getComponent(cc.Label);\n        let lb_maxValue = this.node.getChildByName(\"lb_maxValue\").getComponent(cc.Label);\n\n        lb_maxPercent.string = \"最高:\" + data.doShareValue+\"%,最小:\"+data.minShareValue+\"%\";\n\n        lb_maxValue.string = \"最大:\" + data.doShareFixedValue+\",最小:\"+data.minShareFixedValue+\"\";\n        if(data.shareType==1){\n            //固定值\n            lb_curPercent.string = \"该玩家当前报名费分成：\" + data.shareFixedValue;\n            this.node.getChildByName(\"PercentEditBox2\").getComponent(cc.EditBox).string =  data.shareFixedValue;\n            this.node.getChildByName(\"PercentEditBox\").getComponent(cc.EditBox).string =\"\";\n        }else{\n            //最高可设置分成：10%\n            this.maxValue=data.doShareValue;\n            this.minValue=data.minShareValue;\n            \n            lb_curPercent.string = \"该玩家当前报名费分成：\" + data.shareValue+\"%\";\n            //初始化比赛分输入框\n            this.node.getChildByName(\"PercentEditBox\").getComponent(cc.EditBox).string = data.shareValue;\n            this.node.getChildByName(\"PercentEditBox2\").getComponent(cc.EditBox).string =\"\";\n        }\n        this.InitShareType(data.shareType);\n        //初始化比赛分输入框\n        this.isChange=false;\n    },\n    SetIsChange:function(){\n        this.isChange=true;\n    },\n    SetNotChange:function(){\n        this.isChange=true;\n    },\n    InitShareType:function(shareType){\n        let ToggleContainer=this.node.getChildByName(\"ToggleContainer\");\n        if(shareType==1){\n            ToggleContainer.getChildByName(\"toggle1\").getComponent(cc.Toggle).isChecked=false;\n            ToggleContainer.getChildByName(\"toggle2\").getComponent(cc.Toggle).isChecked=true;\n            ToggleContainer.getChildByName(\"toggle3\").getComponent(cc.Toggle).isChecked=false;\n        }else if(shareType==0){\n            ToggleContainer.getChildByName(\"toggle1\").getComponent(cc.Toggle).isChecked=true;\n            ToggleContainer.getChildByName(\"toggle2\").getComponent(cc.Toggle).isChecked=false;\n            ToggleContainer.getChildByName(\"toggle3\").getComponent(cc.Toggle).isChecked=false;\n        }else {\n            ToggleContainer.getChildByName(\"toggle1\").getComponent(cc.Toggle).isChecked=false;\n            ToggleContainer.getChildByName(\"toggle2\").getComponent(cc.Toggle).isChecked=false;\n            ToggleContainer.getChildByName(\"toggle3\").getComponent(cc.Toggle).isChecked=true;\n        }\n    },\n    GetShareType:function(){\n        let ToggleContainer=this.node.getChildByName(\"ToggleContainer\");\n        let toggle1=ToggleContainer.getChildByName(\"toggle2\").getComponent(cc.Toggle).isChecked;\n        let toggle3=ToggleContainer.getChildByName(\"toggle3\").getComponent(cc.Toggle).isChecked;\n        if(toggle1){\n            return 1;\n        }else if (toggle3) {\n        \treturn 2;\n        }\n        return 0;\n    },\n    OnClick:function(btnName, btnNode){\n        if(btnName == \"btn_sure\"){\n                //固定值\n                let shareType=this.GetShareType();\n                let percentStr =-1;\n                if(shareType==1){\n                    //固定值\n                    percentStr = this.node.getChildByName(\"PercentEditBox2\").getComponent(cc.EditBox).string;\n                    \n                    if(parseFloat(percentStr)>this.data.doShareFixedValue){\n                        app.SysNotifyManager().ShowSysMsg(\"输入值不能大于\"+this.data.doShareFixedValue,[],3);\n                        return;\n                    }\n                    if(parseFloat(percentStr)<this.data.minShareFixedValue){\n                        app.SysNotifyManager().ShowSysMsg(\"输入值不能小于\"+this.data.minShareFixedValue,[],3);\n                        return;\n                    }\n                }else if(shareType==0){\n                    //百分比\n                    percentStr = this.node.getChildByName(\"PercentEditBox\").getComponent(cc.EditBox).string;\n                    if(percentStr>100){\n                        app.SysNotifyManager().ShowSysMsg(\"请输入小于100的数字\",[],3);\n                        return;\n                    }\n                    if(parseFloat(percentStr)>this.maxValue){\n                        app.SysNotifyManager().ShowSysMsg(\"输入值不能大于\"+this.maxValue,[],3);\n                        return;\n                    }\n                    if(parseFloat(percentStr)<this.minValue){\n                        app.SysNotifyManager().ShowSysMsg(\"输入值不能小于\"+this.minValue,[],3);\n                        return;\n                    }\n                }else{\n                    //区间\n                    percentStr = 0;\n                }\n                if (parseFloat(percentStr) >= 0) {\n                    let sendPack = app.ClubManager().GetUnionSendPackHead();\n                    sendPack.pid = this.data.pid;\n                    sendPack.value = parseFloat(percentStr);\n                    sendPack.type=shareType;\n                    let self = this;\n                    app.NetManager().SendPack(\"club.CClubPromotionShareChange\",sendPack, function(serverPack){\n                        app.SysNotifyManager().ShowSysMsg(\"成功设置报名费分成\",[],3);\n                        //触发刷新上层\n                        app.Client.OnEvent('UpdateBaoMingFeiFenCheng', serverPack);\n                        self.CloseForm();\n                    }, function(){\n                        // app.SysNotifyManager().ShowSysMsg(\"设置报名费分成失败\",[],3);\n                    });\n\n\n                }else{\n                    app.SysNotifyManager().ShowSysMsg(\"请输入纯数字\",[],3);\n                }\n        }else if(btnName == \"btn_detail_value\"){\n            let data = {};\n            data.opClubId = app.ClubManager().GetUnionSendPackHead().clubId;\n            data.opPid = this.data.pid;\n            data.shareFixedValue=this.data.shareFixedValue;\n            app.FormManager().ShowForm(\"ui/club/UIUserSetBaoMingFeiDetail\",data, 1);\n            this.CloseForm();\n        }else if(btnName == \"btn_detail_percent\"){\n            let data = {};\n            data.opClubId = app.ClubManager().GetUnionSendPackHead().clubId;\n            data.opPid = this.data.pid;\n            data.shareValue=this.data.shareValue;\n            app.FormManager().ShowForm(\"ui/club/UIUserSetBaoMingFeiDetail\",data, 0);\n            this.CloseForm();\n        }else if(btnName == \"btn_detail_section\"){\n            let data = {};\n            data.opClubId = app.ClubManager().GetUnionSendPackHead().clubId;\n            data.opPid = this.data.pid;\n            data.unionFlag = 0;\n            data.shareValue=this.data.shareValue;\n            app.FormManager().ShowForm(\"ui/club/UIUserSetSection\",data);\n            this.CloseForm();\n        }else if(btnName == \"btn_close\"){\n            this.CloseForm();\n        }else{\n            this.ErrLog(\"OnClick(%s) not find\", btnName);\n        }\n    },\n\n});\n"]}