{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\script\\ui\\club/assets\\script\\ui\\club\\UIUserOutRace.js"],"names":["app","require","cc","Class","extends","properties","OnCreateInit","OnShow","data","isUnion","isPromoter","percentStr","lb_TargetPL","node","getChildByName","getComponent","RichText","string","targetPL","EditBox","OnClick","btnName","btnNode","SysNotifyManager","ShowSysMsg","percentFloat","parseFloat","owerPL","sendPack","packName","ClubManager","GetUnionSendPackHead","opClubId","clubId","targetClubId","opPid","pid","type","value","SendPointPack","CloseForm","ErrLog","self","NetManager","SendPack","serverPack","newPath","GetUnionTypeByLastClubData","FormManager","GetFormComponentByFormName","GetPromoterList","UpdateCurPL","changedValue"],"mappings":"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","file":"UIUserOutRace.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\script\\ui\\club","sourcesContent":["var app = require(\"app\");\ncc.Class({\n    extends: require(\"BaseForm\"),\n\n    properties: {\n\n    },\n\n    OnCreateInit: function () {\n\n    },\n    OnShow: function (data,isUnion=true,isPromoter=false,percentStr) {\n        this.data = data;\n        this.isUnion = isUnion;\n        this.isPromoter = isPromoter;\n        let lb_TargetPL = this.node.getChildByName(\"lb_TargetPL\").getComponent(cc.RichText);\n        lb_TargetPL.string = \"<color=#705d52>玩家身上拥有</c><color=#f8772c>\" + data.targetPL + \"</color><color=#705d52>比赛分，请清零玩家竞技点后退赛</c>\";\n        //初始化比赛分输入框\n        //this.node.getChildByName(\"PLEditBox\").getComponent(cc.EditBox).string = data.targetPL;\n        this.node.getChildByName(\"PLEditBox\").getComponent(cc.EditBox).string = percentStr;\n    },\n    OnClick:function(btnName, btnNode){\n\n        if(btnName == \"btn_sure\"){\n            let percentStr = this.node.getChildByName(\"PLEditBox\").getComponent(cc.EditBox).string;\n            if(percentStr==\"\"){\n                app.SysNotifyManager().ShowSysMsg(\"请输入大于该玩家所拥有比赛分的纯数字\",[],3);\n                return;\n            }\n            let percentFloat = parseFloat(percentStr);\n            // this.SetWaitForConfirm('FORCE_OUT_UNION',this.ShareDefine.Confirm,[],[this.data.targetPL], \"玩家身上拥有\"+this.data.targetPL+\"竞技点值，是否将玩家竞技清零并退赛\");\n            if (this.data.targetPL<0 && percentFloat > 0 && percentFloat <= this.data.owerPL) {\n                //要补偿分数\n                this.node.getChildByName(\"PLEditBox\").getComponent(cc.EditBox).string=\"\"; //防止二次点击，每次点击都清空输入框\n                let sendPack = {};\n                let packName = \"\";\n                if (this.isUnion && !this.isPromoter) {\n                    sendPack = app.ClubManager().GetUnionSendPackHead();\n                    sendPack.opClubId = this.data.opClubId;\n                    packName = \"union.CUnionSportsPointUpdate\";\n                }else if (!this.isUnion && this.isPromoter) {\n                    sendPack.clubId = this.data.targetClubId;\n                    packName = \"club.CClubSubordinateLevelSportsPointUpdate\";\n                }else{\n                    sendPack.clubId = app.ClubManager().GetUnionSendPackHead().clubId;\n                    packName = \"club.CClubSportsPointUpdate\";\n                }\n                sendPack.opPid = this.data.pid;\n                sendPack.type = 1;\n                sendPack.value = parseFloat(percentStr);\n                this.SendPointPack(packName, sendPack);\n            }else if (this.data.targetPL>=0 && percentFloat > 0 && percentFloat <= this.data.targetPL) {\n                //要扣分退赛\n                this.node.getChildByName(\"PLEditBox\").getComponent(cc.EditBox).string=\"\"; //防止二次点击，每次点击都清空输入框\n                let sendPack = {};\n                let packName = \"\";\n                if (this.isUnion && !this.isPromoter) {\n                    sendPack = app.ClubManager().GetUnionSendPackHead();\n                    sendPack.opClubId = this.data.opClubId;\n                    packName = \"union.CUnionSportsPointUpdate\";\n                }else if (!this.isUnion && this.isPromoter) {\n                    sendPack.clubId = this.data.targetClubId;\n                    packName = \"club.CClubSubordinateLevelSportsPointUpdate\";\n                }else{\n                    sendPack.clubId = app.ClubManager().GetUnionSendPackHead().clubId;\n                    packName = \"club.CClubSportsPointUpdate\";\n                }\n                sendPack.opPid = this.data.pid;\n                sendPack.type = 1;\n                sendPack.value = parseFloat(percentStr);\n                this.SendPointPack(packName, sendPack);\n            }\n            else{\n                app.SysNotifyManager().ShowSysMsg(\"请输入大于该玩家所拥有比赛分的纯数字\",[],3);\n            }\n        }else if(btnName == \"btn_close\"){\n            this.CloseForm();\n        }else{\n            this.ErrLog(\"OnClick(%s) not find\", btnName);\n        }\n    },\n    SendPointPack:function(packName, sendPack){\n        let self = this;\n        app.NetManager().SendPack(packName,sendPack, function(serverPack){\n            if (serverPack.type == 0) {\n                app.SysNotifyManager().ShowSysMsg(\"成功设置比赛分\",[],3);\n            }else{\n                app.SysNotifyManager().ShowSysMsg(\"玩家退赛成功，已将玩家\"+serverPack.value+\"比赛分 扣除并退赛\");\n            }\n            if (self.isPromoter) {\n                let newPath = 'ui/club/UIPromoterAllManager';\n                if (app.ClubManager().GetUnionTypeByLastClubData()==1) {\n                    newPath = 'ui/club_2/UIPromoterAllManager_2';\n                }\n                self.FormManager.GetFormComponentByFormName(newPath).GetPromoterList(true);\n            }\n\n            self.FormManager.GetFormComponentByFormName(\"ui/club/UIUserSetPL\").UpdateCurPL(serverPack.changedValue);\n\n\n            self.CloseForm();\n        }, function(){\n            // app.SysNotifyManager().ShowSysMsg(\"设置比赛分失败\",[],3);\n        });\n    },\n});\n"]}