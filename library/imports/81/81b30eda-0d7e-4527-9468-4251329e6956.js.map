{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\script\\ui/assets\\script\\ui\\UIContact.js"],"names":["app","require","cc","Class","extends","properties","EditBoxName","default","type","EditBox","EditBoxTel","EditBoxAdr","btn_exchange","Node","ex_name","Label","ex_num","OnCreateInit","NetManager","OnShow","AppID","AppName","AppPrice","string","toFixed","toString","isTel","val","pattern","test","isChn","str","reg","OnClick","btnName","btnNode","name","tel","adr","length","WaitForConfirm","ShareDefine","ConfirmOK","ConfirmManager","SetWaitForConfirmForm","OnConFirm","bind","ShowConfirm","Confirm","CloseForm","ErrLog","clickType","msgID","backArgList","crystal","HeroManager","GetHeroProperty","price","parseInt","SysNotifyManager","ShowSysMsg","data","prizeId","phone","address","SendPack","event"],"mappings":"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","file":"UIContact.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\ui","sourcesContent":["var app = require(\"app\");\ncc.Class({\n    extends: require(\"BaseForm\"),\n\n    properties: {\n\t\tEditBoxName:{\n\t\t\tdefault:null,\n\t\t\ttype:cc.EditBox\n\t\t},\n\t\tEditBoxTel:{\n\t\t\tdefault:null,\n\t\t\ttype:cc.EditBox\n\t\t},\n\t\tEditBoxAdr:{\n\t\t\tdefault:null,\n\t\t\ttype:cc.EditBox\n\t\t},\n\n\t\tbtn_exchange:cc.Node,\n\t\tex_name:cc.Label,\n\t\tex_num:cc.Label,\n    },\n\n    OnCreateInit: function () {\n        this.NetManager = app.NetManager();\n\t},\n\n    OnShow: function (AppID, AppName, AppPrice) {\n\t\tthis.ex_name.string = AppName;\n\t\tif(AppPrice >= 10000)\n\t\t\tAppPrice = (AppPrice/10000).toFixed(1).toString() + 'ä¸‡';\n\t\tthis.ex_num.string = AppPrice;\n\t\tthis.AppID = AppID;\n\t},\n\n\tisTel:function(val){\n\t\tvar pattern=/(^(([0\\+]\\d{2,3}-)?(0\\d{2,3})-)(\\d{7,8})(-(\\d{3,}))?$)|(^0{0,1}1[3|4|5|6|7|8|9][0-9]{9}$)/;\n\t\tif(pattern.test(val)) { \n\t\t\treturn true; \n\t\t}else{ \n\t\t\treturn false; \n\t\t}\n\t},\n\n\tisChn:function(str){ \n\t\tvar reg = /^[\\u4E00-\\u9FA5]+$/; \n\t\tif(!reg.test(str)){ \n\t\t\treturn false; \n\t\t}\n\t\treturn true; \n\t},\n\n\tOnClick:function(btnName, btnNode){\n\t\tif('btn_exchange' == btnName){\n\t\t\tlet name = this.EditBoxName.string;\n\t\t\tlet tel = this.EditBoxTel.string;\n\t\t\tlet adr = this.EditBoxAdr.string;\n\t\t\tif(name.length < 2){\n\t\t\t\tthis.WaitForConfirm(\"UISHIMING_INFO_ERROR\", [], [], this.ShareDefine.ConfirmOK);\n\t\t\t\tthis.EditBoxName.string = \"\";\n\t\t\t\treturn;    \n\t\t\t}\n\t\t\tif(tel.length < 2){\n\t\t\t\tthis.WaitForConfirm(\"UISHIMING_INFO_ERROR\", [], [], this.ShareDefine.ConfirmOK);\n\t\t\t\tthis.EditBoxTel.string = \"\";\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(adr.length < 2){\n\t\t\t\tthis.WaitForConfirm(\"UISHIMING_INFO_ERROR\", [], [], this.ShareDefine.ConfirmOK);\n\t\t\t\tthis.EditBoxTel.string = \"\";\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(this.isChn(name)===false){\n\t\t\t\tthis.WaitForConfirm(\"UISHIMING_INFO_ERROR\", [], [], this.ShareDefine.ConfirmOK);\n\t\t\t\tthis.EditBoxName.string = \"\";\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(this.isTel(tel)===false){\n\t\t\t\tthis.WaitForConfirm(\"UISHIMING_INFO_ERROR\", [], [], this.ShareDefine.ConfirmOK);\n\t\t\t\tthis.EditBoxTel.string = \"\";\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\tapp.ConfirmManager().SetWaitForConfirmForm(this.OnConFirm.bind(this), \"MSG_EXCHANGE\", []);\n\t\t\tapp.ConfirmManager().ShowConfirm(this.ShareDefine.Confirm, \"MSG_EXCHANGE\", []);\n\t\t}\n\t\telse if('btn_close' == btnName){\n\t\t\tthis.CloseForm();\n\t\t}\n\t\telse{\n\t\t\tthis.ErrLog(\"OnClick(%s) not find\", btnName);\n\t\t}\n\t},\n\n\tOnConFirm:function(clickType, msgID, backArgList){\n\t\tif(clickType != \"Sure\"){\n\t\t\treturn\n\t\t}\n\n\t\tif(msgID == \"MSG_EXCHANGE\"){\n\t\t\tlet crystal = app.HeroManager().GetHeroProperty(\"crystal\");\n\t\t\tlet price = parseInt(this.ex_num.string);\n\t\t\tif(crystal < price){\n\t\t\t\tapp.SysNotifyManager().ShowSysMsg('MSG_EXCHANGE_NOTENOUGH');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet data = {};\n\t\t\tdata.prizeId = this.AppID;\n\t\t\tdata.name = this.EditBoxName.string;\n\t\t\tdata.phone = this.EditBoxTel.string;\n\t\t\tdata.address = this.EditBoxAdr.string;\n\t\t\tthis.NetManager.SendPack(\"game.CPlayerExchangePrizes\", data,function(event){\n\t\t\t\tapp.SysNotifyManager().ShowSysMsg('MSG_EXCHANGE_SUCCESS');\n\t\t\t},function(event){\n\t\t\t\tapp.SysNotifyManager().ShowSysMsg('MSG_EXCHANGE_FAIL');\n\t\t\t});\n\t\t}\n\t}\n\n});\n"]}