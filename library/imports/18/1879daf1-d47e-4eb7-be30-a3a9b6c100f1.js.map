{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\script\\dbmanager\\Game/assets\\script\\dbmanager\\Game\\GameManager.js"],"names":["app","require","GameManager","BaseClass","extend","Init","JS_Name","NetManager","ShareDefine","RegNetPack","OnPack_PlayerAddress","OnPack_LoginGetCurRoomID","OnPack_ContinueRoomInfo","OnPack_RoomCrammed","OnPack_MqResponseBo","bIsAutoPlayIng","bGetRoomIDByUI","xiPaiList","OnReload","Log","SetGetRoomIDByUI","bGet","SendChat","type","quickID","roomID","content","SendPack","event","code","result","serverPack","data","gameType","console","log","JSON","stringify","name","GametTypeID2PinYin","Client","EnterSubGame","roomKey","desc","SysNotifyManager","GetSysMsgContentByMsgID","ConfirmManager","SetWaitForConfirmForm","OnConFirm","bind","FormManager","ShowForm","ConfirmBuyGoTo","cityId","parseInt","msg","selectCityConfig","SysDataManager","GetTableDict","cityInfo","SetWaitForConfirm","Confirm","Name","dataDict","parse","ShowSysMsg","localStorage","setItem","clubId","tagId","GetFormComponentByFormName","Event_OutRoom","OnEvent","SetPlayGame","custom","NowRoom","gameId","gameName","GametTypeID2Name","roomName","msgID","msgArg","cbArg","ShowConfirm","clickType","backArgList","gamePY","success","error","self","allGameIdFormServer","split","curGameList","GetAllGameId","argDict","clientConfig","GetClientConfig","PackDefine","APPLE_CHECK","CloseForm","curGameTypeStr","SetGameType","OnPack_PosContinueGame","pos","gameTypeString","OnPosContinueGame","OnPack_DissolveRoom","ownnerForce","OnPack_StartVoteDissolve","createPos","endSec","dissolveInfo","OnStartVoteDissolve","OnPack_ChangePlayerNum","playerNum","OnStartChangePlaeryDissolve","OnPack_PosReadyChg","isReady","GetRoomPosMgr","OnPosReadyChg","OnPack_PosLeave","room","ownerID","selfPos","GetClientPos","OnPosLeave","UpdateOwnerID","OnPack_PosUpdate","posInfo","OnPosUpdate","OnPack_LostConnect","isLostConnect","pid","RoomPosMgr","roomPosMgrInfo","GetRoomAllPlayerInfo","roomPosMgrInfoKeyList","Object","keys","count","length","i","posID","player","SetPlayerOfflineState","OnPack_PosDealVote","agreeDissolve","OnPosDealVote","OnPack_ChangePlayerNumAgree","ChangePlayerNumAgree","OnPack_ChangeRoomNum","OnPack_EnterRoom","GametTypeNameDict","OnPack_XiPai","nowroom","playerAll","playerAllList","playerInfo","push","HeroManager","GetHeroProperty","cType","OnPack_Gitf","GetXiPaiList","RemoveOneXiPaiPlayer","splice","SendEnterRoom","IsFristPlay","IsAutoPlayIng","SetAutoPlayIng","bValue","SendGetCurRoomID","SendContinueGame","SendDissolveRoom","SendDissolveRoomAgree","SendDissolveRoomRefuse","SendChangePlayerAgree","SendChangePlayerRefuse","SendExitRoom","SendReady","posIndex","SendUnReady","SendKickPosIndex","SendXiPai","g_GameManager","exports","GetModel"],"mappings":"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","file":"GameManager.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\script\\dbmanager\\Game","sourcesContent":["/*\n GameManager 游戏管理\n */\nvar app = require('app');\n\nvar GameManager = app.BaseClass.extend({\n\n\tInit:function(){\n\t\tthis.JS_Name = \"GameManager\";\n\n\t\tthis.NetManager = app.NetManager();\n\t\tthis.ShareDefine = app.ShareDefine();\n\n\n\t\t// this.NetManager.RegNetPack(\"room.CBaseEnterRoom\", this.OnPack_EnterRoom, this);\n\t\tthis.NetManager.RegNetPack(\"SPlayer_Address\", this.OnPack_PlayerAddress, this);\n\t\t// //2017.8.8  消息抽出来走公共\n\t\t// //继续游戏\n\t\t// this.NetManager.RegNetPack(\"SBase_PosContinueGame\", this.OnPack_PosContinueGame, this); \n\t\t// //解散房间\n\t\t// this.NetManager.RegNetPack(\"SBase_Dissolve\", this.OnPack_DissolveRoom, this); \n\t\t// //解散投票\n\t\t// this.NetManager.RegNetPack(\"SBase_StartVoteDissolve\", this.OnPack_StartVoteDissolve, this);\n\n\n\t\t// //修改人数投票\n\t\t// this.NetManager.RegNetPack(\"SBase_ChangePlayerNum\", this.OnPack_ChangePlayerNum, this);\n\t\t// //修改人数投票同意\n\t\t// this.NetManager.RegNetPack(\"SBase_ChangePlayerNumAgree\", this.OnPack_ChangePlayerNumAgree, this); \n\t\t// //房间修改人数\n\t\t// this.NetManager.RegNetPack(\"SBase_ChangeRoomNum\", this.OnPack_ChangeRoomNum, this); \n\n\t\t// //玩家准备\n\t\t// this.NetManager.RegNetPack(\"SBase_PosReadyChg\", this.OnPack_PosReadyChg, this);\n\t\t// //玩家离开\n\t\t// this.NetManager.RegNetPack(\"SBase_PosLeave\", this.OnPack_PosLeave, this); \n\t\t// //玩家位置更新\n\t\t// this.NetManager.RegNetPack(\"SBase_PosUpdate\", this.OnPack_PosUpdate, this);  \n\t\t// //玩家掉线\n\t\t// this.NetManager.RegNetPack(\"SBase_LostConnect\", this.OnPack_LostConnect, this);\n\n\t\t// this.NetManager.RegNetPack(\"SBase_PosDealVote\", this.OnPack_PosDealVote, this); \n\t\t// //所有对局记录\n\t\t// this.NetManager.RegNetPack(\"game.CPlayerSetRoomRecord\", this.OnPack_EveryGameRecord, this);\n\n\t\tthis.NetManager.RegNetPack(\"game.C1101GetRoomID\", this.OnPack_LoginGetCurRoomID, this);\n\t\tthis.NetManager.RegNetPack(\"SRoom_ContinueRoomInfo\",this.OnPack_ContinueRoomInfo,this);\n\t\tthis.NetManager.RegNetPack(\"SBase_RoomCrammed\",this.OnPack_RoomCrammed,this);\n\n\t\t//普通房间创建房间改成异步\n\t\tthis.NetManager.RegNetPack(\"MqResponseBo\",this.OnPack_MqResponseBo,this);\n\t\t// //洗牌\n\t\t// this.NetManager.RegNetPack(\"SPlayer_XiPai\",this.OnPack_XiPai,this);\n\t\t// //赠送礼物\n\t\t// this.NetManager.RegNetPack(\"SPlayer_SendGift\",this.OnPack_Gitf,this);\n\n\t\t\n\t\tthis.bIsAutoPlayIng = false;\n\n\t\tthis.bGetRoomIDByUI = false;\n\t\tthis.xiPaiList = [];\n\t\tthis.OnReload();\n\n\t\tthis.Log(\"Init\");\n\t},\n\tSetGetRoomIDByUI:function(bGet){\n\t\tthis.bGetRoomIDByUI = bGet;\n\t},\n\t//发送聊天封包\n\tSendChat:function (type, quickID, roomID, content) {\n\t\tthis.NetManager.SendPack(\"game.C1104Chat\", {\"type\":type, \"quickID\":quickID, \"targetID\":roomID, \"content\":content});\n\t},\n\t//切换账号\n\tOnReload:function(){\n\t},\n\tOnPack_MqResponseBo:function(event){\n\t\tlet code=event.result.code;\n\t\tif(code==0){\n\t\t\tlet serverPack=event.result.data;\n\t\t\tlet gameType = serverPack.gameType;\n\t\t\tconsole.log(\"OnPack_MqResponseBo serverPack:\"+ JSON.stringify(serverPack));\n\t\t\tconsole.log(\"OnPack_MqResponseBo gameType:\"+gameType);\n\t        let name = app.ShareDefine().GametTypeID2PinYin[gameType];\n\t        console.log(\"OnPack_MqResponseBo name:\"+name);\n\t        app.Client.EnterSubGame(name,null,serverPack.roomKey);\n    \t}else if(code==903){\n\t\t\tlet desc = app.SysNotifyManager().GetSysMsgContentByMsgID(\"MSG_NotRoomCard\");\n\t\t\tapp.ConfirmManager().SetWaitForConfirmForm(this.OnConFirm.bind(this), \"goBuyCard\", []);\n\t\t\tapp.FormManager().ShowForm(\"UIMessage\", null, this.ShareDefine.ConfirmBuyGoTo, 0, 0, desc)\n    \t}else if(code==5021){\n\t\t\tlet cityId = parseInt(event.result.msg);\n            let selectCityConfig = app.SysDataManager().GetTableDict(\"selectCity\");\n            let cityInfo = selectCityConfig[cityId];\n            if (cityInfo) {\n                this.SetWaitForConfirm('RESELECT_CITY',this.ShareDefine.Confirm,[],[cityId], \"该游戏是在[\"+cityInfo.Name+\"]，是否切换到该城市后再加入房间\");\n            }\n    \t}else{\n    \t\tif(code==5023){\n    \t\t\tlet dataDict = JSON.parse(event.result.msg);\n\t            app.SysNotifyManager().ShowSysMsg('密码错误或已失效,请重新输入',[],3);\n\t            localStorage.setItem(\"password_\"+dataDict.clubId+\"_\"+dataDict.tagId,\"\");\n    \t\t}else if (code == 5024) {\n\t            app.SysNotifyManager().ShowSysMsg(\"您所在的推广员队伍或上级队伍比赛分低于预警值，无法加入比赛，请联系管理\");\n\t        }else if (code == 5027) {\n\t            app.SysNotifyManager().ShowSysMsg(\"当前赛事正在更换赛事主裁判，暂停游戏，请稍后再试！预计半小时\");\n\t        }else if (code == 5133) {\n\t            app.SysNotifyManager().ShowSysMsg(\"您所在的亲友圈比赛分低于预警值，无法加入比赛，请联系管理\");\n\t        }else if (code == 6117) {\n\t            app.SysNotifyManager().ShowSysMsg(\"您已被禁止游戏\", [], 3);\n\t        }else if (code == 911) {\n\t            app.SysNotifyManager().ShowSysMsg(\"房卡不足\", [], 3);\n\t        }else if (code == 5126) {\n\t            app.FormManager().ShowForm(\"UIMessageGps\");\n\t        }else if (code == 304) {\n\t        \tapp.SysNotifyManager().ShowSysMsg(\"房间已经开始了\", [], 3);\n\t\t\t}else if (code == 301) {\n\t        \tapp.SysNotifyManager().ShowSysMsg(\"没找到这个房间\", [], 3);\n\t        \tif (app.FormManager().GetFormComponentByFormName(\"UINewMain\")) {\n\t                app.FormManager().GetFormComponentByFormName(\"UINewMain\").Event_OutRoom();\n\t            }\n\t\t\t}else{\n    \t\t\tapp.SysNotifyManager().ShowSysMsg(event.result.msg, [], 3);\n    \t\t}\n    \t}\n\t},\n\t//------------封包函数------------------\n\tOnPack_PlayerAddress:function(serverPack){\n\t\tapp.Client.OnEvent(\"EVT_PlayerAddress\", serverPack);\n\t},\n\n\tSetPlayGame:function(serverPack){\n\t\tlet gameType = serverPack['gameType'];\n\t\tlet custom = serverPack['custom'];\n\t},\n\tNowRoom:function(){\n\t\t\n\t},\n\tOnPack_RoomCrammed:function(serverPack){\n\t\tthis.gameId=serverPack.gameId;\n\t\tthis.roomID=serverPack.roomID;\n\t\tlet gameName = app.ShareDefine().GametTypeID2Name[this.gameId];\n\t\tif(typeof(serverPack.roomName)!=\"undefined\"){\n\t\t\tif(serverPack.roomName!=\"\"){\n\t\t\t\tgameName=serverPack.roomName;\n\t\t\t}\n\t\t}\n\t\tthis.SetWaitForConfirm('MSG_CLUB_ROOMCRAMMED',this.ShareDefine.Confirm,[gameName],[]);\n\t},\n\t/**\n     * 2次确认点击回调\n     * @param curEventType\n     * @param curArgList\n     */\n    SetWaitForConfirm:function(msgID,type,msgArg=[],cbArg=[]){\n        let ConfirmManager = app.ConfirmManager();\n        ConfirmManager.SetWaitForConfirmForm(this.OnConFirm.bind(this), msgID, cbArg);\n        ConfirmManager.ShowConfirm(type, msgID, msgArg);\n    },\n    OnConFirm:function(clickType, msgID, backArgList){\n    \tif(clickType != \"Sure\"){\n    \t\tif('MSG_CLUB_ROOMCRAMMED' == msgID){\n    \t\t\t//退出房间\n    \t\t\tlet gamePY = app.ShareDefine().GametTypeID2PinYin[this.gameId];\n                app.NetManager().SendPack(\"room.CBaseExitRoom\", {\"roomID\":this.roomID},function(success){\n                    //正常退出房间，通知大厅跟亲友圈首页\n                    app.Client.OnEvent(\"OutRoom\",{});\n                },function(error){\n                    \n                });\n    \t\t}\n            return\n        }\n        if(msgID == \"RESELECT_CITY\"){\n            let self = this;\n            let selectCityConfig = app.SysDataManager().GetTableDict(\"selectCity\");\n            if (selectCityConfig[backArgList[0]][\"Type\"] != 3) {\n                this.ShowSysMsg(\"需指定县级市，才能进入游戏\");\n                app.FormManager().ShowForm(\"UISelectCity\");\n                return;\n            }\n            //根据选择的城市向服务端请求所有游戏\n            app.NetManager().SendPack(\"room.CBaseGameIdList\", {\"selectCityId\": backArgList[0]}, function (event) {\n                self.allGameIdFormServer = event.split(\",\");\n                let curGameList = self.GetAllGameId();\n                let argDict = {\n                    \"gameList\": curGameList,\n                };\n                self.OnEvent(\"ShowGameListByLocation\", argDict);\n            }, function (event) {\n                console.log(\"获取游戏id失败\");\n            });\n        }else if (\"goBuyCard\" == msgID) {\n\t\t\tlet clientConfig = app.Client.GetClientConfig();\n\t\t\tif (app.PackDefine.APPLE_CHECK == clientConfig[\"appPackType\"]) return\n\t\t\tapp.FormManager().ShowForm(\"UIStore\");\n\t\t\tapp.FormManager().CloseForm(\"UIJoin\");\n\t\t\tapp.FormManager().CloseForm(\"UIChouJiang\");\n\t\t\treturn;\n\t\t}else if('MSG_CLUB_ROOMCRAMMED' == msgID){\n            let curGameTypeStr = app.ShareDefine().GametTypeID2PinYin[this.gameId];\n            app.Client.SetGameType(curGameTypeStr);\n            app.FormManager().ShowForm(\"UIDownLoadGame\",curGameTypeStr,0,null,0,0,true);\n        }\n    },\n\tOnPack_ContinueRoomInfo:function(serverPack){\n\t\tapp.FormManager().ShowForm('UIMessageJoin',serverPack);\n\t},\n\t//位置继续游戏\n\tOnPack_PosContinueGame:function(serverPack){\n\t\tlet roomID = serverPack[\"roomID\"];\n\t\tlet pos = serverPack[\"pos\"];\n\t\tlet gameTypeString = serverPack.gameType;\n\t\tthis.NowRoom().OnPosContinueGame(pos);\n\t\tapp.Client.OnEvent(gameTypeString+\"_PosContinueGame\", serverPack);\n\t\t//公共头像触发\n\t\tapp.Client.OnEvent(\"PosContine\", serverPack);\n\t},\n\t//解散房间\n\tOnPack_DissolveRoom:function(serverPack){\n\t\tlet roomID = serverPack[\"roomID\"];\n\t\tlet ownnerForce = serverPack[\"ownnerForce\"];\n\t\tlet gameTypeString = serverPack.gameType;\n\t\tapp.Client.OnEvent(gameTypeString+\"_DissolveRoom\", serverPack);\n\t},\n\t//接收到解散请求\n\tOnPack_StartVoteDissolve:function(serverPack){\n\t\tlet roomID = serverPack[\"roomID\"];\n\t\tlet createPos = serverPack[\"createPos\"];\n\t\tlet endSec = serverPack[\"endSec\"];\n\t\tlet gameTypeString = serverPack.gameType;\n\t\tlet dissolveInfo = this.NowRoom().OnStartVoteDissolve(createPos, endSec);\n\t\tapp.Client.OnEvent(gameTypeString+\"_StartVoteDissolve\", dissolveInfo);\n\t},\n\t//接收人数修改请求\n\tOnPack_ChangePlayerNum:function(serverPack){\n\t\tlet roomID = serverPack[\"roomID\"];\n\t\tlet createPos = serverPack[\"createPos\"];\n\t\tlet endSec = serverPack[\"endSec\"];\n\t\tlet gameTypeString = serverPack.gameType;\n\t\tlet playerNum=serverPack.playerNum;\n\t\tlet dissolveInfo = this.NowRoom().OnStartChangePlaeryDissolve(createPos,playerNum,endSec);\n\t\tapp.Client.OnEvent(gameTypeString+\"_ChangePlayerNum\", dissolveInfo);\n\t},\n\n\n\t//位置是否准备\n\tOnPack_PosReadyChg:function(serverPack){\n\t\tlet roomID = serverPack[\"roomID\"];\n\t\tlet pos = serverPack[\"pos\"];\n\t\tlet isReady = serverPack[\"isReady\"];\n\t\tlet gameTypeString = serverPack.gameType;\n\t\tif(this.NowRoom().GetRoomPosMgr().OnPosReadyChg(pos, isReady)){\n\t\t\tapp.Client.OnEvent(gameTypeString+\"_PosReadyChg\", serverPack);\n\t\t}\n\t\telse{\n\t\t\tthis.Log(\"OnPack_PosReadyChg:\", serverPack);\n\t\t}\n\t},\n\t//位置离开房间\n\tOnPack_PosLeave:function(serverPack){\n\t\tlet roomID = serverPack[\"roomID\"];\n\t\tlet pos = serverPack[\"pos\"];\n\t\tlet room = this.NowRoom();\n\t\tlet ownerID=serverPack[\"ownerID\"];\n\t\tlet selfPos = -1;\n\t\tif(room){\n\t\t\tselfPos = room.GetRoomPosMgr().GetClientPos();\n\t\t\troom.OnPosLeave(pos);\n\t\t\tif(ownerID>0){\n\t\t\t\troom.UpdateOwnerID(ownerID);\n\t\t\t}\n\t\t}\n\t\tlet gameTypeString = serverPack.gameType;\n\t\tapp.Client.OnEvent(gameTypeString+\"_PosLeave\", serverPack);\n\t\tif(pos == selfPos)\n    \t\tapp.Client.OnEvent('ExitRoomSuccess', serverPack);\n\t},\n\t//更新座位信息\n\tOnPack_PosUpdate:function(serverPack){\n\t\tlet roomID = serverPack[\"roomID\"];\n\t\tlet pos = serverPack[\"pos\"];\n\t\tlet posInfo = serverPack[\"posInfo\"];\n\t\tthis.SetPlayGame(serverPack);\n\t\tlet gameTypeString = serverPack.gameType;\n\t\tif(this.NowRoom().GetRoomPosMgr().OnPosUpdate(pos, posInfo)){\n\t\t\tapp.Client.OnEvent(gameTypeString+\"_PosUpdate\", serverPack);\n\t\t}\n\t\telse{\n\t\t\tthis.Log(\"OnPack_PosUpdate:\", serverPack);\n\t\t}\n\n\t},\n\t//有玩家掉线\n    OnPack_LostConnect:function (serverPack) {\n\t\tlet isLostConnect = serverPack[\"isLostConnect\"];\n\t\tlet pid = serverPack[\"pid\"];\n\t\tlet RoomPosMgr = this.NowRoom().GetRoomPosMgr();\n\t\tlet roomPosMgrInfo = RoomPosMgr.GetRoomAllPlayerInfo();\n\t\tlet roomPosMgrInfoKeyList = Object.keys(roomPosMgrInfo);\n\t\tlet count = roomPosMgrInfoKeyList.length;\n\t\tfor(let i = 0; i < count; i++){\n\t\t\tlet posID = roomPosMgrInfoKeyList[i];\n\t\t\tlet player = roomPosMgrInfo[posID];\n\t\t\tif(pid == player[\"pid\"]){\n                RoomPosMgr.SetPlayerOfflineState(posID, isLostConnect);\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n        app.Client.OnEvent(\"PlayerOffline\", serverPack);\n    },\n    //位置更新解散\n\tOnPack_PosDealVote:function(serverPack){\n\t\tlet roomID = serverPack[\"roomID\"];\n\t\tlet pos = serverPack[\"pos\"];\n\t\tlet agreeDissolve = serverPack[\"agreeDissolve\"];\n\t\tlet dissolveInfo = this.NowRoom().OnPosDealVote(pos, agreeDissolve);\n\t\tlet gameTypeString = serverPack.gameType;\n\t\tapp.Client.OnEvent(\"PosDealVote\", dissolveInfo);\n\t},\n\n\n\t //位置更新解散\n\tOnPack_ChangePlayerNumAgree:function(serverPack){\n\t\tlet roomID = serverPack[\"roomID\"];\n\t\tlet pos = serverPack[\"pos\"];\n\t\tlet agreeDissolve = serverPack[\"agreeChange\"];\n\t\tlet dissolveInfo = this.NowRoom().ChangePlayerNumAgree(pos, agreeDissolve);\n\t\tlet gameTypeString = serverPack.gameType;\n\t\tapp.Client.OnEvent(\"PosChangePlayerDealVote\", dissolveInfo);\n\t},\n\n\tOnPack_ChangeRoomNum:function(serverPack){\n\t\tthis.OnPack_EnterRoom(serverPack);\n\t},\n\n\t//房间key查找完成\n\tOnPack_EnterRoom:function(serverPack){\n\t\t//let familyID = serverPack.familyID;\n\t\tlet roomID = serverPack.roomID;\n\t\tlet gameTypeString = serverPack.gameType;\n\t\tlet gameType = this.ShareDefine.GametTypeNameDict[gameTypeString];\n\n\t},\n\t//获取所有对局记录\n    // OnPack_EveryGameRecord:function(serverPack){\n    // \tlet nowroom=this.NowRoom();\n    // \tif(nowroom){\n    // \t\tnowroom.SetGameRecord(true);\n    // \t}\n    //     app.Client.OnEvent(\"GameRecord\", serverPack);\n    // },\n    OnPack_LoginGetCurRoomID:function(serverPack){\n    \tif(!this.bGetRoomIDByUI){\n    \t\tapp.Client.OnEvent(\"LoginGetCurRoomID\", serverPack);\n    \t}\n    \telse{\n    \t\tapp.Client.OnEvent(\"GetCurRoomID\", serverPack);\n    \t}\n\n    \tthis.bGetRoomIDByUI = false;\n    },\n    //洗牌\n    OnPack_XiPai:function(serverPack){\n\t\tlet nowroom=this.NowRoom();\n\t\tlet playerAll = nowroom.GetRoomPosMgr().GetRoomAllPlayerInfo();\n\t\tlet playerAllList= Object.keys(playerAll);\n        var playerInfo = null;\n        for(var i=0;i<playerAllList.length;i++){\n\t\t\tplayerInfo = playerAll[playerAllList[i]];\n\t\t\tif(playerInfo.pid == serverPack.pid){\n\t\t\t\tthis.xiPaiList.push(playerInfo.name);\n\t\t\t\t// app.SysNotifyManager().ShowSysMsg('SSS_XIPAI_SUCCESS',[playerInfo.name]);\n\t\t\t\tif(app.HeroManager().GetHeroProperty(\"pid\") == serverPack.pid){\n\t\t\t\t\tapp.Client.OnEvent(\"Event_XiPai\", serverPack);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tlet cType = serverPack.cType;\n\t\tif('PK' == cType){\t\n\t\t\tapp.FormManager().ShowForm('UIXiPai');\n\t\t}\n\t\telse{\n\t\t\tapp.FormManager().ShowForm('game/base/ui/majiang/UIMJXiPai');\n\t\t}\n\t},\n\tOnPack_Gitf:function(serverPack){\n\t\tapp.Client.OnEvent(\"GameGift\", serverPack);\n\t},\n\t//--------------获取接口------------------------\n\tGetXiPaiList:function(){\n\t\treturn this.xiPaiList;\n\t},\n\tRemoveOneXiPaiPlayer:function(){\n\t\tif(0==this.xiPaiList.length)\n\t\t\treturn;\n\t\tthis.xiPaiList.splice(0,1);\n\t},\n\t//---------------发包接口------------------------\n\t//进入房间\n\tSendEnterRoom:function(roomKey){\n\t\tthis.NetManager.SendPack(\"room.CBaseEnterRoom\", {\"roomKey\":roomKey,\"posID\":-1});\n\t},\n\tIsFristPlay:function(){\n\n\t},\n\t\n\tIsAutoPlayIng:function(){\n\t\treturn this.bIsAutoPlayIng;\n\t},\n\tSetAutoPlayIng:function(bValue){\n\t\tthis.bIsAutoPlayIng = bValue;\n\t},\n\n    //游戏公用消息\n    //登录获取当前进入的房间ID\n\tSendGetCurRoomID:function(){\n\t\tthis.NetManager.SendPack(\"game.C1101GetRoomID\", {});\n\t},\n    //发送继续游戏\n\tSendContinueGame:function(roomID){\n\t\tthis.NetManager.SendPack(\"room.CBaseContinueGame\", {\"roomID\":roomID});\n\t},\n\t//解散房间\n\tSendDissolveRoom:function(roomID){\n\t\tthis.NetManager.SendPack(\"room.CBaseDissolveRoom\", {\"roomID\":roomID});\n\t},\n\t//发送同意解散房间\n\tSendDissolveRoomAgree:function(roomID){\n\t\tthis.NetManager.SendPack(\"room.CBaseDissolveRoomAgree\", {\"roomID\":roomID});\n\t},\n\n\t//发送拒绝解散房间\n\tSendDissolveRoomRefuse:function(roomID){\n\t\tthis.NetManager.SendPack(\"room.CBaseDissolveRoomRefuse\", {\"roomID\":roomID});\n\t},\n\n\n\t//发送同意修改人数\n\tSendChangePlayerAgree:function(roomID){\n\t\tthis.NetManager.SendPack(\"room.CBaseChangePlayerNumAgree\", {\"roomID\":roomID,\"agree\":1});\n\t},\n\n\t//发送拒绝修改人数\n\tSendChangePlayerRefuse:function(roomID){\n\t\tthis.NetManager.SendPack(\"room.CBaseChangePlayerNumAgree\", {\"roomID\":roomID,\"agree\":2});\n\t},\n\n\n\t//退出房间\n\tSendExitRoom:function(roomID, pos){\n\t\tthis.NetManager.SendPack(\"room.CBaseExitRoom\", {\"roomID\":roomID, \"posIndex\":pos});\n\t},\n\t//位置发送准备状态\n\tSendReady:function(roomID, posIndex){\n\t\tthis.NetManager.SendPack(\"room.CBaseReadyRoom\", {\"roomID\":roomID, \"posIndex\":posIndex});\n\t},\n\n\t//发送取消准备状态\n\tSendUnReady:function(roomID, posIndex){\n\t\tthis.NetManager.SendPack(\"room.CBaseUnReadyRoom\", {\"roomID\":roomID, \"posIndex\":posIndex});\n\t},\n\n\t//房主T人\n    SendKickPosIndex:function(roomID, posIndex){\n\t\tthis.NetManager.SendPack(\"room.CBaseKickRoom\", {\"roomID\":roomID, \"posIndex\":posIndex});\n\t},\n\n\t//洗牌\n\tSendXiPai:function(roomID){\n\t\tthis.NetManager.SendPack(\"room.CBaseRoomXiPai\", {\"roomID\":roomID});\n\t},\n});\n\n\nvar g_GameManager = null;\n\n/**\n * 绑定模块外部方法\n */\nexports.GetModel = function(){\n\tif(!g_GameManager){\n\t\tg_GameManager = new GameManager();\n\t}\n\treturn g_GameManager;\n}"]}