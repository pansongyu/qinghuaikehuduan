{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\script\\ui\\club/assets\\script\\ui\\club\\UIPromoterXiaShuList.js"],"names":["app","require","cc","Class","extends","properties","hehuoist_scrollView","ScrollView","hehuolist_layout","Node","hehuolist_demo","lb_search","EditBox","OnCreateInit","Client","RegEvent","Event_ClubPromotionChange","event","ShowHeHuoList","OnShow","clubId","partnerPid","myisminister","myisPartner","ClubManager","Club_MINISTER_CREATER","node","getChildByName","active","memberPage","isSearch","self","lb_searchStr","ComTool","GetBeiZhuID","string","isNaN","parseInt","StrIsNumInt","SysNotifyManager","ShowSysMsg","NetManager","SendPack","serverPack","length","DestroyAllChildren","i","instantiate","addChild","data","heroID","headImageUrl","getComponent","Label","GetBeiZhuName","name","GetPid","curActiveValue","WeChatHeadImage","WeChatManager","InitHeroHeadImage","OnLoad","ShowHeroHead","HeroManager","GetHeroID","heroName","error","OnClick","btnName","btnNode","CloseForm","FormManager","ShowForm","parent","ErrLog","SetWaitForConfirm","msgID","type","msgArg","cbArg","ConfirmManager","SetWaitForConfirmForm","OnConFirm","bind","ShowConfirm","clickType","backArgList","destroy"],"mappings":"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","file":"UIPromoterXiaShuList.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\script\\ui\\club","sourcesContent":["/*\n    UIMessage 模态消息界面\n*/\n\nvar app = require(\"app\");\n\ncc.Class({\n    extends: require(\"BaseForm\"),\n\n    properties: {\n        hehuoist_scrollView:cc.ScrollView,\n        hehuolist_layout:cc.Node,\n        hehuolist_demo:cc.Node,\n        lb_search:cc.EditBox,\n    },\n\n    //初始化\n    OnCreateInit:function(){\n        app.Client.RegEvent(\"OnClubPromotionChange\", this.Event_ClubPromotionChange, this);\n    },\n    Event_ClubPromotionChange:function(event){\n        this.ShowHeHuoList();\n    },\n\n    //---------显示函数--------------------\n\n    OnShow:function(clubId,partnerPid, myisminister, myisPartner){\n        this.clubId = clubId;\n        this.partnerPid = partnerPid;\n        this.myisminister = myisminister;\n        this.myisPartner = myisPartner;\n        //如果是创建者打开\n        if (this.myisminister == app.ClubManager().Club_MINISTER_CREATER) {\n            this.node.getChildByName(\"bottom\").getChildByName(\"btn_hehuo_yaoqing\").active = false;\n        }else{\n            this.node.getChildByName(\"bottom\").getChildByName(\"btn_hehuo_yaoqing\").active = true;\n        }\n        this.hehuolist_demo.active = false;\n        this.memberPage = 1;\n        this.ShowHeHuoList();\n    },\n    ShowHeHuoList:function(isSearch = false){\n        let self=this;\n        let lb_searchStr = \"\";\n        if (isSearch) {\n            lb_searchStr = this.ComTool.GetBeiZhuID(this.lb_search.string);\n            if(isNaN(parseInt(lb_searchStr)) || !app.ComTool().StrIsNumInt(lb_searchStr)){\n                app.SysNotifyManager().ShowSysMsg(\"请输入纯数字的玩家id\", [], 3);\n                return;\n            }\n        }\n        app.NetManager().SendPack('club.CClubSubordinateList',{'clubId':this.clubId,\"pageNum\":this.memberPage,\"pid\":this.partnerPid,\"query\":lb_searchStr},function(serverPack){\n            if (serverPack.length > 0) {\n                self.DestroyAllChildren(self.hehuolist_layout);\n            }\n            for(let i=0;i<serverPack.length;i++){\n                let node=cc.instantiate(self.hehuolist_demo);\n                node.active=true;\n                self.hehuolist_layout.addChild(node);\n \n                let data=serverPack[i];\n                let heroID = data[\"pid\"];\n                let headImageUrl = data[\"iconUrl\"];\n                node.getChildByName('name').getComponent(cc.Label).string=app.ComTool().GetBeiZhuName(heroID,data.name);\n                node.getChildByName('id').getComponent(cc.Label).string=app.ComTool().GetPid(heroID)\n                node.getChildByName('lb_active').getComponent(cc.Label).string=data.curActiveValue;\n                node.heroID=heroID;\n                let WeChatHeadImage = node.getChildByName('head').getComponent(\"WeChatHeadImage\");\n                 //用户头像创建\n                if(heroID && headImageUrl){\n                    app.WeChatManager().InitHeroHeadImage(heroID, headImageUrl);\n                }\n                WeChatHeadImage.OnLoad();\n                        WeChatHeadImage.ShowHeroHead(heroID,headImageUrl);\n\n                if (heroID == self.partnerPid) {\n                    node.getChildByName('btn_hehuo_xiugai').active = false;\n                }else{\n                    node.getChildByName('btn_hehuo_xiugai').active = true;\n                }\n\n                if(app.HeroManager().GetHeroID()==self.partnerPid){\n                    node.getChildByName('btn_hehuo_xiugai').getChildByName('label').getComponent(cc.Label).string = \"删除下属\";\n                }\n\n                node.getChildByName('btn_hehuo_xiugai').heroID=heroID;\n                node.getChildByName('btn_hehuo_xiugai').heroName=data.name;\n            }\n        },function(error){\n\n        });\n    },\n    //---------点击函数---------------------\n\n\tOnClick:function(btnName, btnNode){\n\t\tif('btn_close'==btnName){\n        \tthis.CloseForm();\n        }else if('btn_next'==btnName){\n            this.memberPage=this.memberPage+1;\n            this.ShowHeHuoList();\n        }else if('btn_last'==btnName){\n            if(this.memberPage<=1){\n                return;\n            }\n            this.memberPage=this.memberPage-1;\n            this.ShowHeHuoList();\n        }else if('btn_hehuo_xiugai'==btnName){\n            app.FormManager().ShowForm('ui/club/UIPromoterSet',this.clubId,btnNode.heroID,btnNode.heroName);\n        }else if('btn_hehuo_zhanji'==btnName){\n            app.FormManager().ShowForm('ui/club/UIPromoterRecordUser',this.clubId,btnNode.parent.heroID,this.partnerPid);\n        }else if ('btn_hehuo_yaoqing'==btnName) {\n            app.FormManager().ShowForm(\"ui/club/UIYaoQing\",this.clubId, this.partnerPid);\n        }else if ('btn_search'==btnName) {\n            this.memberPage=1;\n            this.ShowHeHuoList(true);\n        }else{\n\t\t\tthis.ErrLog(\"OnClick:%s not find\", btnName);\n\t\t}\n\t},\n    //---------点击函数---------------------\n    /**\n     * 2次确认点击回调\n     * @param curEventType\n     * @param curArgList\n     */\n    SetWaitForConfirm:function(msgID,type,msgArg=[],cbArg=[]){\n        let ConfirmManager = app.ConfirmManager();\n        ConfirmManager.SetWaitForConfirmForm(this.OnConFirm.bind(this), msgID, cbArg);\n        ConfirmManager.ShowConfirm(type, msgID, msgArg);\n    },\n    OnConFirm:function(clickType, msgID, backArgList){\n        if(clickType != \"Sure\"){\n            return\n        }\n        let self = this;\n        if('MSG_CLUB_DelHeHuoXiaShu' == msgID){\n            let btnNode = backArgList[0];\n            //下属本家可以去除下属\n            app.NetManager().SendPack('club.CClubPartnerChange',{\"clubId\":this.clubId,'pid':btnNode.heroID,\"partnerPid\":0},function(serverPack){\n                btnNode.parent.destroy();\n            },function(error){\n                self.ShowSysMsg('删除失败，请联系亲友圈创建者');\n            });\n        }\n    },\n});\n"]}