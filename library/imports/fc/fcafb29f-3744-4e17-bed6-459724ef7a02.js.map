{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\script\\ui\\club/assets\\script\\ui\\club\\UIPromoterSet.js"],"names":["app","require","cc","Class","extends","properties","OnCreateInit","OnShow","clubId","pid","playerData","type","searchPid","node","getChildByName","getComponent","EditBox","string","Label","Toggle","isChecked","ComTool","GetBeiZhuName","name","GetPid","OnClick","btnName","btnNode","CloseForm","value","SysNotifyManager","ShowSysMsg","GetBeiZhuID","self","NetManager","SendPack","serverPack","player","error","SetWaitForConfirm","ShareDefine","Confirm","ErrLog","msgID","msgArg","cbArg","content","lbSure","lbCancle","ConfirmManager","SetWaitForConfirmForm","OnConFirm","bind","ShowConfirm","clickType","backArgList"],"mappings":"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","file":"UIPromoterSet.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\script\\ui\\club","sourcesContent":["/*\n    UIMessage 模态消息界面\n*/\n\nvar app = require(\"app\");\n\ncc.Class({\n    extends: require(\"BaseForm\"),\n\n    properties: {\n        \n    },\n\n    //初始化\n    OnCreateInit:function(){\n\n    },\n\n    //---------显示函数--------------------\n    OnShow:function(clubId,pid,playerData){\n        this.clubId = clubId;\n        this.pid=pid;\n        this.type=1; //默认归宿到创建者 0\n        this.searchPid=0;\n        this.node.getChildByName(\"EditBox\").getComponent(cc.EditBox).string=\"\";\n        this.node.getChildByName(\"lb_user\").getComponent(cc.Label).string=\"\";\n        this.node.getChildByName(\"ToggleContainer\").getChildByName(\"toggle2\").getComponent(cc.Toggle).isChecked=true;\n        this.node.getChildByName(\"lb_upname\").getComponent(cc.Label).string=this.ComTool.GetBeiZhuName(playerData.pid,playerData.name)+\" (ID:\"+this.ComTool.GetPid(playerData.pid)+\")\";\n\n    },\n\tOnClick:function(btnName, btnNode){\n\t\tif('btn_close'==btnName){\n        \tthis.CloseForm();\n        }\n        else if('btn_search'==btnName){\n            let value=this.node.getChildByName(\"EditBox\").getComponent(cc.EditBox).string;\n            if(value==\"\"){\n                app.SysNotifyManager().ShowSysMsg(\"请输入目标归属玩家名称或ID\");\n                return;\n            }\n\n            value=this.ComTool.GetBeiZhuID(value);\n\n            let self=this;\n            app.NetManager().SendPack(\"club.CClubPromotionChangeBelongPidInfo\",{\"clubId\":this.clubId,\"query\":value}, function(serverPack){\n                self.node.getChildByName(\"lb_user\").getComponent(cc.Label).string=self.ComTool.GetBeiZhuName(serverPack.player.pid,serverPack.player.name)+\" (ID:\"+self.ComTool.GetPid(serverPack.player.pid)+\")\";\n                self.node.getChildByName(\"ToggleContainer\").getChildByName(\"toggle2\").getComponent(cc.Toggle).isChecked=true;\n                self.searchPid=serverPack.player.pid;\n            }, function(error){\n                //app.SysNotifyManager().ShowSysMsg(\"未找到玩家\");\n            });\n        }\n        else if('btn_sure'==btnName){\n            this.SetWaitForConfirm('SURE_PROMOTER_SET',this.ShareDefine.Confirm,[],[], \"修改从属后该推广员及分支下原数据会归属到当前上级身上，修改后产生的新数据会在新上级那边，且如分成类型与新上级不一致将强制修改类型并默认为0，请确认数据是否已清楚并修改\");\n            // let self = this;\n            // if(this.node.getChildByName(\"ToggleContainer\").getChildByName(\"toggle1\").getComponent(cc.Toggle).isChecked==true){\n            //     this.type=0;\n            // }else{\n            //     this.type=1;\n            // }\n            // if(this.type==0){\n            //     app.NetManager().SendPack(\"club.CClubChangePromotionBelong\",{\"clubId\":this.clubId,\"pid\":this.pid,\"upLevelId\":0,\"type\":0}, function(serverPack){\n            //         app.SysNotifyManager().ShowSysMsg(\"修改成功\");\n            //         self.CloseForm();\n            //     }, function(){\n            //         //app.SysNotifyManager().ShowSysMsg(\"从属修改失败\");\n            //     });\n            // }else{\n            //     if(this.searchPid==0){\n            //         app.SysNotifyManager().ShowSysMsg(\"请搜索归属玩家\");\n            //         return;\n            //     }\n            //     app.NetManager().SendPack(\"club.CClubChangePromotionBelong\",{\"clubId\":this.clubId,\"pid\":this.pid,\"upLevelId\":this.searchPid,\"type\":1}, function(serverPack){\n            //         app.SysNotifyManager().ShowSysMsg(\"修改成功\");\n            //         self.CloseForm();\n            //     }, function(){\n            //         //app.SysNotifyManager().ShowSysMsg(\"从属修改失败\");\n            //     });\n            // }\n            \n        }else{\n\t\t\tthis.ErrLog(\"OnClick:%s not find\", btnName);\n\t\t}\n\t},\n    /**\n     * 2次确认点击回调\n     * @param curEventType\n     * @param curArgList\n     */\n    SetWaitForConfirm:function(msgID,type,msgArg=[],cbArg=[],content = \"\", lbSure =\"\", lbCancle=\"\"){\n        let ConfirmManager = app.ConfirmManager();\n        ConfirmManager.SetWaitForConfirmForm(this.OnConFirm.bind(this), msgID, cbArg);\n        ConfirmManager.ShowConfirm(type, msgID, msgArg,content,lbSure,lbCancle);\n    },\n    OnConFirm:function(clickType, msgID, backArgList){\n        if(clickType != \"Sure\"){\n            return\n        }\n        if(msgID == \"SURE_PROMOTER_SET\"){\n            let self = this;\n            if(this.node.getChildByName(\"ToggleContainer\").getChildByName(\"toggle1\").getComponent(cc.Toggle).isChecked==true){\n                this.type=0;\n            }else{\n                this.type=1;\n            }\n            if(this.type==0){\n                app.NetManager().SendPack(\"club.CClubChangePromotionBelong\",{\"clubId\":this.clubId,\"pid\":this.pid,\"upLevelId\":0,\"type\":0}, function(serverPack){\n                    app.SysNotifyManager().ShowSysMsg(\"修改成功\");\n                    self.CloseForm();\n                }, function(){\n                    //app.SysNotifyManager().ShowSysMsg(\"从属修改失败\");\n                });\n            }else{\n                if(this.searchPid==0){\n                    app.SysNotifyManager().ShowSysMsg(\"请搜索归属玩家\");\n                    return;\n                }\n                app.NetManager().SendPack(\"club.CClubChangePromotionBelong\",{\"clubId\":this.clubId,\"pid\":this.pid,\"upLevelId\":this.searchPid,\"type\":1}, function(serverPack){\n                    app.SysNotifyManager().ShowSysMsg(\"修改成功\");\n                    self.CloseForm();\n                }, function(){\n                    //app.SysNotifyManager().ShowSysMsg(\"从属修改失败\");\n                });\n            }\n        }\n    },\n});\n"]}