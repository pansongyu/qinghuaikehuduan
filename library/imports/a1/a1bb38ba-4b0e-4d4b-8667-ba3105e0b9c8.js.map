{"version":3,"sources":["..\\..\\..\\..\\assets\\script/assets\\script\\ClientManager.js"],"names":["app","require","SubgameManager","cc","Class","extends","properties","globalEffect","Node","reConnectTip","OnLoad","console","log","JS_Name","logSecond","allGameIdFormServer","isWriteLog","sys","isNative","game","addPersistRootNode","node","StartTimer","systemEvent","on","SystemEvent","EventType","KEY_DOWN","OnKeyDown","ShareDefineModel","GetModel","ShareDefine","HootManagerModel","HootManager","LogManagerModel","LogManager","ComToolModel","ComTool","ControlManagerModel","ControlManager","Init","localStorage","setItem","testData","getItem","CanUse","removeItem","ErrLog","LocalDataManagerModel","LocalDataManager","NativeManagerModel","NativeManager","clientState","State_Prepare","nextTick","lastHearTime","LostHearTime","isFirstLogin","debugModel","startUpInfo","clientConfig","gameType","tryEnterGame","InitLaunchParameter","lastReConnectTime","reConnectUseTime","bStartReConnect","reConnectLable","getChildByName","getComponent","Label","RegAllEvent","version","CallToNative","gameInfo","InitDebug","isDebug","IsOpenLog","IsDevelopment","debugPrefab","debugNode","instantiate","OnCreate","error","stack","para","href","window","location","index","indexOf","substr","paraList","length","split","count","paraInfo","paraDataList","SysLog","OnPack_LuckDrawReceive","serverPack","OnEvent","OnPack_HeartBeat","Date","getTime","bBeatFlag","NetManager","SendPack","SpeedTest","bind","yanci","OnPack_RoleTest","HeroAccountManager","SetAccountProperty","RunSwitchGameAction","RunRecordAction","SceneManager","LoadScene","allSwitchGameData","switchGameData","push","JSON","parse","i","action","FormManager","ShowForm","fromName","lastClubData","ClubManager","GetLastClubData","sendPack","clubId","club_data","id","ShowClubFrom","skinType","PlayerDataManager","ClearSwitchGameData","switchRecord","GameType_GZMJ","gameTypeStr","GametTypeID2PinYin","roomId","playerAll","unionId","roomKey","page","GameType_CP","OnPack_BaseLogin","accountID","GetAccountProperty","nickName","headImageUrl","sex","isMobile","ServerTimeManager","InitLoginData","WorldInfoManager","InitConnectAccountID","HeroManager","GetHeroID","OnPack_OnHeroLogin","heroID","GetAllGameIdFromServer","argList","toString","PlayerFamilyManager","SendInitPlayerFamily","State_LoginPackFail","SysNotifyManager","ShowSysMsg","OnPack_PlayerInfo","OnEvent_InitPlayerFamily","event","GameManager","SendGetCurRoomID","SetGameType","typeStr","OnEvent_LoginGetCurRoomID","roomID","practiceId","OnStartEnterGame","that","OnEvent_ConnectSuccess","bIsReconnect","Event_CodeError","code","msg","cityId","parseInt","selectCityConfig","SysDataManager","GetTableDict","cityInfo","SetWaitForConfirm","Confirm","Name","OnCheckMicPermission","dataDict","errStr","switchGameDataStr","nameAndStatus","name","status","StartEnterGame","CloseForm","OnPack_GetGameStatus","isPlayingGame","sceneType","GetSceneType","eventName","State_Logined","OnPack_Kickout","kickOutType","LogOutGame","OnPack_Online","onlineHour","OnFirstEnterMainScene","update","dt","OnTimer","passSecond","OutPutLog","State_WaitLogin","NetWork","isConnectIng","active","CloseReConnectTip","curTime","Disconnect","StartReConnect","ReConnectByTipSureBtn","string","OnEventHide","curRunGame","StopTimer","UpdateHearTime","schedule","unschedule","OnEventShow","isNeedReconnectVpn","scheduleOnce","OnInitClientData","clientPath","appVersion","State_InitSuccess","ShareDefineGame","allGames","GametTypeNameDict","GametTypeID2Name","key","toUpperCase","Id","Name_1","OnInitClientFinish","allTableDataDict","gametype","Data","json","RefreshClientConfig","debug","CheckDebugSign","InitModel","InitTable","InitManager","dump","browserType","os","e","LoadLogin","ClientLoginProcess","WeChatManager","SendRequestWeChatSDKIntSign","dbGameServerInfo","GetConfigProperty","dbAccountServerInfo","dbOrderServerInfo","dbResServerInfo","gameServerIP","gameServerPort","accountServerIP","accountServerPort","orderServerIP","orderServerPort","resServerIP","resServerPort","accountType","orderType","AccountSDKTypeNameDict","hasOwnProperty","SDKType_Company","OrderSDKTypeNameDict","OrderType_Company","ddmchannel","ddmmp","SDKType_WeChat","OrderType_Wechat","modelName","NeedCreateList","allTableNameList","Object","keys","tableName","tableInfo","OnLoadTableEnd","startUrl","origin","SetH5ClientStartUrl","RegNetPack","OnEvent_SPlayerContinue","SDKManager","InitSDKParameter","RegEvent","argDict","Log","emit","userName","shortPlayer","paymentRoomCardType","func","target","UnRegTargetEvent","off","targetOff","keyCode","macro","KEY","back","msgID","ConfirmManager","SetWaitForConfirmForm","OnConFirm","ShowConfirm","IsClientLoginOK","SetClientState","SetConfigProperty","ClearClientData","GetSceneComponent","WarnLog","OnTopEvent","OnReload","TalkingDataManager","ChatManager","FamilyManager","NoticeManager","PlayerRankManager","PlayerRoomManager","RoomRecordManager","debugSign","argKeyList","sort","keyCount","signString","keyName","join","sign","MD5","hex_md5","GetDebugModel","MultiPoint","serverIP","Client","GetClientConfigProperty","AccessPoint","AccountActive","myCityID","CityPoints","CityPointsList","GetClientConfig","mt","InArray","GetAppName","property","GetStartUpProperty","GetGlobalEffectNode","effectName","effectNode","removeFromParent","PushGlobalEffectNode","addChild","GetIsFirstLogin","SetFirstLogin","RemoveClientManager","removePersistRootNode","loadFormDict","showFormDict","createingFormDict","formWndShowInfo","defaultFormNameList","ReleaseAllRes","destroy","EnterSubGame","self","stringify","lianmai","gamtTypeID","successFunc","success","localConfig","isStart","SoundManager","StopAllSound","enterSubgame","failFunc","ChangeRoomCheckSubGame","gameName","haveEnterFunction","undefined","password","isSubgameDownLoad","needUpdateSubgame","JoinRoomCheckSubGame","existQuickJoin","mainComponent","GetFormComponentByFormName","curRoomID","curGameType","curGameTypeStr","PracticeRoomCheckSubGame","CreateRoomCheckSubGame","gaoji","VideoCheckSubGame","playBackCode","videoData","backCode","isNeedOnEvent","allSelectCityData","GetCurSelectCityData","selectId","curGameList","GetAllGameId","isGetAllGame","allGameIdFormtemp","allGameId","latelyGameType","latelyGameId","unshift","gameId","Number","onDestroy","type","msgArg","cbArg","content","lbSure","lbCancle","clickType","backArgList","end"],"mappings":"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","file":"ClientManager.js","sourceRoot":"..\\..\\..\\..\\assets\\script","sourcesContent":["/*\r\n\t客户端初始化管理类(该组件节点不会被释放)\r\n*/\r\n\r\nvar app = require(\"app\");\r\nvar SubgameManager = require('SubgameManager');\r\nrequire('hall_NativeNotify');\r\ncc.Class({\r\n\r\n\textends: require(\"BaseComponent\"),\r\n\r\n\tproperties: {\r\n\t\tglobalEffect: cc.Node,\r\n\t\treConnectTip: cc.Node,\r\n\t},\r\n\t// 加载JS主入口\r\n\tOnLoad: function () {\r\n\t\tconsole.log(\"-----大厅 ClientManager OnLoad-----\");\r\n\r\n\t\tthis.JS_Name = \"ClientManager\";\r\n\r\n\t\tthis.logSecond = 0;\r\n\t\tthis.allGameIdFormServer = [];\r\n\t\t//是否需要写log\r\n\t\tthis.isWriteLog = cc.sys.isNative;\r\n\r\n\t\t//保证客户端管理器不被释放\r\n\t\tcc.game.addPersistRootNode(this.node);\r\n\r\n\t\tthis.StartTimer();\r\n\r\n\t\tcc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.OnKeyDown, this);\r\n\r\n\t\t//把Client存放到App上\r\n\t\tapp[\"Client\"] = this;\r\n\r\n\t\t//枚举管理器\r\n\t\tlet ShareDefineModel = require(\"ShareDefine\").GetModel;\r\n\t\tapp[\"ShareDefine\"] = ShareDefineModel;\r\n\t\tthis.ShareDefine = ShareDefineModel();\r\n\r\n\t\t//HootManager模块等级最高\r\n\t\tlet HootManagerModel = require(\"HootManager\").GetModel;\r\n\t\tapp[\"HootManager\"] = HootManagerModel;\r\n\t\tthis.HootManager = HootManagerModel();\r\n\r\n\t\t//注册log模块\r\n\t\tlet LogManagerModel = require(\"LogManager\").GetModel;\r\n\t\tapp[\"LogManager\"] = LogManagerModel;\r\n\t\tthis.LogManager = LogManagerModel();\r\n\r\n\t\t//工具模块\r\n\t\tlet ComToolModel = require(\"ComTool\").GetModel;\r\n\t\tapp[\"ComTool\"] = ComToolModel;\r\n\t\tthis.ComTool = ComToolModel();\r\n\r\n\t\t//加载控制器\r\n\t\tlet ControlManagerModel = require(\"ControlManager\").GetModel;\r\n\t\tapp[\"ControlManager\"] = ControlManagerModel;\r\n\t\tthis.ControlManager = ControlManagerModel();\r\n\t\tthis.ControlManager.Init();\r\n\r\n\t\t//检测是否可以使用localStorage,有的浏览器没有\r\n\t\tvar localStorage = cc.sys.localStorage;\r\n\t\tlocalStorage.setItem(\"testStorage\", \"1\");\r\n\t\tvar testData = localStorage.getItem(\"testStorage\");\r\n\t\tif (testData) {\r\n\t\t\tcc.sys.localStorage.CanUse = 1;\r\n\t\t\tlocalStorage.removeItem(\"testStorage\");\r\n\t\t} else {\r\n\t\t\tcc.sys.localStorage.CanUse = 0;\r\n\t\t\tthis.ErrLog(\"cant use sys.localStorage\");\r\n\t\t}\r\n\r\n\t\t//本地数据管理器\r\n\t\tlet LocalDataManagerModel = require(\"LocalDataManager\").GetModel;\r\n\t\tapp[\"LocalDataManager\"] = LocalDataManagerModel;\r\n\t\tthis.LocalDataManager = LocalDataManagerModel();\r\n\r\n\t\t//js调用native平台接口管理器(启动需要获取客户端app启动携带参数)\r\n\t\tlet NativeManagerModel = require(\"NativeManager\").GetModel;\r\n\t\tapp[\"NativeManager\"] = NativeManagerModel;\r\n\t\tthis.NativeManager = NativeManagerModel();\r\n\r\n\t\t//客户端初始化\r\n\t\tthis.clientState = this.ShareDefine.State_Prepare;\r\n\r\n\t\t//定时器下次执行时间\r\n\t\tthis.nextTick = 0;\r\n\r\n\t\t//心跳\r\n\t\tthis.lastHearTime = 0;\r\n\t\tthis.LostHearTime = 0;\r\n\t\tthis.isFirstLogin = true;\r\n\t\tthis.debugModel = null;\r\n\t\t//启动携带参数\r\n\t\tthis.startUpInfo = {};\r\n\r\n\t\t//客户端配置字典\r\n\t\tthis.clientConfig = {};\r\n\r\n\t\tthis.gameType = -1;\r\n\t\t//检测是否正在进游戏，2秒检测一次，防止用户重复点击导致检测更新失败\r\n\t\tthis.tryEnterGame = false;\r\n\r\n\t\tthis.InitLaunchParameter();\r\n\r\n\t\t//this.loadapkpro = 0.0f;\r\n\t\t//重连计时\r\n\t\tthis.lastReConnectTime = 0;\r\n\t\tthis.reConnectUseTime = 0;\r\n\t\tthis.bStartReConnect = false;\r\n\t\tthis.reConnectLable = this.reConnectTip.getChildByName('sp_info').getChildByName('lb_info').getComponent(cc.Label);\r\n\t\tthis.RegAllEvent();\r\n\t\tlet version = cc.sys.localStorage.getItem('version');\r\n\t\tif (version == null || typeof (version) == \"undefined\") {\r\n\t\t\tversion = app.NativeManager().CallToNative(\"getVersion\", [], \"String\");\r\n\t\t\tcc.sys.localStorage.setItem('version', version);\r\n\t\t}\r\n\t\tif (version) {\r\n\t\t\tapp[\"version\"] = version;\r\n\t\t}\r\n\r\n\t\tthis.gameInfo = {}\r\n\t},\r\n\r\n\t//debug初始化\r\n\tInitDebug: function (isDebug) {\r\n\r\n\t\tif (isDebug) {\r\n\t\t\tthis.LogManager.IsOpenLog(true);\r\n\t\t\tthis.ShareDefine.IsDevelopment = 1;\r\n\t\t\ttry {\r\n\t\t\t\tif (this.debugPrefab && !this.debugModel) {\r\n\t\t\t\t\tlet debugNode = cc.instantiate(this.debugPrefab);\r\n\t\t\t\t\tthis.debugModel = debugNode.getComponent(\"DebugLayer\");\r\n\t\t\t\t\tthis.debugModel.OnCreate()\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tthis.ErrLog(\"create debug error:%s\", error.stack);\r\n\t\t\t\tthis.debugModel = null;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.LogManager.IsOpenLog(false);\r\n\t\t\tthis.ShareDefine.IsDevelopment = 0;\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t//启动参数\r\n\tInitLaunchParameter: function () {\r\n\t\tlet para = \"\";\r\n\r\n\t\t//如果是native版本获取应用启动携带参数\r\n\t\tif (cc.sys.isNative) {\r\n\t\t\tpara = app.NativeManager().CallToNative(\"GetQuery\", [], \"String\");\r\n\t\t\tif (!para) {\r\n\t\t\t\tpara = \"\";\r\n\t\t\t}\r\n\t\t}\r\n\t\t//如果是H5版本\r\n\t\telse {\r\n\t\t\t//浏览器信息\r\n\t\t\t//let navigator = window.navigator;\r\n\t\t\t//let userAgent = navigator.userAgent;\r\n\t\t\tlet href = window.location.href;\r\n\t\t\tlet index = href.indexOf(\"?\");\r\n\t\t\tif (index > -1) {\r\n\t\t\t\t//\"?ddmchannel=dangle&ddmgameid=p1&appId=50059&cpToken=6aacddfec66b4ba2a1728b235d2c5716\"\r\n\t\t\t\tpara = href.substr(index + 1);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet paraList = [];\r\n\t\tif (para.length) {\r\n\t\t\tparaList = para.split(\"&\");\r\n\t\t}\r\n\t\tlet count = paraList.length;\r\n\r\n\t\tfor (let index = 0; index < count; index++) {\r\n\t\t\tlet paraInfo = paraList[index];\r\n\t\t\tlet paraDataList = paraInfo.split(\"=\");\r\n\t\t\tif (paraDataList.length != 2) {\r\n\t\t\t\tthis.ErrLog(\"InitLaunchParameter paraInfo:%s error\", paraInfo);\r\n\t\t\t\tcontinue\r\n\t\t\t}\r\n\t\t\tthis.startUpInfo[paraDataList[0]] = paraDataList[1];\r\n\t\t}\r\n\r\n\t\tthis.SysLog(\"InitLaunchParameter:\", this.startUpInfo)\r\n\t},\r\n\r\n\t//-----------------封包函数-------------------------\r\n\tOnPack_LuckDrawReceive: function (serverPack) {\r\n\t\tthis.OnEvent(\"OnChouJiangLingQu\", serverPack);\r\n\t},\r\n\t//心跳包\r\n\tOnPack_HeartBeat: function (serverPack) {\r\n\t\tthis.lastHearTime = new Date().getTime();\r\n\t\tthis.LostHearTime = new Date().getTime();\r\n\t\tconsole.log(\"OnPack_HeartBeat:\" + this.lastHearTime);\r\n\t\tif (serverPack.bBeatFlag) {\r\n\t\t\tapp.NetManager().SendPack(\"heartBeat.CHeartBeatHandler\", {\r\n\t\t\t\t\"strBeatMessage\": \"\",\r\n\t\t\t\t\"lBeatTime\": this.lastHearTime,\r\n\t\t\t\t\"bBeatFlag\": true\r\n\t\t\t}, this.SpeedTest.bind(this), this.SpeedTest.bind(this));\r\n\t\t}\r\n\t},\r\n\t//网速检测\r\n\tSpeedTest: function (serverPack) {\r\n\t\tlet yanci = new Date().getTime() - this.lastHearTime;\r\n\t\tthis.OnEvent(\"EvtSpeedTest\", { \"yanci\": yanci });\r\n\t},\r\n\t//从子游戏切换回大厅，重新登录\r\n\tOnPack_RoleTest: function (serverPack) {\r\n\t\tconsole.log(\"发送重新登录请求...\");\r\n\t\tapp.HeroAccountManager().SetAccountProperty(\"reloginSign\", serverPack[\"sign\"]);\r\n\t\tapp.NetManager().SendPack(\"base.C1006RoleLogin\", { \"accountID\": serverPack[\"accountID\"] });\r\n\t\tthis.RunSwitchGameAction();\r\n\t\tthis.RunRecordAction();\r\n\t\tapp.SceneManager().LoadScene(\"mainScene\");\r\n\t},\r\n\tRunSwitchGameAction: function () {\r\n\t\tconsole.log(\"RunSwitchGameAction 111\");\r\n\t\t//返回大厅检测下是否有需要处理的数据\r\n\t\t// let allSwitchGameData = app.PlayerDataManager().GetSwitchGameData();\r\n\t\tlet allSwitchGameData = [];\r\n\t\tlet switchGameData = cc.sys.localStorage.getItem(\"switchGameData\");\r\n\t\tif (switchGameData != \"\") {\r\n\t\t\tallSwitchGameData.push(JSON.parse(switchGameData));\r\n\t\t}\r\n\t\tfor (let i = 0; i < allSwitchGameData.length; i++) {\r\n\t\t\tif (!allSwitchGameData[i]) return;\r\n\t\t\tlet action = allSwitchGameData[i].action;\r\n\t\t\tswitch (action) {\r\n\t\t\t\tcase 'showForm':\r\n\t\t\t\t\tapp.FormManager().ShowForm(allSwitchGameData[i].fromName);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'openClub':\r\n\t\t\t\t\t// app.FormManager().AddDefaultFormName(\"ui/club/UIClubMain\");\r\n\t\t\t\t\tlet lastClubData = app.ClubManager().GetLastClubData();\r\n\t\t\t\t\tif (lastClubData != null) {\r\n\t\t\t\t\t\tlet sendPack = {};\r\n\t\t\t\t\t\tsendPack.clubId = lastClubData.club_data.id;\r\n\t\t\t\t\t\tapp.NetManager().SendPack(\"union.CUnionGetSkinInfo\", sendPack, function (serverPack) {\r\n\t\t\t\t\t\t\t// app.ClubManager().AddDefaultClubFrom(serverPack.skinType);\r\n\t\t\t\t\t\t\tapp.ClubManager().ShowClubFrom(serverPack.skinType);\r\n\t\t\t\t\t\t}, function () {\r\n\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tconsole.log('未知动作: ' + action);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tapp.PlayerDataManager().ClearSwitchGameData();\r\n\t\tcc.sys.localStorage.setItem(\"switchGameData\", \"\");\r\n\t},\r\n\tRunRecordAction: function () {\r\n\t\tlet allSwitchGameData = [];\r\n\t\tlet switchRecord = cc.sys.localStorage.getItem(\"switchRecord\");\r\n\t\tif (switchRecord != \"\") {\r\n\t\t\tallSwitchGameData.push(JSON.parse(switchRecord));\r\n\t\t}\r\n\t\tfor (let i = 0; i < allSwitchGameData.length; i++) {\r\n\t\t\tif (!allSwitchGameData[i]) return;\r\n\t\t\tlet action = allSwitchGameData[i].action;\r\n\t\t\tswitch (action) {\r\n\t\t\t\tcase 'OpenUIRecordAllResult':\r\n\t\t\t\t\tlet gameType = allSwitchGameData[i].gameType;\r\n\t\t\t\t\tif (gameType == this.ShareDefine.GameType_GZMJ) {\r\n\t\t\t\t\t\tlet gameTypeStr = this.ShareDefine.GametTypeID2PinYin[gameType];\r\n\t\t\t\t\t\tapp.FormManager().ShowForm(\"UIRecordAllResult_\" + gameTypeStr, allSwitchGameData[i].roomId, allSwitchGameData[i].playerAll, allSwitchGameData[i].gameType, allSwitchGameData[i].unionId, allSwitchGameData[i].roomKey, allSwitchGameData[i].page);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (gameType == this.ShareDefine.GameType_CP) {\r\n\t\t\t\t\t\tlet gameTypeStr = this.ShareDefine.GametTypeID2PinYin[gameType];\r\n\t\t\t\t\t\tapp.FormManager().ShowForm(\"ui/uiGame/cp/UIRecordAllResult_cp\", allSwitchGameData[i].roomId, allSwitchGameData[i].playerAll, allSwitchGameData[i].gameType, allSwitchGameData[i].unionId, allSwitchGameData[i].roomKey, allSwitchGameData[i].page);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tapp.FormManager().ShowForm(\"UIRecordAllResult\", allSwitchGameData[i].roomId, allSwitchGameData[i].playerAll, allSwitchGameData[i].gameType, allSwitchGameData[i].unionId, allSwitchGameData[i].roomKey, allSwitchGameData[i].page);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tconsole.log('未知动作: ' + action);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tcc.sys.localStorage.setItem(\"switchRecord\", \"\");\r\n\t},\r\n\t//1:账号登录成功\r\n\tOnPack_BaseLogin: function (serverPack) {\r\n\t\tconsole.log(\"账号登录成功\");\r\n\t\tlet HeroAccountManager = app.HeroAccountManager();\r\n\t\tlet accountID = HeroAccountManager.GetAccountProperty(\"AccountID\");\r\n\t\tlet nickName = HeroAccountManager.GetAccountProperty(\"NickName\");\r\n\t\tlet headImageUrl = HeroAccountManager.GetAccountProperty(\"HeadImageUrl\");\r\n\t\tlet sex = HeroAccountManager.GetAccountProperty(\"Sex\");\r\n\t\tlet isMobile = HeroAccountManager.GetAccountProperty(\"isMobile\");\r\n\r\n\t\tapp.ServerTimeManager().InitLoginData(serverPack);\r\n\t\tapp.WorldInfoManager().InitLoginData(serverPack);\r\n\r\n\t\tlet NetManager = app.NetManager();\r\n\r\n\t\t//连接已经建立,初始化连接的玩家账号ID\r\n\t\tNetManager.InitConnectAccountID(accountID);\r\n\t\t//如果客户端已经有玩家数据了,为重连回包,不需要发送登录封包,只需要同步一次玩家属性,因为有可能变化了属性\r\n\t\tif (app.HeroManager().GetHeroID()) {\r\n\t\t\tconsole.log(\"玩家数据已经存在\");\r\n\t\t\tthis.SysLog(\"OnPack_BaseLogin have find heroID not send login\");\r\n\t\t\tNetManager.SendPack(\"base.C1005PlayerInfo\", {});\r\n\t\t} else {\r\n\t\t\tif (serverPack[\"isNeedCreateRole\"]) {\r\n\t\t\t\tconsole.log(\"创建新角色\");\r\n\t\t\t\tNetManager.SendPack(\"base.C1001CreateRole\", {\r\n\t\t\t\t\t\"nickName\": nickName,\r\n\t\t\t\t\t\"sex\": sex,\r\n\t\t\t\t\t\"headImageUrl\": headImageUrl,\r\n\t\t\t\t\t\"accountID\": accountID,\r\n\t\t\t\t\t\"isMobile\": isMobile,\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tconsole.log(\"登录已有账号\");\r\n\t\t\t\tNetManager.SendPack(\"base.C1006RoleLogin\", { \"accountID\": accountID });\r\n\t\t\t}\r\n\t\t}\r\n\t\t//获取游戏列表\r\n\t\t// this.GetAllGameIdFromServer();\r\n\t},\r\n\r\n\t//2:玩家登陆初始化\r\n\tOnPack_OnHeroLogin: function (serverPack) {\r\n\r\n\t\ttry {\r\n\t\t\tlet heroID = serverPack[\"pid\"];\r\n\t\t\tthis.gameType = serverPack[\"currentGameType\"];\r\n\t\t\tapp.HeroAccountManager().SetAccountProperty(\"reloginSign\", serverPack[\"sign\"]);\r\n\t\t\tapp.HeroManager().InitLoginData(heroID, serverPack);\r\n\t\t\tthis.GetAllGameIdFromServer();\r\n\t\t\t//初始化实时语音\r\n\t\t\tconsole.log(\"初始化实时语音\");\r\n\t\t\tlet argList = [{ \"Name\": \"pid\", \"Value\": heroID.toString() }];\r\n\t\t\tapp.NativeManager().CallToNative(\"OnGVInit\", argList);\r\n\t\t\t//请求玩家工会数据\r\n\t\t\tapp.PlayerFamilyManager().SendInitPlayerFamily();\r\n\t\t} catch (error) {\r\n\t\t\tthis.ErrLog(\"OnPack_OnHeroLogin(%s):%s\", serverPack, error.stack);\r\n\t\t\tthis.clientState = this.ShareDefine.State_LoginPackFail;\r\n\t\t\tapp.SysNotifyManager().ShowSysMsg(\"Code_Login_PackFail\");\r\n\t\t}\r\n\t},\r\n\r\n\tOnPack_PlayerInfo: function (serverPack) {\r\n\t\ttry {\r\n\t\t\tlet heroID = serverPack[\"pid\"];\r\n\t\t\tapp.HeroAccountManager().SetAccountProperty(\"reloginSign\", serverPack[\"sign\"]);\r\n\t\t\tapp.HeroManager().InitLoginData(heroID, serverPack);\r\n\t\t\tthis.GetAllGameIdFromServer();\r\n\t\t} catch (error) {\r\n\t\t\tthis.ErrLog(\"OnPack_PlayerInfo(%s):%s\", serverPack, error.stack);\r\n\t\t}\r\n\t},\r\n\r\n\t//3:请求玩家工会数据\r\n\tOnEvent_InitPlayerFamily: function (event) {\r\n\t\t//请求玩家进入的房间ID\r\n\t\tapp.GameManager().SendGetCurRoomID();\r\n\t},\r\n\tSetGameType: function (typeStr) {\r\n\t\tif ('hzmj' == typeStr)\r\n\t\t\tthis.gameType = 0;\r\n\t\telse if ('sss' == typeStr)\r\n\t\t\tthis.gameType = 1;\r\n\t\telse if ('lymj' == typeStr)\r\n\t\t\tthis.gameType = 2;\r\n\t\telse if ('xmmj' == typeStr)\r\n\t\t\tthis.gameType = 3;\r\n\t\telse if ('nn' == typeStr)\r\n\t\t\tthis.gameType = 4;\r\n\t\telse if ('fzmj' == typeStr)\r\n\t\t\tthis.gameType = 5;\r\n\t\telse if ('qzmj' == typeStr)\r\n\t\t\tthis.gameType = 6;\r\n\t\telse if ('pdk' == typeStr)\r\n\t\t\tthis.gameType = 7;\r\n\t\telse if ('zzmj' == typeStr)\r\n\t\t\tthis.gameType = 8;\r\n\t\telse if ('zjh' == typeStr)\r\n\t\t\tthis.gameType = 9;\r\n\t\telse if ('ptmj' == typeStr)\r\n\t\t\tthis.gameType = 10;\r\n\t\telse if ('ndmj' == typeStr)\r\n\t\t\tthis.gameType = 11;\r\n\t\telse if ('smmj' == typeStr)\r\n\t\t\tthis.gameType = 12;\r\n\t\telse if ('npmj' == typeStr)\r\n\t\t\tthis.gameType = 13;\r\n\t\telse if ('npgzmj' == typeStr)\r\n\t\t\tthis.gameType = 21;\r\n\t\telse if ('xymj' == typeStr)\r\n\t\t\tthis.gameType = 14;\r\n\t\telse if ('ssmj' == typeStr)\r\n\t\t\tthis.gameType = 15;\r\n\t\telse if ('namj' == typeStr)\r\n\t\t\tthis.gameType = 16;\r\n\t\telse if ('pt13mj' == typeStr)\r\n\t\t\tthis.gameType = 17;\r\n\t\telse if ('sg' == typeStr)\r\n\t\t\tthis.gameType = 18;\r\n\t\telse if ('zjjhmj' == typeStr)\r\n\t\t\tthis.gameType = 22;\r\n\t\telse if ('hbyxmj' == typeStr)\r\n\t\t\tthis.gameType = 23;\r\n\t\telse if ('xyzb' == typeStr)\r\n\t\t\tthis.gameType = 33;\r\n\t\telse if ('wsk' == typeStr)\r\n\t\t\tthis.gameType = 41;\r\n\t\telse if ('pxcn' == typeStr)\r\n\t\t\tthis.gameType = 34;\r\n\t\telse if ('zjmj' == typeStr)\r\n\t\t\tthis.gameType = 35;\r\n\t\telse if ('wzmj' == typeStr)\r\n\t\t\tthis.gameType = 40;\r\n\t\telse if ('ycmj' == typeStr)\r\n\t\t\tthis.gameType = 42;\r\n\t\telse if ('ddz' == typeStr)\r\n\t\t\tthis.gameType = 30;\r\n\t\telse if ('gdy' == typeStr)\r\n\t\t\tthis.gameType = 26;\r\n\t\telse\r\n\t\t\tthis.gameType = -1;\r\n\t},\r\n\t//4:登录获取玩家当前参与的房间ID\r\n\tOnEvent_LoginGetCurRoomID: function (event) {\r\n\t\tlet serverPack = event;\r\n\t\tlet roomID = serverPack.roomID;\r\n\t\tconsole.log(\"登录获取玩家当前参与的房间ID:\" + roomID);\r\n\t\tif ('practiceId' in serverPack)\r\n\t\t\tapp.ShareDefine().practiceId = serverPack.practiceId;\r\n\t\tif (roomID == 0) {\r\n\t\t\t//如果启动参数传递房间号，则尝试进入房间\r\n\t\t\tif (this.startUpInfo['room_id']) {\r\n\t\t\t\tlet roomKey = this.startUpInfo['room_id'];\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.OnStartEnterGame(\"enterMain\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet that = this;\r\n\t\tthis.OnStartEnterGame(\"enterMain\");\r\n\t},\r\n\tOnEvent_ConnectSuccess: function (event) {\r\n\t\tlet serverPack = event;\r\n\t\tlet bIsReconnect = serverPack['IsReconnecting'];\r\n\t\tif (bIsReconnect) {\r\n\t\t\tapp.NetManager().SendPack(\"game.CGetGameStatus\", {});\r\n\t\t}\r\n\t},\r\n\tEvent_CodeError: function (event) {\r\n\t\tlet code = event[\"Code\"];\r\n\t\tlet msg = event[\"Result\"][\"Msg\"];\r\n\t\tif (code == 5021) {\r\n\t\t\tlet cityId = parseInt(msg);\r\n\t\t\tlet selectCityConfig = app.SysDataManager().GetTableDict(\"selectCity\");\r\n\t\t\tlet cityInfo = selectCityConfig[cityId];\r\n\t\t\tif (cityInfo) {\r\n\t\t\t\tthis.SetWaitForConfirm('RESELECT_CITY', this.ShareDefine.Confirm, [], [cityId], \"该游戏是在[\" + cityInfo.Name + \"]，是否切换到该城市后再加入房间\");\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tOnCheckMicPermission: function (dataDict) {\r\n\t\tlet errStr = dataDict[\"ErrStr\"];\r\n\t\tlet switchGameDataStr = dataDict[\"Data\"];\r\n\t\tlet nameAndStatus = errStr.split(',');\r\n\t\tlet name = nameAndStatus[0];\r\n\t\tlet status = nameAndStatus[1];\r\n\t\tconsole.log(\"status === \" + status);\r\n\t\tif (status == \"open\") {\r\n\t\t\tlet switchGameData = null;\r\n\t\t\tif (switchGameDataStr != \"\") {\r\n\t\t\t\tswitchGameData = JSON.parse(switchGameDataStr)\r\n\t\t\t}\r\n\t\t\tif (name != \"\" && name != \"createRoom\") {\r\n\t\t\t\tthis.StartEnterGame(name, switchGameData);\r\n\t\t\t}\r\n\t\t\tif (name == \"createRoom\") {\r\n\t\t\t\tconsole.log(\"------------OnMicPermissionOpen-----------\");\r\n\t\t\t\tthis.OnEvent(\"OnMicPermissionOpen\", {});\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tapp.FormManager().CloseForm('UIDownLoadGame');\r\n\t\t\tthis.SetWaitForConfirm('MSG_CLOSE_MICPERMISSION', this.ShareDefine.Confirm, [], [], \"您未开启语音权限，请前往打开\");\r\n\t\t}\r\n\t},\r\n\t//断线重连状态同步\r\n\tOnPack_GetGameStatus: function (serverPack) {\r\n\t\tlet isPlayingGame = serverPack['isPlayingGame'];\r\n\t\tthis.gameType = serverPack['gameType'];\r\n\t\tlet roomID = serverPack['roomID'];\r\n\t\tif (isPlayingGame) {//游戏中\r\n\t\t\tlet event = {};\r\n\t\t\tevent = {};\r\n\t\t\tevent.roomID = roomID;\r\n\t\t\tthis.OnEvent_LoginGetCurRoomID(event);\r\n\t\t} else {//跳转大厅\r\n\t\t\tlet SceneManager = app.SceneManager();\r\n\t\t\tlet sceneType = SceneManager.GetSceneType();\r\n\t\t\t//如果已经在登录场景则不切换\r\n\t\t\tif ('mainScene' != sceneType)\r\n\t\t\t\tapp.SceneManager().LoadScene(\"mainScene\");\r\n\t\t}\r\n\t},\r\n\t//开始进入游戏\r\n\tOnStartEnterGame: function (eventName) {\r\n\t\tthis.clientState = this.ShareDefine.State_Logined;\r\n\r\n\t\tif (eventName == \"enterMain\") {\r\n\t\t\t//进入主场景\r\n\t\t\tconsole.log(\"进入主场景\");\r\n\t\t\tif (app.SceneManager().GetSceneType() != \"mainScene\") {\r\n\t\t\t\tapp.SceneManager().LoadScene(\"mainScene\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.OnEvent(\"PlayerLoginOK\", {});\r\n\t},\r\n\r\n\t//被ti\r\n\tOnPack_Kickout: function (serverPack) {\r\n\t\tlet kickOutType = serverPack[\"type\"];\r\n\r\n\t\tif (kickOutType == 2) {\r\n\t\t\tthis.LogOutGame(-1);\r\n\t\t} else {\r\n\t\t\tthis.ErrLog(\"OnPack_Kickout kickOutType:%s not find\", kickOutType);\r\n\t\t}\r\n\t},\r\n\r\n\t//提醒玩家在线时长\r\n\tOnPack_Online: function (serverPack) {\r\n\t\tapp.SysNotifyManager().ShowSysMsg(\"MSG_TIME_ONLINE\", [serverPack.onlineHour]);\r\n\t},\r\n\r\n\t//-----------------回调函数-------------------------\r\n\r\n\t//首次进入主场景回调\r\n\tOnFirstEnterMainScene: function () {\r\n\t},\r\n\r\n\t//native平台回调(已经弃用，单独写了一个脚本hall_NativeNotify)\r\n\t// OnNativeNotify:function(eventType, eventDataString){\r\n\t//        try {\r\n\t//        \tthis.ErrLog(\"OnNativeNotify eventType:%s, eventDataString:%s\",eventType, eventDataString);\r\n\t//            let dataDict = JSON.parse(eventDataString);\r\n\t//            if (eventType == \"wechat\") { //微信登录\r\n\t//             app.WeChatAppManager().OnNativeNotifyWXLogin(dataDict);\r\n\t//            }else if (eventType == \"wechatShare\") {  //微信分享\r\n\t//                app.WeChatAppManager().OnNativeNotifyWXShare(dataDict);\r\n\t//            }else if (eventType == \"wechatPay\") { //微信支付\r\n\t//                app.WeChatAppManager().OnNativeNotifyWXPay(dataDict);\r\n\t//            }else if (eventType == \"onBatteryLevel\") { //电量回掉\r\n\t//                this.OnEvent(\"EvtBatteryLevel\",{\"Level\": dataDict[\"Level\"], \"status\":dataDict[\"status\"]});\r\n\t//            }else if (eventType == \"apkProess\") { //下载apk进度\r\n\t//                this.OnEvent(\"LoadApkProess\", {\"progress\": dataDict[\"proess\"]});\r\n\t//            }else if (eventType == \"download\") { //下载\r\n\t//            \tapp.DownLoadMgr().OnDownLoadEvent(dataDict);\r\n\t//            }else if (eventType == \"palyAudioFinsh\") { //播放完成\r\n\t//            \tthis.OnEvent(\"palyAudioFinsh\", {});\r\n\t//            }else if (eventType == \"AudioError\") {//录音失败\r\n\t//            \tthis.OnEvent(\"AudioError\", {});\r\n\t// \t\t}else if (eventType == \"AudioStopError\") {//录音失败\r\n\t//            \tthis.OnEvent(\"AudioStopError\", {});\r\n\t//            }else if (eventType == \"MedioRecordError\") {//播放失败\r\n\t//            \tthis.OnEvent(\"MedioRecordError\", {});\r\n\t//            }else if (eventType == \"wellPrepared\") {//准备录音\r\n\t//            \tthis.OnEvent(\"wellPrepared\", {});\r\n\t//            }else if (eventType == \"RecordAudioFinsh\") { //录音完成\r\n\t//            \tthis.OnEvent(\"RECORDAUDIOFINSH\", {});\r\n\t//            }else if (eventType == \"GETLOCATION\") { //获取定位\r\n\t//            \tapp.LocationOnStartMgr().OnGetLocationCallBack(dataDict);\r\n\t//            }else if (eventType == \"copyText\") { //获取定位\r\n\t//            \tthis.OnEvent(\"OnCopyTextNtf\", dataDict);\r\n\t//            }else if (eventType == \"DDShare\") {\r\n\t//            \tthis.OnEvent(\"OnDDShare\", dataDict);\r\n\t//            }else if (eventType == \"XLShare\") {\r\n\t//            \tthis.OnEvent(\"OnXLShare\", dataDict);\r\n\t//            }else{\r\n\t//             this.ErrLog(\"OnNativeNotify not find eventType:%s\", eventType);\r\n\t//            }\r\n\t//        }\r\n\t//        catch(error) {\r\n\t//            if(eventType=='wechatShare'){\r\n\t//        \t\t//还是给分享成功回调\r\n\t//            \tapp.WeChatAppManager().OnNativeNotifyWXShare({\"ErrCode\":0});\r\n\t//        \t}else{\r\n\t//            \tthis.ErrLog(\"OnNativeNotify(%s,%s) error(%s), error.stack:%s\", eventType, eventDataString, error, error.stack);\r\n\t//        \t}\r\n\t//        }\r\n\t// },\r\n\r\n\r\n\t// 每帧回掉\r\n\tupdate: function (dt) {\r\n\r\n\t\t//if(this.clientState < this.ShareDefine.State_WaitLogin){\r\n\t\t//\treturn\r\n\t\t//}\r\n\t\t//\r\n\t\t//let nowTick = new Date().getTime();\r\n\t\t//\r\n\t\t//if(nowTick >= this.nextTick){\r\n\t\t//\tthis.nextTick = nowTick + 1000;\r\n\t\t//}\r\n\t},\r\n\r\n\t//100毫秒回掉\r\n\tOnTimer: function (passSecond) {\r\n\t\ttry {\r\n\t\t\tif (this.isWriteLog) {\r\n\t\t\t\tthis.logSecond += passSecond;\r\n\t\t\t\t//500毫秒输出一次log\r\n\t\t\t\tif (this.logSecond >= 0.5) {\r\n\t\t\t\t\tthis.LogManager.OutPutLog();\r\n\t\t\t\t\tthis.logSecond = 0\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (this.clientState < this.ShareDefine.State_WaitLogin) {\r\n\t\t\t\tconsole.log(\"当前游戏在 clientState:State_WaitLogin\");\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\t//判断下服务器是否连上，如果连上关闭tip\r\n\t\t\tif (app.NetWork().isConnectIng && this.reConnectTip.active) {\r\n\t\t\t\tthis.CloseReConnectTip();\r\n\t\t\t}\r\n\t\t\tapp.SceneManager().OnTimer(passSecond);\r\n\r\n\t\t\t//完整登录才能调用\r\n\t\t\tif (this.clientState == this.ShareDefine.State_Logined) {\r\n\t\t\t\tlet curTime = new Date().getTime();\r\n\r\n\t\t\t\tif (this.lastHearTime && curTime > this.lastHearTime + 23000) {\r\n\t\t\t\t\tthis.ErrLog('NetWork Disconnect By Heart');\r\n\t\t\t\t\tthis.lastHearTime = 0;\r\n\t\t\t\t\tif (app.NetWork().isConnectIng)//ios的可能websoket不会主动断开\r\n\t\t\t\t\t\tapp.NetManager().Disconnect();\r\n\r\n\t\t\t\t\tif (!this.bStartReConnect) {\r\n\t\t\t\t\t\tthis.StartReConnect();\r\n\t\t\t\t\t\tapp.NetWork().ReConnectByTipSureBtn();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (this.bStartReConnect) {\r\n\t\t\t\t\tif (this.lastReConnectTime && curTime > this.lastReConnectTime + 1000) {\r\n\t\t\t\t\t\tthis.lastReConnectTime = curTime;\r\n\t\t\t\t\t\tthis.reConnectUseTime++;\r\n\t\t\t\t\t\tthis.reConnectLable.string = '连接失败,重新加载中(' + this.reConnectUseTime + '秒)' + '...';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tthis.ErrLog(\"OnTimer:%s\", error.stack);\r\n\t\t}\r\n\t},\r\n\r\n\tOnEventHide: function () {\r\n\t\tlet curRunGame = cc.sys.localStorage.getItem(\"curRunGame\");\r\n\t\tif (curRunGame != \"hall\") {\r\n\t\t\tconsole.log(\"当前游戏在 \" + curRunGame + \",无需监听OnEventShow事件\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.StopTimer();\r\n\t\tif (this.clientState < this.ShareDefine.State_WaitLogin) {\r\n\t\t\tconsole.log(\"当前游戏在 clientState:State_WaitLogin\");\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tapp.SceneManager().OnEventHide();\r\n\t\t} catch (error) {\r\n\t\t\tthis.ErrLog(\"OnEventHide error:%s\", error.stack);\r\n\t\t}\r\n\t},\r\n\r\n\tUpdateHearTime: function () {\r\n\t\tthis.lastHearTime = new Date().getTime();\r\n\t},\r\n\tStartTimer: function () {\r\n\t\tthis.schedule(this.OnTimer, 1);\r\n\t},\r\n\tStopTimer: function () {\r\n\t\tthis.unschedule(this.OnTimer);\r\n\t},\r\n\tOnEventShow: function (isNeedReconnectVpn = false) {\r\n\t\tconsole.log(\"OnEventShow\");\r\n\t\tlet curRunGame = cc.sys.localStorage.getItem(\"curRunGame\");\r\n\t\tif (curRunGame != \"hall\") {\r\n\t\t\tconsole.log(\"当前游戏在 \" + curRunGame + \",无需监听OnEventShow事件\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.StopTimer();\r\n\t\t// console.log(\"后台切回来大厅 1\");\r\n\t\tif (this.clientState < this.ShareDefine.State_WaitLogin) {\r\n\t\t\tconsole.log(\"OnEventShow 当前游戏在 clientState:State_WaitLogin\");\r\n\t\t\treturn\r\n\t\t}\r\n\t\t//如果在登录场景，不重连，避免授权登录失败\r\n\t\tif (app.SceneManager().GetSceneType() == \"loginScene\") {\r\n\t\t\tconsole.log(\"OnEventShow loginScene\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t// console.log(\"后台切回来大厅 2\");\r\n\t\ttry {\r\n\t\t\tlet curTime = new Date().getTime();\r\n\t\t\tconsole.log(\"LostHearTime == \" + this.LostHearTime + \",curTime == \" + curTime);\r\n\t\t\tif (isNeedReconnectVpn || (this.LostHearTime && curTime > this.LostHearTime + 15000)) {\r\n\t\t\t\tthis.lastHearTime = 0;\r\n\t\t\t\t// console.log(\"后台切回来大厅 3\");\r\n\t\t\t\tif (app.NetWork().isConnectIng) {//ios的可能websoket不会主动断开\r\n\t\t\t\t\tconsole.log(\"后台切回来，先断开连接\");\r\n\t\t\t\t\tapp.NetManager().Disconnect();\r\n\t\t\t\t}\r\n\t\t\t\tif (!this.bStartReConnect) {\r\n\t\t\t\t\tconsole.log(\"后台切回来，发起断线重连\");\r\n\t\t\t\t\tthis.StartReConnect();\r\n\t\t\t\t\tapp.NetWork().ReConnectByTipSureBtn();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tapp.SceneManager().OnEventShow(this.bStartReConnect);\r\n\t\t\tthis.scheduleOnce(function () {\r\n\t\t\t\tthis.StartTimer();\r\n\t\t\t}, 2);\r\n\t\t\t// console.log(\"后台切回来大厅 4\");\r\n\r\n\t\t} catch (error) {\r\n\t\t\tthis.ErrLog(\"OnEventShow error:%s\", error.stack);\r\n\t\t}\r\n\t},\r\n\r\n\t//初始化客户端访问路径和app版本号\r\n\tOnInitClientData: function (clientPath, appVersion) {\r\n\t\tthis.clientState = this.ShareDefine.State_InitSuccess;\r\n\t},\r\n\tShareDefineGame: function (allGames) {\r\n\t\tif (!allGames || allGames.length == 0) return;\r\n\t\tthis.ShareDefine.GametTypeNameDict = {};\r\n\t\tthis.ShareDefine.GametTypeID2Name = {};\r\n\t\tthis.ShareDefine.GametTypeID2PinYin = {};\r\n\t\tfor (const key in allGames) {\r\n\t\t\tvar game = allGames[key]\r\n\t\t\tthis.ShareDefine.GametTypeNameDict[game.Name.toUpperCase()] = game.Id;\r\n\t\t\tthis.ShareDefine.GametTypeID2Name[game.Id] = game.Name_1;\r\n\t\t\tthis.ShareDefine.GametTypeID2PinYin[game.Id] = game.Name;\r\n\t\t}\r\n\t},\r\n\t//客户端初始化成功回调\r\n\tOnInitClientFinish: function (allTableDataDict, clientConfig) {\r\n\t\t// this.SysLog(\"OnInitClientFinish clientConfig:\", JSON.stringify(clientConfig));\r\n\t\t// console.log(\"OnInitClientFinish allTableDataDict == \" + JSON.stringify(allTableDataDict));\r\n\t\tthis.ShareDefineGame(allTableDataDict.gametype.Data.json)\r\n\t\ttry {\r\n\t\t\tthis.clientConfig = clientConfig;\r\n\t\t\tthis.RefreshClientConfig();\r\n\r\n\t\t\tif (this.debugModel) {\r\n\t\t\t\tthis.debugModel.OnInitClientFinish();\r\n\t\t\t} else {\r\n\t\t\t\tlet debug = this.clientConfig[\"debug\"];\r\n\r\n\t\t\t\t//如果服务器下发debug\r\n\t\t\t\tif (debug && this.CheckDebugSign(debug)) {\r\n\t\t\t\t\tthis.InitDebug(true);\r\n\t\t\t\t\tthis.debugModel.OnInitClientFinish();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (this.clientState != this.ShareDefine.State_InitSuccess) {\r\n\t\t\t\tthis.ErrLog(\"OnInitClientFinish 初始化异常\");\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\r\n\t\t\tif (!this.InitModel()) {\r\n\t\t\t\tthis.ErrLog(\"OnInitClientFinish InitModel fail\");\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\r\n\t\t\tif (!this.InitTable(allTableDataDict)) {\r\n\t\t\t\tthis.ErrLog(\"OnInitClientFinish InitTable fail\");\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\r\n\t\t\t//初始化客户端所有管理器\r\n\t\t\tif (!this.InitManager()) {\r\n\t\t\t\tthis.ErrLog(\"OnInitClientFinish InitManager fail\");\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\r\n\t\t\t//强制CG一次,否则内存一直会占用不释放\r\n\t\t\t//cc.sys.garbageCollect();\r\n\r\n\t\t\t//输出运行环境信息\r\n\t\t\tcc.sys.dump();\r\n\r\n\t\t\tthis.SysLog(\"browserType:%s,%s,%s\", cc.sys.browserType, cc.sys.os, cc.sys.isNative);\r\n\r\n\r\n\t\t} catch (e) {\r\n\t\t\tthis.ErrLog(\"InitUpdateFinish:%s\", e.stack);\r\n\t\t}\r\n\t},\r\n\r\n\tLoadLogin: function () {\r\n\t\tthis.ClientLoginProcess();\r\n\t\tapp.WeChatManager().SendRequestWeChatSDKIntSign();\r\n\t},\r\n\r\n\t//刷新客户端启动配置字典\r\n\tRefreshClientConfig: function () {\r\n\t\tlet dbGameServerInfo = this.LocalDataManager.GetConfigProperty(\"DebugInfo\", \"GameServerInfo\");\r\n\t\tlet dbAccountServerInfo = this.LocalDataManager.GetConfigProperty(\"DebugInfo\", \"AccountServerInfo\");\r\n\t\tlet dbOrderServerInfo = this.LocalDataManager.GetConfigProperty(\"DebugInfo\", \"OrderServerInfo\");\r\n\t\tlet dbResServerInfo = this.LocalDataManager.GetConfigProperty(\"DebugInfo\", \"ResServerInfo\");\r\n\r\n\t\tif (dbGameServerInfo) {\r\n\t\t\tlet gameServerIP = dbGameServerInfo[\"GameServerIP\"];\r\n\t\t\tlet gameServerPort = dbGameServerInfo[\"GameServerPort\"];\r\n\r\n\t\t\tif (gameServerIP && gameServerPort) {\r\n\t\t\t\tthis.clientConfig[\"GameServerIP\"] = gameServerIP;\r\n\t\t\t\tthis.clientConfig[\"GameServerPort\"] = gameServerPort;\r\n\t\t\t\tthis.SysLog(\"OnInitClientFinish Use LocalData GameServer(%s:%s)\", gameServerIP, gameServerPort);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (dbAccountServerInfo) {\r\n\t\t\tlet accountServerIP = dbAccountServerInfo[\"AccountServerIP\"];\r\n\t\t\tlet accountServerPort = dbAccountServerInfo[\"AccountServerPort\"];\r\n\r\n\t\t\tif (accountServerIP && accountServerPort) {\r\n\t\t\t\tthis.clientConfig[\"AccountServerIP\"] = accountServerIP;\r\n\t\t\t\tthis.clientConfig[\"AccountServerPort\"] = accountServerPort;\r\n\t\t\t\tthis.SysLog(\"OnInitClientFinish Use LocalData AccountServer(%s:%s)\", accountServerIP, accountServerPort);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (dbOrderServerInfo) {\r\n\t\t\tlet orderServerIP = dbOrderServerInfo[\"OrderServerIP\"];\r\n\t\t\tlet orderServerPort = dbOrderServerInfo[\"OrderServerPort\"];\r\n\r\n\t\t\tif (orderServerIP && orderServerPort) {\r\n\t\t\t\tthis.clientConfig[\"OrderServerIP\"] = orderServerIP;\r\n\t\t\t\tthis.clientConfig[\"OrderServerPort\"] = orderServerPort;\r\n\t\t\t\tthis.SysLog(\"OnInitClientFinish Use LocalData OrderServer(%s:%s)\", orderServerIP, orderServerPort);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (dbResServerInfo) {\r\n\t\t\tlet resServerIP = dbResServerInfo[\"ResServerIP\"];\r\n\t\t\tlet resServerPort = dbResServerInfo[\"ResServerPort\"];\r\n\r\n\t\t\tif (resServerIP && resServerPort) {\r\n\t\t\t\tthis.clientConfig[\"ResServerIP\"] = resServerIP;\r\n\t\t\t\tthis.clientConfig[\"ResServerPort\"] = resServerPort;\r\n\t\t\t\tthis.SysLog(\"OnInitClientFinish Use LocalData ResServer(%s:%s)\", resServerIP, resServerPort);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//如果是H5连接启动,使用的账号和支付方式，需要重置一次\r\n\t\t//H5使用的账号授权SDK和支付SDK 又配置的连接携带的参数决定,不是由配置决定\r\n\t\t//公众号标示也有启动参数决定,不是由配置决定\r\n\t\tconsole.log(\"RefreshClientConfig cc.sys.isNative\", cc.sys.isNative);\r\n\t\tif (cc.sys.isNative) {\r\n\t\t\t//判断使用SDK授权,支付SDK,枚举是否存在\r\n\t\t\tlet accountType = this.clientConfig[\"AccountType\"];\r\n\t\t\tlet orderType = this.clientConfig[\"OrderType\"];\r\n\t\t\tif (!this.ShareDefine.AccountSDKTypeNameDict.hasOwnProperty(accountType)) {\r\n\t\t\t\tconsole.log(\"AccountSDKTypeNameDict not find :%s\", accountType);\r\n\t\t\t\tthis.clientConfig[\"AccountType\"] = this.ShareDefine.SDKType_Company;\r\n\t\t\t}\r\n\r\n\t\t\tif (!this.ShareDefine.OrderSDKTypeNameDict.hasOwnProperty(orderType)) {\r\n\t\t\t\tconsole.log(\"OrderSDKTypeNameDict not find :%s\", orderType);\r\n\t\t\t\tthis.clientConfig[\"OrderType\"] = this.ShareDefine.OrderType_Company;\r\n\t\t\t}\r\n\t\t} else {\r\n\r\n\t\t\tlet ddmchannel = this.startUpInfo[\"ddmchannel\"];\r\n\t\t\tlet ddmmp = this.startUpInfo[\"ddmmp\"];\r\n\r\n\t\t\tthis.clientConfig[\"Channel\"] = ddmchannel;\r\n\r\n\t\t\tif (ddmchannel == \"website\") {\r\n\t\t\t\tthis.clientConfig[\"AccountType\"] = this.ShareDefine.SDKType_Company;\r\n\t\t\t\tthis.clientConfig[\"OrderType\"] = this.ShareDefine.OrderType_Company;\r\n\t\t\t\tthis.clientConfig[\"MPID\"] = \"\";\r\n\t\t\t} else if (ddmchannel == \"wechat\") {\r\n\t\t\t\tthis.clientConfig[\"AccountType\"] = this.ShareDefine.SDKType_WeChat;\r\n\t\t\t\tthis.clientConfig[\"OrderType\"] = this.ShareDefine.OrderType_Wechat;\r\n\t\t\t\tthis.clientConfig[\"MPID\"] = ddmmp;\r\n\t\t\t}\r\n\t\t\t//可能是本机调试启动\r\n\t\t\telse if (!this.startUpInfo.hasOwnProperty(\"ddmchannel\")) {\r\n\t\t\t\tconsole.log(\"webdebug ddmchannel:%s \", ddmchannel);\r\n\t\t\t\tthis.clientConfig[\"AccountType\"] = this.ShareDefine.SDKType_Company;\r\n\t\t\t\tthis.clientConfig[\"OrderType\"] = this.ShareDefine.OrderType_Company;\r\n\t\t\t\tthis.clientConfig[\"MPID\"] = \"\";\r\n\t\t\t} else {\r\n\t\t\t\tthis.ErrLog(\"ddmchannel:%s error\", ddmchannel);\r\n\t\t\t\tthis.clientConfig[\"AccountType\"] = this.ShareDefine.SDKType_Company;\r\n\t\t\t\tthis.clientConfig[\"OrderType\"] = this.ShareDefine.OrderType_Company;\r\n\t\t\t\tthis.clientConfig[\"MPID\"] = \"\";\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t//初始化模块\r\n\tInitModel: function () {\r\n\t\tlet modelName = \"\";\r\n\t\ttry {\r\n\t\t\tlet NeedCreateList = app.NeedCreateList;\r\n\t\t\tlet count = NeedCreateList.length;\r\n\t\t\tfor (let index = 0; index < count; index++) {\r\n\t\t\t\tmodelName = NeedCreateList[index];\r\n\t\t\t\t//设置所有单例引用接口到app\r\n\t\t\t\tapp[modelName] = require(modelName).GetModel;\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tthis.ErrLog(\"OnLoad require(%s) error:%s\", modelName, error.stack);\r\n\t\t\treturn false\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t},\r\n\r\n\t//初始化表数据\r\n\tInitTable: function (allTableDataDict) {\r\n\r\n\t\tlet SysDataManager = app.SysDataManager();\r\n\r\n\t\tlet allTableNameList = Object.keys(allTableDataDict);\r\n\t\tlet count = allTableNameList.length;\r\n\t\tfor (let index = 0; index < count; index++) {\r\n\t\t\tlet tableName = allTableNameList[index];\r\n\t\t\tlet tableInfo = allTableDataDict[tableName];\r\n\t\t\tSysDataManager.OnLoadTableEnd(tableName, tableInfo[\"KeyNameList\"], tableInfo[\"Data\"]);\r\n\t\t}\r\n\r\n\t\treturn true\r\n\t},\r\n\r\n\t//初始化管理器\r\n\tInitManager: function () {\r\n\t\tconsole.log(\"ClietManage InitManager\");\r\n\t\t//实例化所有单例管理器\r\n\t\tlet NeedCreateList = app.NeedCreateList;\r\n\t\tlet count = NeedCreateList.length;\r\n\r\n\t\tlet modelName = \"\";\r\n\t\ttry {\r\n\t\t\tfor (let index = 0; index < count; index++) {\r\n\t\t\t\tmodelName = NeedCreateList[index];\r\n\t\t\t\trequire(modelName).GetModel();\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tthis.ErrLog(\"InitManager(%s) error:%s\", modelName, error.stack);\r\n\t\t\treturn false\r\n\t\t}\r\n\t\t//追加调试全局入口\r\n\t\t// if(window){\r\n\t\t// \twindow[\"app\"] = app;\r\n\t\t// \twindow[\"t\"] = app.TestManager();\r\n\t\t// }\r\n\r\n\t\tlet NetManager = app.NetManager();\r\n\t\tlet startUrl = \"\";\r\n\t\t//初始化资源服务器地址\r\n\t\tif (window.location) {\r\n\t\t\tstartUrl = window.location.origin;\r\n\t\t}\r\n\t\tNetManager.SetH5ClientStartUrl(startUrl);\r\n\r\n\t\t//封包注册\r\n\t\t//封包事件注册\r\n\r\n\t\t//心跳\r\n\t\tNetManager.RegNetPack(\"SPlayerHeartBeat\", this.OnPack_HeartBeat, this);\r\n\t\tNetManager.RegNetPack(\"base.C1111RoleReLogin\", this.OnPack_RoleTest, this);\r\n\t\tNetManager.RegNetPack(\"base.C1004Login\", this.OnPack_BaseLogin, this);\r\n\t\tNetManager.RegNetPack(\"base.C1006RoleLogin\", this.OnPack_OnHeroLogin, this);\r\n\t\tNetManager.RegNetPack(\"base.C1001CreateRole\", this.OnPack_OnHeroLogin, this);\r\n\t\tNetManager.RegNetPack(\"base.C1005PlayerInfo\", this.OnPack_PlayerInfo, this);\r\n\t\tNetManager.RegNetPack(\"kickout\", this.OnPack_Kickout, this);\r\n\t\tNetManager.RegNetPack(\"SPlayer_OnlineTime\", this.OnPack_Online, this);\r\n\t\t//断线重连状态\r\n\t\tNetManager.RegNetPack(\"game.CGetGameStatus\", this.OnPack_GetGameStatus, this);\r\n\t\t//玩家点击继续\r\n\t\tNetManager.RegNetPack(\"SPlayer_Continue\", this.OnEvent_SPlayerContinue, this);\r\n\t\t//抽奖奖品领取通知\r\n\t\tNetManager.RegNetPack(\"SPlayer_LuckDrawReceive\", this.OnPack_LuckDrawReceive, this);\r\n\r\n\t\t// this.RegEvent(\"InitPlayerFamily\", this.OnEvent_InitPlayerFamily, this);\r\n\t\t// this.RegEvent(\"LoginGetCurRoomID\", this.OnEvent_LoginGetCurRoomID, this);\r\n\r\n\t\t// //断线重连成功通知\r\n\t\t// app.Client.RegEvent(\"ConnectSuccess\", this.OnEvent_ConnectSuccess, this);\r\n\t\t//初始化管理器完成调用一次sdk初始化接口(h5游戏客户端需要初始化携带的sdk参数:token)\r\n\t\t// console.log(\"InitManager this.startUpInfo:\", this.startUpInfo);\r\n\t\tapp.SDKManager().InitSDKParameter(this.startUpInfo);\r\n\r\n\t\treturn true;\r\n\r\n\t},\r\n\r\n\tRegAllEvent: function () {\r\n\t\tthis.RegEvent(\"InitPlayerFamily\", this.OnEvent_InitPlayerFamily, this);\r\n\t\tthis.RegEvent(\"LoginGetCurRoomID\", this.OnEvent_LoginGetCurRoomID, this);\r\n\r\n\t\t//断线重连成功通知\r\n\t\tthis.RegEvent(\"ConnectSuccess\", this.OnEvent_ConnectSuccess, this);\r\n\t\t//事件\r\n\t\tthis.RegEvent(\"CodeError\", this.Event_CodeError, this);\r\n\t\tthis.RegEvent(\"CheckMicPermission\", this.OnCheckMicPermission, this);\r\n\t},\r\n\r\n\t//---------------------客户端事件分发接口-----------------------------\r\n\t//客户端封包事件\r\n\tOnEvent: function (eventName, argDict) {\r\n\t\tif (argDict) {\r\n\t\t\tthis.Log(\"OnEvent(%s):\", eventName, argDict);\r\n\t\t} else {\r\n\t\t\tthis.Log(\"OnEvent(%s)\", eventName);\r\n\t\t}\r\n\t\tif (!this.node) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tlet curRunGame = cc.sys.localStorage.getItem(\"curRunGame\");\r\n\t\t\tif (curRunGame != \"hall\") {\r\n\t\t\t\tconsole.log(\"当前游戏在 \" + curRunGame + \",无需分发事件\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.node.emit(eventName, argDict);\r\n\t\t} catch (error) {\r\n\t\t\tthis.ErrLog(\"大厅事件分发 OnEvent:%s\", error.stack)\r\n\t\t}\r\n\t},\r\n\tOnEvent_SPlayerContinue: function (serverPack) {\r\n\t\tlet roomKey = serverPack.roomKey;\r\n\t\tlet userName = serverPack.shortPlayer.name;\r\n\t\tlet paymentRoomCardType = serverPack.paymentRoomCardType;\r\n\t\tapp.FormManager().ShowForm('UIJoinMessage', roomKey, userName, paymentRoomCardType);\r\n\t},\r\n\r\n\t//注册封包事件\r\n\tRegEvent: function (eventName, func, target) {\r\n\t\tif (!this.node) {\r\n\t\t\t//节点已经被销毁了\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!func || !target) {\r\n\t\t\tthis.ErrLog(\"eventName:%s error\", eventName);\r\n\t\t\treturn\r\n\t\t}\r\n\t\tthis.node.on(eventName, func, target);\r\n\t},\r\n\r\n\t//取消注册封包事件\r\n\tUnRegTargetEvent: function (target, eventName = \"\", func = \"\") {\r\n\t\tif (!this.node) {\r\n\t\t\t//节点已经被销毁了\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t//如果有制定注销事件\r\n\t\tif (eventName && func) {\r\n\t\t\tthis.node.off(eventName, func, target);\r\n\t\t} else {\r\n\t\t\tthis.node.targetOff(target);\r\n\t\t}\r\n\t},\r\n\r\n\t//键盘按下\r\n\tOnKeyDown: function (event) {\r\n\t\tlet keyCode = event.keyCode;\r\n\t\tswitch (keyCode) {\r\n\t\t\tcase cc.macro.KEY.back: {\r\n\t\t\t\tlet msgID = \"MSG_EXIT_GAME\";\r\n\t\t\t\tlet ConfirmManager = app.ConfirmManager();\r\n\t\t\t\tConfirmManager.SetWaitForConfirmForm(this.OnConFirm.bind(this), msgID, []);\r\n\t\t\t\tConfirmManager.ShowConfirm(this.ShareDefine.Confirm, msgID, []);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.OnEvent(\"OnKeyDown\", { \"KeyCode\": keyCode });\r\n\t},\r\n\t//----------------逻辑函数----------------------\r\n\t//客户端是否登录封包完成\r\n\tIsClientLoginOK: function () {\r\n\t\treturn this.clientState == this.ShareDefine.State_Logined;\r\n\t},\r\n\r\n\tSetClientState: function (clientState) {\r\n\t\tthis.clientState = clientState;\r\n\t},\r\n\r\n\t//退出游戏到登录界面\r\n\tLogOutGame: function (code = 0) {\r\n\t\tconsole.log('LogOutGame');\r\n\t\tif (-1 == code) {\r\n\r\n\t\t} else if (-2 == code) {\r\n\t\t\tapp.SysNotifyManager().ShowSysMsg(\"Kick_ByServer\");\r\n\t\t}\r\n\t\tthis.SysLog(\"LogOutGame  00000 app.NetWork().isConnectIng:%s \", app.NetWork().isConnectIng);\r\n\t\t//断开连接\r\n\t\tif (app.NetWork().isConnectIng) {//不用Connected()底层websocket有BUG\r\n\t\t\tthis.SysLog(\"LogOutGame 1111\");\r\n\t\t\tapp.NetManager().Disconnect(true);\r\n\t\t}\r\n\t\tapp.LocalDataManager().SetConfigProperty(\"Account\", \"AccessTokenInfo\", {});\r\n\t\tapp.LocalDataManager().SetConfigProperty(\"Account\", \"XlOpenID\", \"\");\r\n\t\tthis.ClientLoginProcess();\r\n\t},\r\n\r\n\t/**\r\n\t * 退到客户端登录场景,客户端初始化s\r\n\t */\r\n\tClientLoginProcess: function () {\r\n\r\n\t\tlet SceneManager = app.SceneManager();\r\n\r\n\t\tlet sceneType = SceneManager.GetSceneType();\r\n\t\t//如果已经在登录场景则不切换\r\n\t\tif (sceneType == \"loginScene\") {\r\n\t\t\t//重新加载下登录场景，防止还未登录就卡死的\r\n\t\t\tthis.ClearClientData();\r\n\t\t\tSceneManager.LoadScene(\"loginScene\");\r\n\t\t\tif (!SceneManager.GetSceneComponent()) {\r\n\t\t\t\tthis.WarnLog(\"ClientLoginProcess not sceneName\");\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\tSceneManager.GetSceneComponent().OnTopEvent(\"Close\");\r\n\t\t}\r\n\t\t//如果不在登录场景，则切换到登录场景，\r\n\t\telse {\r\n\t\t\tthis.ClearClientData();\r\n\t\t\tSceneManager.LoadScene(\"loginScene\");\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t//清理管理器数据\r\n\tClearClientData: function () {\r\n\t\tthis.SysLog(\"ClearClientData\");\r\n\t\tapp.LocalDataManager().OnReload();\r\n\t\t//----客户端基础管理器---\r\n\t\tapp.NetManager().OnReload();\r\n\t\tapp.SceneManager().OnReload();\r\n\t\tapp.SDKManager().OnReload();\r\n\t\tapp.TalkingDataManager().OnReload();\r\n\r\n\t\tapp.ChatManager().OnReload();\r\n\r\n\t\t//----数据管理器-------\r\n\t\tapp.WorldInfoManager().OnReload();\r\n\t\tapp.FamilyManager().OnReload();\r\n\r\n\t\tapp.HeroAccountManager().OnReload();\r\n\t\tapp.HeroManager().OnReload();\r\n\t\tapp.NoticeManager().OnReload();\r\n\r\n\t\tapp.GameManager().OnReload();\r\n\t\tapp.PlayerRankManager().OnReload();\r\n\r\n\r\n\t\tapp.PlayerFamilyManager().OnReload();\r\n\r\n\t\tapp.PlayerRoomManager().OnReload();\r\n\t\tapp.RoomRecordManager().OnReload();\r\n\r\n\t\tthis.clientState = this.ShareDefine.State_WaitLogin;\r\n\t},\r\n\r\n\r\n\t//检测Debug签名\r\n\tCheckDebugSign: function (debugSign) {\r\n\t\t//生成签名\r\n\t\tlet argDict = {\r\n\t\t\t\"gameID\": \"p7\",\r\n\t\t\t\"gameType\": \"h5\",\r\n\t\t\t\"nonceStr\": \"18320c805fb57d88805d3918cdd1b2a3\",\r\n\t\t};\r\n\t\tlet argKeyList = Object.keys(argDict);\r\n\t\targKeyList.sort();\r\n\t\tlet keyCount = argKeyList.length;\r\n\t\tlet signString = \"\";\r\n\t\tfor (let index = 0; index < keyCount; index++) {\r\n\t\t\tlet keyName = argKeyList[index];\r\n\t\t\tsignString += [keyName, \"=\", argDict[keyName], \"&\"].join(\"\");\r\n\t\t}\r\n\t\tsignString += \"ddmh5.com\";\r\n\t\tlet sign = app.MD5.hex_md5(signString);\r\n\t\tif (sign == debugSign) {\r\n\t\t\treturn true\r\n\t\t}\r\n\t\treturn false\r\n\t},\r\n\r\n\t//--------------全局缓存---------------\r\n\r\n\t//获取全局缓存的bebug节点\r\n\tGetDebugModel: function () {\r\n\t\treturn this.debugModel;\r\n\t},\r\n\tMultiPoint: function (serverIP) {\r\n\t\tif (serverIP == \"\") {\r\n\t\t\treturn \"\";\r\n\t\t}\r\n\t\tif (!cc.sys.isNative) {\r\n\t\t\treturn serverIP;\r\n\t\t}\r\n\t\tif (app.Client.GetClientConfigProperty(\"IsGaoFang\") == 0) {\r\n\t\t\t//不接入高防\r\n\t\t\treturn serverIP;\r\n\t\t}\r\n\t\tlet AccessPoint = app.LocalDataManager().GetConfigProperty(\"Account\", \"AccessPoint\");\r\n\t\tif (AccessPoint > 0) {\r\n\t\t\tif (AccessPoint == 1) {\r\n\t\t\t\treturn 'line1.' + serverIP;\r\n\t\t\t} else if (AccessPoint == 2) {\r\n\t\t\t\treturn 'line2.' + serverIP;\r\n\t\t\t} else if (AccessPoint == 3) {\r\n\t\t\t\treturn 'line3.' + serverIP;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet AccountActive = app.LocalDataManager().GetConfigProperty(\"Account\", \"AccountActive\");\r\n\t\t//如果该城市有独立节点，则调用本城市自己的节点\r\n\t\tlet myCityID = cc.sys.localStorage.getItem(\"myCityID\");\r\n\t\tif (myCityID) {\r\n\t\t\tlet CityPoints = app.Client.GetClientConfigProperty(\"CityPoints\");\r\n\t\t\tif (CityPoints) {\r\n\t\t\t\tlet CityPointsList = CityPoints.split(',');\r\n\t\t\t\tif (CityPointsList.indexOf(myCityID) > -1) {\r\n\t\t\t\t\t//用户选择的城市有配置独立的节点\r\n\t\t\t\t\tif (AccountActive > 10) {\r\n\t\t\t\t\t\treturn 'h' + myCityID + '.' + serverIP; //活跃用户\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn 'c' + myCityID + '.' + serverIP; //普通用户\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (AccountActive > 100) {\r\n\t\t\tserverIP = 'a100.' + serverIP;\r\n\t\t} else if (AccountActive > 50) {\r\n\t\t\tserverIP = 'i50.' + serverIP;\r\n\t\t} else if (AccountActive > 10) {\r\n\t\t\tserverIP = 'x10.' + serverIP;\r\n\t\t}\r\n\r\n\t\treturn serverIP;\r\n\t},\r\n\t//获取客户端启动配置\r\n\tGetClientConfig: function () {\r\n\t\tlet clientConfig = [];\r\n\t\tlet mt = [\"GateServerIP\", \"GameServerIP\", \"AccountServerIP\", \"OrderServerIP\", \"ResServerIP\"];\r\n\t\tfor (var key in this.clientConfig) {\r\n\t\t\tif (mt.InArray(key)) {\r\n\t\t\t\tclientConfig[key] = this.MultiPoint(this.clientConfig[key]);\r\n\t\t\t} else {\r\n\t\t\t\tclientConfig[key] = this.clientConfig[key];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn clientConfig;\r\n\t},\r\n\tGetAppName: function () {\r\n\t\treturn \"xinhua\";\r\n\t},\r\n\t//获取客户端启动配置属性值\r\n\tGetClientConfigProperty: function (property) {\r\n\t\tlet mt = [\"GateServerIP\", \"GameServerIP\", \"AccountServerIP\", \"OrderServerIP\", \"ResServerIP\"];\r\n\t\tif (this.clientConfig.hasOwnProperty(property)) {\r\n\t\t\tif (mt.InArray(property)) {\r\n\t\t\t\treturn this.MultiPoint(this.clientConfig[property]);\r\n\t\t\t} else {\r\n\t\t\t\t//\"WeChatAppShareUrl\",如果是宝岛棋牌，换分享地址\r\n\t\t\t\tif (property != \"WeChatAppShareUrl\") {\r\n\t\t\t\t\treturn this.clientConfig[property];\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn this.clientConfig[\"WeChatAppShareUrl\"];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.ErrLog(\"GetClientConfigProperty not find :%s\", property);\r\n\t\t\treturn 0\r\n\t\t}\r\n\t},\r\n\r\n\t//获取启动属性值\r\n\tGetStartUpProperty: function (property) {\r\n\t\tif (!this.startUpInfo.hasOwnProperty(property)) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\treturn this.startUpInfo[property];\r\n\t},\r\n\r\n\tGetGlobalEffectNode: function (effectName) {\r\n\t\tif (!this.node) {\r\n\t\t\t//节点已经被销毁了\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (this.node == null) {\r\n\t\t\tconsole.log(\"ClietManage 节点已经被销毁了\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (this.node.getChildByName('globalEffect') == null) {\r\n\t\t\tconsole.log(\"globalEffect 节点已经被销毁了\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet effectNode = this.node.getChildByName('globalEffect').getChildByName(effectName);\r\n\t\tif (!effectNode) {\r\n\t\t\tthis.ErrLog(\"GetGlobalEffectNode(%s) not find\", effectName);\r\n\t\t\treturn\r\n\t\t}\r\n\t\teffectNode.removeFromParent(false);\r\n\t\treturn effectNode\r\n\t},\r\n\tStartReConnect: function () {\r\n\t\tif (this.bStartReConnect)\r\n\t\t\treturn;\r\n\t\tthis.bStartReConnect = true;\r\n\t\t// this.reConnectUseTime = 0;\r\n\t\t// this.reConnectLable.string = '连接失败,重新加载中(1秒)...';\r\n\t\t// this.lastReConnectTime = new Date().getTime();\r\n\t\t// this.reConnectTip.active = true;\r\n\t},\r\n\tCloseReConnectTip: function () {\r\n\t\tthis.bStartReConnect = false;\r\n\t\tthis.lastReConnectTime = 0;\r\n\t\tthis.reConnectUseTime = 0;\r\n\t\tthis.reConnectLable.string = '';\r\n\t\tthis.reConnectTip.active = false;\r\n\t},\r\n\tPushGlobalEffectNode: function (effectNode) {\r\n\t\tif (!this.node) {\r\n\t\t\t//节点已经被销毁了\r\n\t\t\treturn;\r\n\t\t}\r\n\t\teffectNode.removeFromParent(false);\r\n\t\tthis.node.getChildByName('globalEffect').addChild(effectNode);\r\n\t},\r\n\r\n\tGetIsFirstLogin: function () {\r\n\t\treturn this.isFirstLogin\r\n\t},\r\n\r\n\tSetFirstLogin: function () {\r\n\t\tthis.isFirstLogin = false;\r\n\t},\r\n\r\n\t//取消常驻节点，以便重新加载游戏\r\n\tRemoveClientManager: function () {\r\n\t\tcc.game.removePersistRootNode(this.node);\r\n\t\t//清理已经加载的界面\r\n\t\tapp.FormManager().loadFormDict = {};\r\n\t\tapp.FormManager().showFormDict = {};\r\n\t\tapp.FormManager().createingFormDict = {};\r\n\t\tapp.FormManager().formWndShowInfo = {};\r\n\t\tapp.FormManager().defaultFormNameList = [];\r\n\t\t//清理已经加载的缓存\r\n\t\tapp.Client.ControlManager.ReleaseAllRes();\r\n\t\t//清除注册事件\r\n\t\t// this.UnRegTargetEvent(this);\r\n\t\t//取消注册所有的net注册事件\r\n\t\t// app.NetManager().UnRegAllNetPack();\r\n\t\t//       let baseForm = require(\"BaseForm\");\r\n\t\t// baseForm._eventFuncDict = {};\r\n\t\tthis.destroy();\r\n\t\tthis.node.destroy();\r\n\t},\r\n\r\n\t//进入子游戏\r\n\tEnterSubGame: function (name, switchGameData = null, roomKey = 0) {\r\n\t\t//如果是游戏切换需要释放内存，重新加载\r\n\t\tif (!cc.sys.isNative) return;\r\n\t\tif (name == \"sss_zz\" || name == \"sss_dr\") {\r\n\t\t\tname = \"sss\";\r\n\t\t}\r\n\t\tif (roomKey > 0) {\r\n\t\t\tlet self = this;\r\n\t\t\tapp.NetManager().SendPack(\"room.CBaseGetRoomCfg\", { \"roomKey\": roomKey }, function (event) {\r\n\t\t\t\tconsole.log(\"roomCfg === \" + JSON.stringify(event));\r\n\t\t\t\tif (event.lianmai == 2) {\r\n\t\t\t\t\tlet switchGameDataStr = \"\";\r\n\t\t\t\t\tif (switchGameData != null) {\r\n\t\t\t\t\t\tswitchGameDataStr = JSON.stringify(switchGameData);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tapp.NativeManager().CallToNative(\"CheckMicPermission\", [{\r\n\t\t\t\t\t\t\"Name\": \"name\",\r\n\t\t\t\t\t\t\"Value\": name\r\n\t\t\t\t\t}, { \"Name\": \"switchGameData\", \"Value\": switchGameDataStr }]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.StartEnterGame(name, switchGameData);\r\n\t\t\t\t}\r\n\t\t\t}, function (error) {\r\n\t\t\t\tconsole.log(\"获取房间配置失败\");\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tthis.StartEnterGame(name, switchGameData);\r\n\t\t}\r\n\t},\r\n\r\n\tStartEnterGame: function (name, switchGameData = null) {\r\n\t\tif (switchGameData != null) {\r\n\t\t\t// let testData = {action:\"showForm\", fromName:\"UIStore\"};\r\n\t\t\tcc.sys.localStorage.setItem(\"switchGameData\", JSON.stringify(switchGameData));\r\n\t\t}\r\n\t\tlet that = this;\r\n\t\tthis.RemoveClientManager();\r\n\t\t//切换GameServer节点再进入游戏\r\n\t\tconsole.log(\"EnterSubGame name:\" + name);\r\n\t\tlet gamtTypeID = app.ShareDefine().GametTypeNameDict[name.toUpperCase()];\r\n\t\tlet successFunc = function (success) {\r\n\t\t\tlet localConfig = cc.sys.localStorage.getItem(\"localConfig\");\r\n\t\t\tlet clientConfig = JSON.parse(localConfig);\r\n\t\t\tif (success.isStart == false) {\r\n\t\t\t\tapp.SysNotifyManager().ShowSysMsg(\"游戏维护中，请稍后重试\", [], 3);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tclientConfig[\"GameServerIP\"] = success.gameServerIP;\r\n\t\t\tclientConfig[\"GameServerPort\"] = success.gameServerPort;\r\n\t\t\t//刷新GameServerIp给子游戏\r\n\t\t\tcc.sys.localStorage.setItem(\"localConfig\", JSON.stringify(clientConfig));\r\n\t\t\tapp.SoundManager().StopAllSound();\r\n\t\t\tapp.NetManager().SendPack(\"base.C1110UUID\", { \"gameName\": name }, function (event) {\r\n\t\t\t\tapp.LocalDataManager().SetConfigProperty(\"Account\", \"uuid\", event);\r\n\t\t\t\t//停止场景音乐\r\n\t\t\t\tapp.SoundManager().StopAllSound();\r\n\t\t\t\tif (app.NetWork().isConnectIng) {\r\n\t\t\t\t\tconsole.log(\"获取uuid成功，断开连接\");\r\n\t\t\t\t\tapp.NetManager().Disconnect(true);\r\n\t\t\t\t}\r\n\t\t\t\tSubgameManager.enterSubgame(name);\r\n\t\t\t}, function (error) {\r\n\t\t\t\tconsole.log(\"获取uuid失败\");\r\n\t\t\t});\r\n\r\n\t\t}\r\n\t\tlet failFunc = function (error) {\r\n\t\t\tapp.SysNotifyManager().ShowSysMsg(\"游戏地址获取失败\", [], 3);\r\n\t\t}\r\n\t\tif (that.gameInfo && that.gameInfo[gamtTypeID] && that.gameInfo[gamtTypeID][\"gameServerIP\"]) {\r\n\t\t\tsuccessFunc(that.gameInfo[gamtTypeID])\r\n\t\t}\r\n\t\telse {\r\n\t\t\tapp.NetManager().SendPack(\"room.CBaseGameTypeUrl\", { \"gametype\": gamtTypeID }, successFunc, failFunc)\r\n\t\t}\r\n\t},\r\n\r\n\r\n\t//检测下子游戏是否下载或者有新版本\r\n\tChangeRoomCheckSubGame: function (gameName, roomKey, clubId = 0, haveEnterFunction = undefined, password = \"\") {\r\n\t\tlet self = this;\r\n\t\tif (!cc.sys.isNative) {\r\n\t\t\tif (haveEnterFunction) {\r\n\t\t\t\thaveEnterFunction();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tapp.NetManager().SendPack(\"room.CBaseChangeRoom\", {\r\n\t\t\t\t\"roomKey\": roomKey,\r\n\t\t\t\t\"posID\": -1,\r\n\t\t\t\t\"password\": password,\r\n\t\t\t\t\"clubId\": clubId\r\n\t\t\t}, function (event) {\r\n\t\t\t\tapp.SysNotifyManager().ShowSysMsg(\"换房间成功\", [], 3);\r\n\t\t\t}, function (event) {\r\n\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (gameName == \"sss_zz\" || gameName == \"sss_dr\") {\r\n\t\t\tgameName = \"sss\";\r\n\t\t}\r\n\t\tif (self.tryEnterGame) {\r\n\t\t\tconsole.log(\"正在检测更新...\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tself.tryEnterGame = true;\r\n\t\t//延迟2秒再次检测是否更新\r\n\t\tthis.scheduleOnce(function () {\r\n\t\t\tself.tryEnterGame = false;\r\n\t\t}, 2);\r\n\t\t//判断子游戏有没有下载\r\n\t\tif (SubgameManager.isSubgameDownLoad(gameName)) {\r\n\t\t\t//已下载，判断是否需要更新\r\n\t\t\tSubgameManager.needUpdateSubgame(gameName, (success) => {\r\n\t\t\t\tif (success) {\r\n\t\t\t\t\t//子游戏需要更新;\r\n\t\t\t\t\tapp.FormManager().ShowForm(\"UIDownLoadGame\", gameName, roomKey, null, 0, 0, false, clubId, undefined, haveEnterFunction, true, password);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (haveEnterFunction) {\r\n\t\t\t\t\t\thaveEnterFunction();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//子游戏不需要更新;\r\n\t\t\t\t\tapp.NetManager().SendPack(\"room.CBaseChangeRoom\", {\r\n\t\t\t\t\t\t\"roomKey\": roomKey,\r\n\t\t\t\t\t\t\"posID\": -1,\r\n\t\t\t\t\t\t\"password\": password,\r\n\t\t\t\t\t\t\"clubId\": clubId\r\n\t\t\t\t\t}, function (event) {\r\n\t\t\t\t\t\tapp.SysNotifyManager().ShowSysMsg(\"换房间成功\", [], 3);\r\n\t\t\t\t\t}, function (event) {\r\n\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}, () => {\r\n\t\t\t\tconsole.log(\"JoinRoomCheckSubGame 子游戏更新失败\");\r\n\t\t\t\t//下载失败如果已经下载了游戏，直接进。热更服有可能被攻击\r\n\t\t\t\tif (haveEnterFunction) {\r\n\t\t\t\t\thaveEnterFunction();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tapp.NetManager().SendPack(\"room.CBaseChangeRoom\", {\r\n\t\t\t\t\t\"roomKey\": roomKey,\r\n\t\t\t\t\t\"posID\": -1,\r\n\t\t\t\t\t\"password\": password,\r\n\t\t\t\t\t\"clubId\": clubId\r\n\t\t\t\t}, function (event) {\r\n\t\t\t\t\tapp.SysNotifyManager().ShowSysMsg(\"换房间成功\", [], 3);\r\n\t\t\t\t}, function (event) {\r\n\r\n\t\t\t\t});\r\n\t\t\t\t// app.SysNotifyManager().ShowSysMsg(\"游戏检测更新失败，建议重启游戏再进\");\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\t//未下载\r\n\t\t\tapp.FormManager().ShowForm(\"UIDownLoadGame\", gameName, roomKey, null, 0, 0, false, clubId, undefined, haveEnterFunction, true, password);\r\n\t\t}\r\n\t},\r\n\t//检测下子游戏是否下载或者有新版本\r\n\tJoinRoomCheckSubGame: function (gameName, roomKey, clubId = 0, haveEnterFunction = undefined, password = \"\", existQuickJoin = false) {\r\n\t\tlet mainComponent = app.FormManager().GetFormComponentByFormName(\"UINewMain\");\r\n\t\tif (mainComponent && 0 != mainComponent.curRoomID) {\r\n\t\t\tlet curGameType = app.ShareDefine().GametTypeNameDict[mainComponent.curGameTypeStr.toUpperCase()];\r\n\t\t\tlet msgID = \"MSG_GO_ROOM\";\r\n\t\t\tlet ConfirmManager = app.ConfirmManager();\r\n\t\t\tConfirmManager.SetWaitForConfirmForm(this.OnConFirm.bind(this), msgID, [mainComponent.curGameTypeStr]);\r\n\t\t\tConfirmManager.ShowConfirm(this.ShareDefine.Confirm, msgID, [app.ShareDefine().GametTypeID2Name[curGameType]]);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet self = this;\r\n\t\tif (!cc.sys.isNative) {\r\n\t\t\tif (haveEnterFunction) {\r\n\t\t\t\thaveEnterFunction();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tapp.NetManager().SendPack(\"room.CBaseEnterRoom\", {\r\n\t\t\t\t\"roomKey\": roomKey,\r\n\t\t\t\t\"posID\": -1,\r\n\t\t\t\t\"password\": password,\r\n\t\t\t\t\"clubId\": clubId,\r\n\t\t\t\t\"existQuickJoin\": existQuickJoin\r\n\t\t\t}, function (event) {\r\n\t\t\t\t//app.SysNotifyManager().ShowSysMsg(\"加入房间成功\", [], 3);\r\n\t\t\t}, function (event) {\r\n\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (gameName == \"sss_zz\" || gameName == \"sss_dr\") {\r\n\t\t\tgameName = \"sss\";\r\n\t\t}\r\n\t\tif (self.tryEnterGame) {\r\n\t\t\tconsole.log(\"正在检测更新...\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tself.tryEnterGame = true;\r\n\t\t//延迟2秒再次检测是否更新\r\n\t\tthis.scheduleOnce(function () {\r\n\t\t\tself.tryEnterGame = false;\r\n\t\t}, 2);\r\n\t\t//判断子游戏有没有下载\r\n\t\tif (SubgameManager.isSubgameDownLoad(gameName)) {\r\n\t\t\t//已下载，判断是否需要更新\r\n\t\t\tSubgameManager.needUpdateSubgame(gameName, (success) => {\r\n\t\t\t\tif (success) {\r\n\t\t\t\t\t//子游戏需要更新;\r\n\t\t\t\t\tapp.FormManager().ShowForm(\"UIDownLoadGame\", gameName, roomKey, null, 0, 0, false, clubId, undefined, haveEnterFunction, password, existQuickJoin);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (haveEnterFunction) {\r\n\t\t\t\t\t\thaveEnterFunction();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//子游戏不需要更新;\r\n\t\t\t\t\tapp.NetManager().SendPack(\"room.CBaseEnterRoom\", {\r\n\t\t\t\t\t\t\"roomKey\": roomKey,\r\n\t\t\t\t\t\t\"posID\": -1,\r\n\t\t\t\t\t\t\"password\": password,\r\n\t\t\t\t\t\t\"existQuickJoin\": existQuickJoin,\r\n\t\t\t\t\t\t\"clubId\": clubId\r\n\t\t\t\t\t}, function (event) {\r\n\t\t\t\t\t\t///app.SysNotifyManager().ShowSysMsg(\"加入房间成功\", [], 3);\r\n\t\t\t\t\t}, function (event) {\r\n\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}, () => {\r\n\t\t\t\tconsole.log(\"JoinRoomCheckSubGame 子游戏更新失败\");\r\n\t\t\t\t//下载失败如果已经下载了游戏，直接进。热更服有可能被攻击\r\n\t\t\t\tif (haveEnterFunction) {\r\n\t\t\t\t\thaveEnterFunction();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tapp.NetManager().SendPack(\"room.CBaseEnterRoom\", {\r\n\t\t\t\t\t\"roomKey\": roomKey,\r\n\t\t\t\t\t\"posID\": -1,\r\n\t\t\t\t\t\"password\": password,\r\n\t\t\t\t\t\"existQuickJoin\": existQuickJoin,\r\n\t\t\t\t\t\"clubId\": clubId\r\n\t\t\t\t}, function (event) {\r\n\t\t\t\t\t//app.SysNotifyManager().ShowSysMsg(\"加入房间成功\", [], 3);\r\n\t\t\t\t}, function (event) {\r\n\r\n\t\t\t\t});\r\n\t\t\t\t// app.SysNotifyManager().ShowSysMsg(\"游戏检测更新失败，建议重启游戏再进\");\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\t//未下载\r\n\t\t\tapp.FormManager().ShowForm(\"UIDownLoadGame\", gameName, roomKey, null, 0, 0, false, clubId, undefined, haveEnterFunction, password, existQuickJoin);\r\n\t\t}\r\n\t},\r\n\t//检测下子游戏是否下载或者有新版本\r\n\tPracticeRoomCheckSubGame: function (gameName, practiceId) {\r\n\t\tif (!cc.sys.isNative) return;\r\n\t\tlet self = this;\r\n\t\tif (gameName == \"sss_zz\" || gameName == \"sss_dr\") {\r\n\t\t\tgameName = \"sss\";\r\n\t\t}\r\n\t\tif (self.tryEnterGame) {\r\n\t\t\tconsole.log(\"正在检测更新...\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tself.tryEnterGame = true;\r\n\t\t//延迟2秒再次检测是否更新\r\n\t\tthis.scheduleOnce(function () {\r\n\t\t\tself.tryEnterGame = false;\r\n\t\t}, 2);\r\n\t\t//判断子游戏有没有下载\r\n\t\tif (SubgameManager.isSubgameDownLoad(gameName)) {\r\n\t\t\t//已下载，判断是否需要更新\r\n\t\t\tSubgameManager.needUpdateSubgame(gameName, (success) => {\r\n\t\t\t\tif (success) {\r\n\t\t\t\t\t//子游戏需要更新;\r\n\t\t\t\t\tapp.FormManager().ShowForm(\"UIDownLoadGame\", gameName, 0, null, 0, practiceId);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t//子游戏不需要更新;\r\n\t\t\t\t\tapp.NetManager().SendPack(\"room.CBaseGoldRoom\", { \"practiceId\": practiceId }, function (event) {\r\n\t\t\t\t\t\tlet gameType = event.gameType;\r\n\t\t\t\t\t\tlet name = app.ShareDefine().GametTypeID2PinYin[gameType];\r\n\t\t\t\t\t\tself.EnterSubGame(name, null, 0);\r\n\t\t\t\t\t}, function (event) {\r\n\t\t\t\t\t\tconsole.log(\"进入房间失败...\");\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}, () => {\r\n\t\t\t\tconsole.log(\"子游戏更新失败\");\r\n\t\t\t\t//下载失败如果已经下载了游戏，直接进。热更服有可能被攻击\r\n\t\t\t\tapp.NetManager().SendPack(\"room.CBaseGoldRoom\", { \"practiceId\": practiceId }, function (event) {\r\n\t\t\t\t\tlet gameType = event.gameType;\r\n\t\t\t\t\tlet name = app.ShareDefine().GametTypeID2PinYin[gameType];\r\n\t\t\t\t\tself.EnterSubGame(name, null, 0);\r\n\t\t\t\t}, function (event) {\r\n\t\t\t\t\tconsole.log(\"进入房间失败...\");\r\n\t\t\t\t});\r\n\t\t\t\t// app.SysNotifyManager().ShowSysMsg(\"游戏检测更新失败，建议重启游戏再进\");\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\t//未下载\r\n\t\t\tapp.FormManager().ShowForm(\"UIDownLoadGame\", gameName, 0, null, 0, practiceId);\r\n\t\t}\r\n\t},\r\n\t//检测下子游戏是否下载或者有新版本\r\n\tCreateRoomCheckSubGame: function (gameName, sendPack) {\r\n\t\tif (gameName == \"sss_zz\" || gameName == \"sss_dr\") {\r\n\t\t\tgameName = \"sss\";\r\n\t\t}\r\n\t\tif (sendPack.gaoji && app.Client.GetClientConfigProperty(\"dianbo\")) {\r\n\t\t\tif (sendPack.gaoji.indexOf(5) < 0) {\r\n\t\t\t\tsendPack.gaoji.push(5)\r\n\t\t\t}\r\n\t\t\tif (sendPack.gaoji.indexOf(6) < 0) {\r\n\t\t\t\tsendPack.gaoji.push(6)\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!cc.sys.isNative) {\r\n\t\t\tif (sendPack.clubId && sendPack.clubId != 0) {\r\n\t\t\t\tapp.NetManager().SendPack(\"club.CClubCreateRoom\", sendPack, function (event) {\r\n\t\t\t\t\tconsole.log(\"创建房间成功\");\r\n\t\t\t\t}, function (event) {\r\n\t\t\t\t\tconsole.log(\"创建房间失败\");\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tapp.NetManager().SendPack(\"room.CBaseCreateRoom\", sendPack, function (event) {\r\n\t\t\t\t\tapp.SysNotifyManager().ShowSysMsg(\"创建房间成功\", [], 3);\r\n\t\t\t\t}, function (event) {\r\n\t\t\t\t\tapp.SysNotifyManager().ShowSysMsg(\"创建房间失败\", [], 3);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet self = this;\r\n\t\tif (self.tryEnterGame) {\r\n\t\t\tconsole.log(\"正在检测更新...\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tself.tryEnterGame = true;\r\n\t\t//延迟2秒再次检测是否更新\r\n\t\tthis.scheduleOnce(function () {\r\n\t\t\tself.tryEnterGame = false;\r\n\t\t}, 2);\r\n\t\t//判断子游戏有没有下载\r\n\t\tif (SubgameManager.isSubgameDownLoad(gameName)) {\r\n\t\t\t//已下载，判断是否需要更新\r\n\t\t\tSubgameManager.needUpdateSubgame(gameName, (success) => {\r\n\t\t\t\tif (success) {\r\n\t\t\t\t\t//子游戏需要更新;\r\n\t\t\t\t\tapp.FormManager().ShowForm(\"UIDownLoadGame\", gameName, 0, sendPack);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t//子游戏不需要更新;\r\n\t\t\t\t\tconsole.log(\"子游戏不需要更新\");\r\n\t\t\t\t\tif (sendPack.clubId && sendPack.clubId != 0) {\r\n\t\t\t\t\t\tapp.NetManager().SendPack(\"club.CClubCreateRoom\", sendPack, function (event) {\r\n\t\t\t\t\t\t\tconsole.log(\"创建房间成功\");\r\n\t\t\t\t\t\t}, function (event) {\r\n\t\t\t\t\t\t\tconsole.log(\"亲友圈创建房间失败\");\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tapp.NetManager().SendPack(\"room.CBaseCreateRoom\", sendPack, function (event) {\r\n\t\t\t\t\t\t\tconsole.log(\"创建房间成功\");\r\n\t\t\t\t\t\t}, function (event) {\r\n\t\t\t\t\t\t\tconsole.log(\"创建房间失败\");\r\n\t\t\t\t\t\t\tapp.SysNotifyManager().ShowSysMsg(\"创建房间失败\", [], 3);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}, () => {\r\n\t\t\t\tconsole.log(\"子游戏更新失败\");\r\n\t\t\t\t//下载失败如果已经下载了游戏，直接进。热更服有可能被攻击\r\n\t\t\t\tif (sendPack.clubId && sendPack.clubId != 0) {\r\n\t\t\t\t\tapp.NetManager().SendPack(\"club.CClubCreateRoom\", sendPack, function (event) {\r\n\t\t\t\t\t\tconsole.log(\"创建房间成功\");\r\n\t\t\t\t\t}, function (event) {\r\n\t\t\t\t\t\tconsole.log(\"亲友圈创建房间失败\");\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tapp.NetManager().SendPack(\"room.CBaseCreateRoom\", sendPack, function (event) {\r\n\t\t\t\t\t\tconsole.log(\"创建房间成功\");\r\n\t\t\t\t\t}, function (event) {\r\n\t\t\t\t\t\tapp.SysNotifyManager().ShowSysMsg(\"创建房间失败\", [], 3);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\t// app.SysNotifyManager().ShowSysMsg(\"游戏检测更新失败，建议重启游戏再进\");\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\t//未下载\r\n\t\t\tapp.FormManager().ShowForm(\"UIDownLoadGame\", gameName, 0, sendPack);\r\n\t\t}\r\n\t},\r\n\r\n\t//检测下子游戏是否下载或者有新版本\r\n\tVideoCheckSubGame: function (gameName, playBackCode) {\r\n\t\tif (!cc.sys.isNative) return;\r\n\t\tlet self = this;\r\n\t\tif (gameName == \"sss_zz\" || gameName == \"sss_dr\") {\r\n\t\t\tgameName = \"sss\";\r\n\t\t}\r\n\t\tif (self.tryEnterGame) {\r\n\t\t\tconsole.log(\"正在检测更新...\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tself.tryEnterGame = true;\r\n\t\t//延迟2秒再次检测是否更新\r\n\t\tthis.scheduleOnce(function () {\r\n\t\t\tself.tryEnterGame = false;\r\n\t\t}, 2);\r\n\t\t//判断子游戏有没有下载\r\n\t\tif (SubgameManager.isSubgameDownLoad(gameName)) {\r\n\t\t\t//已下载，判断是否需要更新\r\n\t\t\tSubgameManager.needUpdateSubgame(gameName, (success) => {\r\n\t\t\t\tif (success) {\r\n\t\t\t\t\t//子游戏需要更新;\r\n\t\t\t\t\tapp.FormManager().ShowForm(\"UIDownLoadGame\", gameName, 0, null, playBackCode);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t//子游戏不需要更新;\r\n\t\t\t\t\tlet videoData = { action: \"showVideo\", backCode: playBackCode };\r\n\t\t\t\t\tself.EnterSubGame(gameName, videoData);\r\n\t\t\t\t}\r\n\t\t\t}, () => {\r\n\t\t\t\tconsole.log(\"子游戏更新失败\");\r\n\t\t\t\t//下载失败如果已经下载了游戏，直接进。热更服有可能被攻击\r\n\t\t\t\tlet videoData = { action: \"showVideo\", backCode: playBackCode };\r\n\t\t\t\tself.EnterSubGame(gameName, videoData);\r\n\t\t\t\t//app.SysNotifyManager().ShowSysMsg(\"游戏检测更新失败，建议重启游戏再进\");\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\t//未下载\r\n\t\t\tapp.FormManager().ShowForm(\"UIDownLoadGame\", gameName, 0, null, playBackCode);\r\n\t\t}\r\n\t},\r\n\r\n\t//获取所有游戏id，并且根据最近玩的和已下载的排序\r\n\tGetAllGameIdFromServer: function (isNeedOnEvent = false) {\r\n\t\tlet allSelectCityData = app.HeroManager().GetCurSelectCityData();\r\n\t\tif (allSelectCityData.length == 0) {\r\n\t\t\t//没有选择城市\r\n\t\t\t// app.FormManager().ShowForm(\"UISelectCity\");\r\n\t\t\t// return this.allGameIdFormServer;\r\n\t\t\tconsole.log(\"没有选择城市\");\r\n\t\t} else {\r\n\t\t\tlet selectId = allSelectCityData[0]['selcetId'];\r\n\t\t\tlet selectCityConfig = app.SysDataManager().GetTableDict(\"selectCity\");\r\n\t\t\tif (selectCityConfig[selectId][\"Type\"] != 3) {\r\n\t\t\t\tapp.SysNotifyManager().ShowSysMsg(\"需指定县级市，才能进入游戏\");\r\n\t\t\t\tapp.FormManager().ShowForm(\"UISelectCity\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlet self = this;\r\n\t\t\t//根据选择的城市向服务端请求所有游戏\r\n\t\t\tapp.NetManager().SendPack(\"room.CBaseGameIdList\", { \"selectCityId\": selectId }, function (event) {\r\n\t\t\t\tself.allGameIdFormServer = event.split(\",\");\r\n\t\t\t\tif (isNeedOnEvent) {\r\n\t\t\t\t\tlet curGameList = self.GetAllGameId();\r\n\t\t\t\t\tlet argDict = {\r\n\t\t\t\t\t\t\"gameList\": curGameList,\r\n\t\t\t\t\t};\r\n\t\t\t\t\tself.OnEvent(\"ShowGameListByLocation\", argDict);\r\n\t\t\t\t}\r\n\t\t\t}, function (event) {\r\n\t\t\t\tconsole.log(\"获取游戏id失败\");\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\r\n\tGetAllGameId: function (isGetAllGame = false) {\r\n\t\tif (this.allGameIdFormServer == null) {\r\n\t\t\t//如果服务端下发游戏列表未取到\r\n\t\t\tthis.GetAllGameIdFromServer(true);\r\n\t\t\treturn [];\r\n\t\t}\r\n\t\tlet allGameIdFormtemp = [];\r\n\t\tfor (let i = 0; i < this.allGameIdFormServer.length; i++) {\r\n\t\t\tallGameIdFormtemp.push(this.allGameIdFormServer[i]);\r\n\t\t}\r\n\t\tconsole.log(\"allGameIdFormServer: \" + JSON.stringify(this.allGameIdFormServer));\r\n\t\tif (!cc.sys.isNative || isGetAllGame) {\r\n\t\t\treturn allGameIdFormtemp;\r\n\t\t}\r\n\r\n\t\tlet allGameId = [];\r\n\t\tlet latelyGameType = cc.sys.localStorage.getItem(\"latelyGameType\");\r\n\t\tif (latelyGameType && typeof (latelyGameType) == \"string\") {\r\n\t\t\tlet latelyGameId = app.ShareDefine().GametTypeNameDict[latelyGameType.toUpperCase()];\r\n\t\t\tlet index = allGameIdFormtemp.indexOf(latelyGameId);\r\n\t\t\tif (index > -1) {\r\n\t\t\t\tallGameId.unshift(latelyGameId);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (let i = 0; i < allGameIdFormtemp.length; i++) {\r\n\t\t\tif (!cc.sys.isNative) break;\r\n\t\t\tlet gameName = app.ShareDefine().GametTypeID2PinYin[allGameIdFormtemp[i]];\r\n\t\t\tif (allGameId.indexOf(allGameIdFormtemp[i]) > -1) {\r\n\t\t\t\t//已经在列表了\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif (SubgameManager.isSubgameDownLoad(gameName)) {\r\n\t\t\t\tallGameId.unshift(allGameIdFormtemp[i]);\r\n\t\t\t} else {\r\n\t\t\t\tallGameId.push(allGameIdFormtemp[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet that = this\r\n\t\tfor (let i = 0; i < allGameId.length; i++) {\r\n\t\t\tconst gameId = Number(allGameId[i]);\r\n\t\t\tif (!this.gameInfo[gameId]) {\r\n\t\t\t\tthis.gameInfo[gameId] = {}\r\n\t\t\t}\r\n\t\t\tif (!this.gameInfo[gameId][\"gameServerIP\"]) {\r\n\t\t\t\tapp.NetManager().SendPack(\"room.CBaseGameTypeUrl\", { \"gametype\": gameId }, function (success) {\r\n\t\t\t\t\tthat.gameInfo[gameId][\"isStart\"] = success.isStart;\r\n\t\t\t\t\tthat.gameInfo[gameId][\"gameServerIP\"] = success.gameServerIP;\r\n\t\t\t\t\tthat.gameInfo[gameId][\"gameServerPort\"] = success.gameServerPort;\r\n\t\t\t\t}, () => { });\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn allGameId;\r\n\t},\r\n\r\n\tonDestroy: function () {\r\n\t\t// console.log(\"游戏切换时应该销毁\");\r\n\t},\r\n\r\n\r\n\tSetWaitForConfirm: function (msgID, type, msgArg = [], cbArg = [], content = \"\", lbSure = \"\", lbCancle = \"\") {\r\n\t\tlet ConfirmManager = app.ConfirmManager();\r\n\t\tConfirmManager.SetWaitForConfirmForm(this.OnConFirm.bind(this), msgID, cbArg);\r\n\t\tConfirmManager.ShowConfirm(type, msgID, msgArg, content, lbSure, lbCancle);\r\n\t},\r\n\t/**\r\n\t * 2次确认点击回调\r\n\t * @param curEventType\r\n\t * @param curArgList\r\n\t */\r\n\tOnConFirm: function (clickType, msgID, backArgList) {\r\n\t\tif (clickType != \"Sure\") {\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif (msgID == \"RESELECT_CITY\") {\r\n\t\t\tlet self = this;\r\n\t\t\tlet selectCityConfig = app.SysDataManager().GetTableDict(\"selectCity\");\r\n\t\t\tif (selectCityConfig[backArgList[0]][\"Type\"] != 3) {\r\n\t\t\t\tthis.ShowSysMsg(\"需指定县级市，才能进入游戏\");\r\n\t\t\t\tapp.FormManager().ShowForm(\"UISelectCity\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t//根据选择的城市向服务端请求所有游戏\r\n\t\t\tapp.NetManager().SendPack(\"room.CBaseGameIdList\", { \"selectCityId\": backArgList[0] }, function (event) {\r\n\t\t\t\tself.allGameIdFormServer = event.split(\",\");\r\n\t\t\t\tlet curGameList = self.GetAllGameId();\r\n\t\t\t\tlet argDict = {\r\n\t\t\t\t\t\"gameList\": curGameList,\r\n\t\t\t\t};\r\n\t\t\t\tself.OnEvent(\"ShowGameListByLocation\", argDict);\r\n\t\t\t}, function (event) {\r\n\t\t\t\tconsole.log(\"获取游戏id失败\");\r\n\t\t\t});\r\n\t\t} else if ('MSG_EXIT_GAME' == msgID) {\r\n\t\t\tcc.game.end();\r\n\t\t} else if (\"MSG_GO_ROOM\" == msgID) {\r\n\t\t\tapp.Client.SetGameType(backArgList[0]);\r\n\t\t\tapp.FormManager().ShowForm(\"UIDownLoadGame\", backArgList[0], 0, null, 0, 0, true);\r\n\t\t} else if (\"MSG_CLOSE_MICPERMISSION\" == msgID) {\r\n\t\t\tif (cc.sys.isNative) {\r\n\t\t\t\tapp.NativeManager().CallToNative(\"ApplicationsSetting\", []);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n});"]}