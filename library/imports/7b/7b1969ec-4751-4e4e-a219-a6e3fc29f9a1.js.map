{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\script\\ui/assets\\script\\ui\\UIDownLoadGame.js"],"names":["app","require","SubgameManager","cc","Class","extends","properties","bgNode","Sprite","lb_gameName","Label","downLoadProgressBar","ProgressBar","lb_progress","imgBgMajiang","SpriteFrame","imgBgPoker","btn_exit","Node","btn_cancle","btn_downloadGame","btn_updateGame","btn_enterGame","OnCreateInit","gametypeConfig","SysDataManager","GetTableDict","selectGameName","isDownLoading","OnShow","gameName","roomKey","createRoomSendPack","playBackCode","practiceId","isEnterGame","clubId","unionData","haveEnterFunction","isChangeRoom","password","existQuickJoin","console","log","selectRoomKey","gametypeNum","ShareDefine","GametTypeNameDict","toUpperCase","gametypeData","Type","spriteFrame","appName","GetAppName","string","Name_1","progress","active","sys","isNative","that","isSubgameDownLoad","needUpdateSubgame","success","Client","EnterSubGame","CloseForm","OnEvent","SysNotifyManager","ShowSysMsg","clubDataTemp","gameIndex","enableGameType","FormManager","GetFormComponentByFormName","RemoveCloseFormArr","ShowForm","GetAllGameId","OnClick","btnName","btnNode","CheckGameDown","ErrLog","UIRLFILE_root","length","GetClientConfigProperty","checkUrl","file","jsb","fileUtils","getWritablePath","downFile2Local","url","fileName","self","downloader","Downloader","setOnFileTaskSuccess","DownloadSubgame","setOnTaskError","createDownloadFileTask","name","downloadSubgame","downloadedBytes","totalBytes","isNaN","parseInt","curGameList","argDict","EnterSubGameByType","NetManager","SendPack","event","gameType","GametTypeID2PinYin","videoData","action","backCode","Click_Btn_EnterGame","msgID","ConfirmManager","SetWaitForConfirmForm","OnConFirm","bind","ShowConfirm","Confirm","clickType","backArgList","game","end"],"mappings":"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","file":"UIDownLoadGame.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\ui","sourcesContent":["var app = require(\"app\");\nvar SubgameManager = require('SubgameManager');\ncc.Class({\n    extends: require(\"BaseForm\"),\n\n    properties: {\n        bgNode:cc.Sprite,\n        lb_gameName:cc.Label,\n        downLoadProgressBar:cc.ProgressBar,\n        lb_progress:cc.Label,\n        imgBgMajiang:cc.SpriteFrame,\n        imgBgPoker:cc.SpriteFrame,\n        btn_exit:cc.Node,\n        btn_cancle:cc.Node,\n        btn_downloadGame:cc.Node,\n        btn_updateGame:cc.Node,\n        btn_enterGame:cc.Node,\n    },\n\n    OnCreateInit: function () {\n        this.gametypeConfig = app.SysDataManager().GetTableDict(\"gametype\");\n        this.selectGameName = \"\";\n        this.isDownLoading = false;\n    },\n\n    OnShow: function (gameName, roomKey = 0, createRoomSendPack = null, playBackCode = 0, practiceId = 0, isEnterGame = false, clubId = 0, unionData = null, haveEnterFunction = null,isChangeRoom=false,password=\"\",existQuickJoin=false) {\n        if (gameName == \"sss_zz\" || gameName == \"sss_dr\") {\n            gameName = \"sss\";\n        }\n        console.log(\"downloadSubgame Name === \" + gameName);\n        this.selectGameName = gameName;\n        this.selectRoomKey = roomKey;\n        this.createRoomSendPack = createRoomSendPack;\n        this.playBackCode = playBackCode;\n        this.practiceId = practiceId;\n        this.isEnterGame = isEnterGame;\n        this.haveEnterFunction = haveEnterFunction;\n        this.clubId = clubId;\n        this.password=password;\n        this.existQuickJoin=existQuickJoin;\n        this.unionData = unionData;\n        this.isChangeRoom=isChangeRoom;\n        let gametypeNum = app.ShareDefine().GametTypeNameDict[gameName.toUpperCase()];\n        let gametypeData = this.gametypeConfig[gametypeNum];\n        if (!gametypeData) {\n            console.log(\"配表找不到游戏ID：\"+gametypeNum);\n            return;\n        }\n        if (gametypeData.Type == 1) {\n            //麻将\n            this.bgNode.spriteFrame = this.imgBgMajiang;\n        }else{\n            //扑克\n            this.bgNode.spriteFrame = this.imgBgPoker;\n        }\n        let appName=this.GetAppName();\n        if(appName==\"baodao\" && (gameName==\"nn\" || gameName==\"fqpls\")){\n            if(gameName==\"nn\"){\n                this.lb_gameName.string = \"妞妞\";\n            }else{\n                this.lb_gameName.string = \"十三支\";\n            }\n        }else{\n            this.lb_gameName.string = gametypeData.Name_1;\n        }\n        \n\n\n\n        this.downLoadProgressBar.progress = 0;\n        this.lb_progress.string = \"\";\n        this.btn_exit.active = false;\n        this.btn_cancle.active = false;\n        this.btn_downloadGame.active = false;\n        this.btn_updateGame.active = false;\n        this.btn_enterGame.active = false;\n        if(!cc.sys.isNative){\n            this.btn_exit.active = true;\n            return;\n        }\n        let that = this;\n        //判断子游戏有没有下载\n        if (SubgameManager.isSubgameDownLoad(gameName)) {\n            //已下载，判断是否需要更新\n            SubgameManager.needUpdateSubgame(gameName, (success) => {\n                if (success) {\n                    //子游戏需要更新;\n                    console.log(\"子游戏需要更新\");\n                    that.btn_exit.active = false;\n                    that.btn_cancle.active = true;\n                    that.btn_downloadGame.active = false;\n                    that.btn_updateGame.active = true;\n                    that.btn_enterGame.active = false;\n                } else {\n                    //子游戏不需要更新;\n                    console.log(\"子游戏不需要更新\");\n                    that.lb_progress.string = \"无需更新，直接进入游戏...\";\n                    that.btn_exit.active = false;\n                    that.btn_cancle.active = false;\n                    that.btn_downloadGame.active = false;\n                    that.btn_updateGame.active = false;\n                    that.btn_enterGame.active = false;\n                    if (that.isEnterGame) {\n                        app.Client.EnterSubGame(that.selectGameName,null,that.selectRoomKey);\n                        that.CloseForm();\n                    }else{\n                        app.Client.OnEvent('OnUpdateGameEnd', {});\n                        app.SysNotifyManager().ShowSysMsg(\"游戏更新完成\", [], 3);\n                        let clubDataTemp = null;\n                        if (that.clubId > 0) {\n                            clubDataTemp = {};\n                            clubDataTemp.clubId = that.clubId;\n                            clubDataTemp.password = that.password;\n                            clubDataTemp.existQuickJoin = that.existQuickJoin;\n                            clubDataTemp.roomKey = '0';\n                            clubDataTemp.gameIndex = 0;//用来判断保存还是创建\n                            clubDataTemp.enableGameType = '';//不禁用的按钮\n                        }\n                        app.FormManager().CloseForm('UIMoreGame');\n                        app.FormManager().CloseForm('UITop');\n                        app.FormManager().GetFormComponentByFormName(\"UITop\").RemoveCloseFormArr(\"UIMoreGame\");\n                        app.FormManager().ShowForm('UICreatRoom',{\"gameList\":app.Client.GetAllGameId()},gameName,clubDataTemp,that.unionData);\n                        that.CloseForm();\n                    }\n                    \n                }\n            }, () => {\n                console.log(\"子游戏更新失败\");\n                //下载失败如果已经下载了游戏，直接进。热更服有可能被攻击\n                that.btn_exit.active = false;\n                that.btn_cancle.active = false;\n                that.btn_downloadGame.active = false;\n                that.btn_updateGame.active = false;\n                that.btn_enterGame.active = false;\n                that.lb_progress.string = \"子游戏更新失败，直接进入游戏...\";\n                that.btn_exit.active = false;\n                that.btn_cancle.active = false;\n                that.btn_downloadGame.active = false;\n                that.btn_updateGame.active = false;\n                that.btn_enterGame.active = false;\n                if (that.isEnterGame) {\n                    app.Client.EnterSubGame(that.selectGameName,null,that.selectRoomKey);\n                }else{\n                    app.Client.OnEvent('OnUpdateGameEnd', {});\n                    app.SysNotifyManager().ShowSysMsg(\"子游戏更新失败...\", [], 3);\n                    let clubDataTemp = null;\n                    if (that.clubId > 0) {\n                        clubDataTemp = {};\n                        clubDataTemp.clubId = that.clubId;\n                        clubDataTemp.password = that.password;\n                        clubDataTemp.roomKey = '0';\n                        clubDataTemp.gameIndex = 0;//用来判断保存还是创建\n                        clubDataTemp.enableGameType = '';//不禁用的按钮\n                    }\n                    app.FormManager().CloseForm('UIMoreGame');\n                    app.FormManager().CloseForm('UITop');\n                    app.FormManager().GetFormComponentByFormName(\"UITop\").RemoveCloseFormArr(\"UIMoreGame\");\n                    app.FormManager().ShowForm('UICreatRoom',{\"gameList\":app.Client.GetAllGameId()},gameName,clubDataTemp,that.unionData);\n                    that.CloseForm();\n                }\n            });\n        }else{\n            //未下载\n            console.log(\"子游戏未下载\");\n            this.btn_exit.active = true;\n            this.btn_cancle.active = false;\n            this.btn_downloadGame.active = true;\n            this.btn_updateGame.active = false;\n            this.btn_enterGame.active = false;\n        }\n    },\n\n    //---------点击函数---------------------\n    OnClick:function(btnName, btnNode){\n        if (this.isDownLoading) {\n                this.ShowSysMsg(\"正在下载游戏...\");\n                return;\n            }\n        if(btnName == \"btn_exit\"){\n            this.CloseForm();\n        }\n        else if (btnName == \"btn_cancle\"){\n            this.CloseForm();\n        }\n        else if (btnName == \"btn_downloadGame\" || btnName == \"btn_updateGame\"){\n            this.CheckGameDown();\n            //this.DownloadSubgame(this.selectGameName, btnNode);\n        }\n        else if (btnName == \"btn_enterGame\"){\n            app.Client.EnterSubGame(this.selectGameName,null,that.selectRoomKey);\n        }\n        else{\n            this.ErrLog(\"OnClick(%s) not find\",btnName);\n        }\n    },\n    /*\n    * 检测子游戏是否可以下载\n    */\n    CheckGameDown:function(){\n        if (!SubgameManager.UIRLFILE_root || SubgameManager.UIRLFILE_root.length < 2) {\n            SubgameManager.UIRLFILE_root = app.Client.GetClientConfigProperty(\"UpdateGame\")\n        }\n        let checkUrl= SubgameManager.UIRLFILE_root + this.selectGameName+\"/remote-assets/version.manifest\";\n        console.log(\"检查子游戏下载地址: \" + checkUrl);\n        let file = (jsb.fileUtils ? jsb.fileUtils.getWritablePath() : '/') +'hall/checkdown.manifest';\n        this.downFile2Local(checkUrl,file);\n    },\n\n    downFile2Local:function(url, fileName){\n        let self=this;\n        var downloader = new jsb.Downloader();\n        downloader.setOnFileTaskSuccess(function(){\n            console.log(\"downFile2Local: version.manifest  is down success\");    \n            self.DownloadSubgame(self.selectGameName,{});\n        });\n        downloader.setOnTaskError(function(){ \n            app.SysNotifyManager().ShowSysMsg(\"更新文件获取失败，检查您的手机网络，稍后重试\");\n        });\n        downloader.createDownloadFileTask(url, fileName);//创建下载任务\n    },\n\n    DownloadSubgame:function(name,btnNode){\n        this.btn_exit.active = false;\n        this.btn_cancle.active = false;\n        this.btn_downloadGame.active = false;\n        this.btn_updateGame.active = false;\n        this.btn_enterGame.active = false;\n        //下载子游戏/更新子游戏\n        if(!cc.sys.isNative) return;\n        let that = this;\n        SubgameManager.downloadSubgame(name, (progress,downloadedBytes,totalBytes) => {\n            if (isNaN(progress)) {\n                progress = 0;\n            }\n            that.isDownLoading = true;\n            that.downLoadProgressBar.progress = progress;\n            console.log(\"downloadedBytes == \" + downloadedBytes + \",totalBytes == \" + totalBytes);\n            if (downloadedBytes > 0 && (downloadedBytes + 1000) >= totalBytes) {\n                console.log(\"资源下载完成\");\n                that.lb_progress.string = \"游戏正在安装，请稍后\";\n            }else{\n                that.lb_progress.string = \"下载中 \" + parseInt(progress * 100) + \"%\";\n            }\n        }, function(success) {\n            that.isDownLoading = false;\n            if (success) {\n                that.downLoadProgressBar.progress = 1;\n                that.lb_progress.string = \"下载完成\";\n                let curGameList = app.Client.GetAllGameId();\n                let argDict = {\n                    \"gameList\":curGameList,\n                };\n                app.Client.OnEvent(\"ShowGameListByLocation\", argDict);\n                that.EnterSubGameByType(name);\n            } else {\n                console.log('下载失败');\n                app.SysNotifyManager().ShowSysMsg(\"下载游戏失败...\", [], 3);\n                that.btn_exit.active = true;\n                that.btn_cancle.active = false;\n                that.btn_downloadGame.active = true;\n                that.btn_updateGame.active = false;\n                that.btn_enterGame.active = false;\n                //下载失败如果已经下载了游戏，直接进。热更服有可能被攻击\n                if (SubgameManager.isSubgameDownLoad(that.selectGameName)) {\n                    that.EnterSubGameByType(name);\n                }\n            }\n        });\n    },\n    EnterSubGameByType:function(name){\n        let that = this;\n        if (that.practiceId != 0) {\n            that.btn_exit.active = false;\n            that.btn_downloadGame.active = false;\n            that.btn_updateGame.active = false;\n            that.btn_enterGame.active = false;\n            app.NetManager().SendPack(\"room.CBaseGoldRoom\", {\"practiceId\":that.practiceId}, function(event){\n                that.CloseForm();\n                let gameType = event.gameType;\n                name = app.ShareDefine().GametTypeID2PinYin[gameType];\n                app.Client.EnterSubGame(name,null,that.selectRoomKey);\n            }, function(event){\n                console.log(\"进入房间失败...\");\n                that.CloseForm();\n            });\n            return;\n        }\n        if (that.selectRoomKey != 0) {\n            that.btn_exit.active = false;\n            that.btn_downloadGame.active = false;\n            that.btn_updateGame.active = false;\n            that.btn_enterGame.active = false;\n            if(that.haveEnterFunction){\n                that.CloseForm();\n                that.haveEnterFunction();\n                return;\n            }\n            if(this.isChangeRoom==false){\n                app.NetManager().SendPack(\"room.CBaseEnterRoom\", {\"roomKey\":that.selectRoomKey,\"posID\":-1,\"clubId\":that.clubId,\"password\":that.password,\"existQuickJoin\":that.existQuickJoin}, function(event){\n                    that.CloseForm();\n                    //app.SysNotifyManager().ShowSysMsg(\"加入房间成功\", [], 3);\n                }, function(event){\n                    console.log(\"进入房间失败...\");\n                    that.CloseForm();\n                });\n            }else{\n                app.NetManager().SendPack(\"room.CBaseChangeRoom\", {\"roomKey\":that.selectRoomKey,\"posID\":-1,\"clubId\":that.clubId,\"password\":that.password,\"existQuickJoin\":that.existQuickJoin}, function(event){\n                    that.CloseForm();\n                }, function(event){\n                    console.log(\"进入房间失败...\");\n                    that.CloseForm();\n                });\n            }\n            return;\n        }\n        if (that.playBackCode != 0) {\n            that.CloseForm();\n            that.btn_exit.active = false;\n            that.btn_enterGame.active = false;\n            let videoData = {action:\"showVideo\", backCode:that.playBackCode};\n            app.Client.EnterSubGame(name, videoData);\n            return;\n        }\n        if (that.createRoomSendPack != null) {\n            that.btn_exit.active = false;\n            that.btn_downloadGame.active = false;\n            that.btn_updateGame.active = false;\n            that.btn_enterGame.active = false;\n            if (that.createRoomSendPack.clubId && that.createRoomSendPack.clubId != 0) {\n                app.NetManager().SendPack(\"club.CClubCreateRoom\", that.createRoomSendPack, function(event){\n                    console.log(\"创建房间成功\");\n                }, function(event){\n                    console.log(\"创建房间失败\");\n                });\n                that.CloseForm();\n            }else{\n                app.NetManager().SendPack(\"room.CBaseCreateRoom\", that.createRoomSendPack, function(event){\n                    that.CloseForm();\n                }, function(event){\n                    that.CloseForm();\n                });\n            }\n            return;\n        }\n        if (that.isEnterGame) {\n            app.Client.EnterSubGame(that.selectGameName,null,that.selectRoomKey);\n            return;\n        }else{\n            app.Client.OnEvent('OnUpdateGameEnd', {});\n            app.SysNotifyManager().ShowSysMsg(\"游戏更新完成\", [], 3);\n            let clubDataTemp = null;\n            if (that.clubId > 0) {\n                clubDataTemp = {};\n                clubDataTemp.clubId = that.clubId;\n                clubDataTemp.roomKey = '0';\n                clubDataTemp.gameIndex = 0;//用来判断保存还是创建\n                clubDataTemp.enableGameType = '';//不禁用的按钮\n            }\n            app.FormManager().CloseForm('UIMoreGame');\n            app.FormManager().CloseForm('UITop');\n            app.FormManager().GetFormComponentByFormName(\"UITop\").RemoveCloseFormArr(\"UIMoreGame\");\n            app.FormManager().ShowForm('UICreatRoom',{\"gameList\":app.Client.GetAllGameId()},name,clubDataTemp,that.unionData);\n            that.CloseForm();\n            return;\n        }\n    },\n\tClick_Btn_EnterGame:function () {\n        let msgID = \"MSG_Enter_GAME\";\n        let ConfirmManager = app.ConfirmManager();\n        ConfirmManager.SetWaitForConfirmForm(this.OnConFirm.bind(this), msgID, []);\n        ConfirmManager.ShowConfirm(this.ShareDefine.Confirm, msgID, []);\n    },\n\n    /**\n     * 2次确认点击回调\n     * @param curEventType\n     * @param curArgList\n     */\n    OnConFirm:function(clickType, msgID, backArgList){\n        if(clickType != \"Sure\"){\n            return\n        }\n        if(msgID == \"MSG_Enter_GAME\"){\n            \n        }\n        else if(\"MSG_EXIT_GAME\")\n            cc.game.end();\n    },\n});"]}