{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\script\\ui\\club\\unionChildren/assets\\script\\ui\\club\\unionChildren\\btn_ForbidTableNode.js"],"names":["app","require","cc","Class","extends","Component","properties","onLoad","ComTool","Client","RegEvent","Event_UnionForbidReShow","GetUnionForbidList","InitData","clubId","unionId","unionPostType","isRefresh","pidOne","pidTwo","sendPack","ClubManager","GetUnionSendPackHead","self","NetManager","SendPack","serverPack","UpdateScrollView","SysNotifyManager","ShowSysMsg","forbidScrollView","node","getChildByName","content","getComponent","ScrollView","scrollToTop","removeAllChildren","demo","active","i","length","nodePrefab","instantiate","name","groupingId","Label","string","groupingSize","j","playerList","usernode","heroID","headImageUrl","GetBeiZhuName","i18n","t","GetPid","WeChatHeadImage","OnLoad","WeChatManager","InitHeroHeadImage","pid","ShowHeroHead","addChild","OnClick_BtnWnd","eventTouch","eventData","SoundManager","PlaySound","btnNode","currentTarget","btnName","OnClick","error","console","log","stack","FormManager","ShowForm","pid1","EditBox","pid2"],"mappings":"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","file":"btn_ForbidTableNode.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\script\\ui\\club\\unionChildren","sourcesContent":["var app = require(\"app\");\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n\n    },\n    onLoad:function(){\n        this.ComTool=app.ComTool();\n        app.Client.RegEvent('OnUnionForbidReShow',this.Event_UnionForbidReShow,this);\n    \t// let forbidScrollView = this.node.getChildByName(\"forbidScrollView\").getComponent(cc.ScrollView);\n     //    forbidScrollView.node.on('scroll-to-bottom',this.GetNextPage,this);\n    },\n    Event_UnionForbidReShow:function(){\n        this.GetUnionForbidList(true);\n    },\n    InitData:function (clubId, unionId, unionPostType) {\n        this.clubId = clubId;\n        this.unionId = unionId;\n        this.unionPostType = unionPostType;\n        // this.curPage = 1;\n        this.GetUnionForbidList(true);\n    },\n    // GetNextPage:function(){\n    // \tthis.curPage++;\n    // \tthis.GetUnionForbidList(false);\n    // },\n    GetUnionForbidList:function(isRefresh,pidOne='',pidTwo=''){\n    \tlet sendPack = app.ClubManager().GetUnionSendPackHead();\n    \t// sendPack.pageNum = this.curPage;\n        sendPack.pidOne=pidOne;\n        sendPack.pidTwo=pidTwo;\n        let self = this;\n        app.NetManager().SendPack(\"union.CUnionGroupingList\",sendPack, function(serverPack){\n            self.UpdateScrollView(serverPack, isRefresh);\n        }, function(){\n            app.SysNotifyManager().ShowSysMsg(\"获取列表失败\",[],3);\n        });\n    },\n\n    UpdateScrollView:function(serverPack, isRefresh){\n    \tlet forbidScrollView = this.node.getChildByName(\"forbidScrollView\");\n    \tlet content = forbidScrollView.getChildByName(\"view\").getChildByName(\"content\");\n    \tif (isRefresh) {\n    \t\tforbidScrollView.getComponent(cc.ScrollView).scrollToTop();\n    \t\tcontent.removeAllChildren();\n    \t}\n    \tlet demo = this.node.getChildByName(\"demo\");\n    \tdemo.active = false;\n    \tfor (let i = 0; i < serverPack.length; i++) {\n    \t\tlet nodePrefab = cc.instantiate(demo);\n    \t\tnodePrefab.name=\"forbid_\"+serverPack[i].groupingId;\n            nodePrefab.getChildByName('renshu').getChildByName('lb').getComponent(cc.Label).string=(i+1)+\"限制人数：\"+serverPack[i].groupingSize+\"斜15\";\n            nodePrefab.groupingId=serverPack[i].groupingId;\n            nodePrefab.getChildByName('layout').getChildByName('user1').active=false;\n            nodePrefab.getChildByName('layout').getChildByName('user2').active=false;\n            nodePrefab.getChildByName('layout').getChildByName('btn_set_forbit').groupingId=serverPack[i].groupingId;\n\n            nodePrefab.getChildByName('btn_set_forbit').groupingId=serverPack[i].groupingId;\n            nodePrefab.getChildByName('btn_del_forbit').groupingId=serverPack[i].groupingId;\n\n            nodePrefab.active=true;\n            for(let j=0;j<serverPack[i].playerList.length;j++){\n                let usernode=nodePrefab.getChildByName('layout').getChildByName('user'+(j+1));\n                usernode.active=true;\n                let heroID = serverPack[i].playerList[j][\"pid\"];\n                let headImageUrl = serverPack[i].playerList[j][\"iconUrl\"];\n\n                usernode.getChildByName('name').getComponent(cc.Label).string= this.ComTool.GetBeiZhuName(heroID,serverPack[i].playerList[j].name);\n\n                usernode.getChildByName('id').getComponent(cc.Label).string=app.i18n.t(\"UIMain_PIDText\",{\"pid\":app.ComTool().GetPid(heroID)});\n                let WeChatHeadImage = usernode.getChildByName('head').getChildByName('img').getComponent(\"WeChatHeadImage\");\n                WeChatHeadImage.OnLoad();\n                //用户头像创建\n                if(heroID && headImageUrl){\n                    app.WeChatManager().InitHeroHeadImage(heroID, headImageUrl);\n                }\n                usernode.getChildByName('btn_forbit_del_user').pid=heroID;\n                usernode.getChildByName('btn_forbit_del_user').groupingId=serverPack[i].groupingId;\n                        WeChatHeadImage.ShowHeroHead(heroID,headImageUrl);\n            }\n    \t\tcontent.addChild(nodePrefab);\n    \t}\n    },\n    //控件点击回调\n    OnClick_BtnWnd:function(eventTouch, eventData){\n        try{\n            app.SoundManager().PlaySound(\"BtnClick\");\n            let btnNode = eventTouch.currentTarget;\n            let btnName = btnNode.name;\n            this.OnClick(btnName, btnNode);\n        }\n        catch (error){\n            console.log(\"OnClick_BtnWnd:\"+error.stack);\n        }\n    },\n    OnClick:function(btnName, btnNode){\n        let self = this;\n        let sendPack = app.ClubManager().GetUnionSendPackHead();\n        if('btn_addForbid'==btnName){\n            app.NetManager().SendPack(\"union.CUnionGroupingAdd\",sendPack, function(serverPack){\n                self.GetUnionForbidList(true);\n            }, function(){\n\n            });\n        }else if('btn_del_forbit'==btnName){\n            sendPack.groupingId = btnNode.groupingId;\n            app.NetManager().SendPack('union.CUnionGroupingRemove',sendPack, function(serverPack){\n                self.GetUnionForbidList(true);\n            }, function(){\n\n            });\n        }else if('btn_forbit_del_user'==btnName){\n            sendPack.groupingId = btnNode.groupingId;\n            sendPack.pid = btnNode.pid;\n            app.NetManager().SendPack('union.CUnionGroupingPidRemove',sendPack, function(serverPack){\n                self.GetUnionForbidList(true);\n            }, function(){\n\n            });\n        }else if('btn_set_forbit'==btnName){\n            app.FormManager().ShowForm('ui/club/UIForbidUserList',this.clubId,btnNode.groupingId,this.unionId);\n        }else if('btn_ForbidSearch'==btnName){\n            let pid1=this.node.getChildByName(\"EditBoxForbid1\").getComponent(cc.EditBox).string;\n            let pid2=this.node.getChildByName(\"EditBoxForbid2\").getComponent(cc.EditBox).string;\n            if(pid1!='' || pid2!=''){\n                this.GetUnionForbidList(true,pid1,pid2);\n            }\n        }\n    },\n});"]}