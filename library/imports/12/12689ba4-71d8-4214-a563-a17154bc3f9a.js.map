{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\script\\dbmanager\\PlayerFamily/assets\\script\\dbmanager\\PlayerFamily\\PlayerFamilyManager.js"],"names":["app","require","PlayerFamilyManager","BaseClass","extend","Init","JS_Name","NetManager","OnReload","RegNetPack","OnPack_InitPlayerFamily","OnPack_PlayerFamilyInfo","Log","dataInfo","serverPack","Client","OnEvent","familyID","GetPlayerFamilyProperty","FamilyManager","SendGetFamilyInfo","ClearFamilyInfo","SetPlayerFamilyProperty","property","value","hasOwnProperty","ErrLog","GetFamilyDataInfo","SendJoinFamily","SendPack","SendInitPlayerFamily","g_PlayerFamilyManager","exports","GetModel"],"mappings":";;;;;;AAAA;;;AAGA,IAAIA,MAAMC,QAAQ,KAAR,CAAV;;AAEA,IAAIC,sBAAsBF,IAAIG,SAAJ,CAAcC,MAAd,CAAqB;;AAE9CC,OAAK,gBAAU;AACd,OAAKC,OAAL,GAAe,qBAAf;;AAEA,OAAKC,UAAL,GAAkBP,IAAIO,UAAJ,EAAlB;;AAEA,OAAKC,QAAL;;AAEA,OAAKD,UAAL,CAAgBE,UAAhB,CAA2B,8BAA3B,EAA2D,KAAKC,uBAAhE,EAAyF,IAAzF;;AAEA;AACA,OAAKH,UAAL,CAAgBE,UAAhB,CAA2B,wBAA3B,EAAqD,KAAKE,uBAA1D,EAAmF,IAAnF;;AAEA,OAAKC,GAAL,CAAS,MAAT;AACA,EAf6C;;AAiB9C;AACAJ,WAAS,oBAAU;;AAElB;AACA;AACA;AACA;AACA,OAAKK,QAAL,GAAgB,EAAhB;AAEA,EA1B6C;;AA4B9C;AACAH,0BAAwB,iCAASI,UAAT,EAAoB;AAC3C,OAAKH,uBAAL,CAA6BG,UAA7B;AACAd,MAAIe,MAAJ,CAAWC,OAAX,CAAmB,kBAAnB,EAAuC,EAAvC;AACA,EAhC6C;;AAkC9C;AACAL,0BAAwB,iCAASG,UAAT,EAAoB;;AAE3C;AACA,OAAKD,QAAL,GAAgBC,UAAhB;;AAEA,MAAIG,WAAW,KAAKC,uBAAL,CAA6B,UAA7B,CAAf;AACA;AACA,MAAGD,QAAH,EAAY;AACXjB,OAAImB,aAAJ,GAAoBC,iBAApB;AACA,GAFD,MAGI;AACHpB,OAAImB,aAAJ,GAAoBE,eAApB;AACA;;AAEDrB,MAAIe,MAAJ,CAAWC,OAAX,CAAmB,kBAAnB,EAAuC,EAAvC;AACA,EAlD6C;;AAoD9C;AACAM,0BAAwB,iCAASC,QAAT,EAAmBC,KAAnB,EAAyB;AAChD,MAAG,CAAC,KAAKX,QAAL,CAAcY,cAAd,CAA6BF,QAA7B,CAAJ,EAA2C;AAC1C,QAAKG,MAAL,CAAY,qCAAZ,EAAkDH,QAAlD;AACA;AACA;AACD,OAAKV,QAAL,CAAcU,QAAd,IAA0BC,KAA1B;AACA,EA3D6C;AA4D9C;AACAN,0BAAwB,iCAASK,QAAT,EAAkB;AACzC,MAAG,CAAC,KAAKV,QAAL,CAAcY,cAAd,CAA6BF,QAA7B,CAAJ,EAA2C;AAC1C,QAAKG,MAAL,CAAY,qCAAZ,EAAkDH,QAAlD;AACA;AACA;AACD,SAAO,KAAKV,QAAL,CAAcU,QAAd,CAAP;AACA,EAnE6C;;AAqE9CI,oBAAkB,6BAAY;AAC7B,SAAO,KAAKd,QAAZ;AACA,EAvE6C;;AAyE9C;AACA;AACAe,iBAAe,wBAASX,QAAT,EAAkB;AAChC,OAAKV,UAAL,CAAgBsB,QAAhB,CAAyB,wBAAzB,EAAmD,EAAC,YAAWZ,QAAZ,EAAnD;AACA,EA7E6C;;AA+E9C;AACAa,uBAAqB,gCAAU;AAC9B,OAAKvB,UAAL,CAAgBsB,QAAhB,CAAyB,8BAAzB,EAAyD,EAAzD;AACA;;AAlF6C,CAArB,CAA1B;;AAuFA,IAAIE,wBAAwB,IAA5B;;AAEA;;;AAGAC,QAAQC,QAAR,GAAmB,YAAU;AAC5B,KAAG,CAACF,qBAAJ,EAA0B;AACzBA,0BAAwB,IAAI7B,mBAAJ,EAAxB;AACA;AACD,QAAO6B,qBAAP;AACA,CALD","file":"PlayerFamilyManager.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\script\\dbmanager\\PlayerFamily","sourcesContent":["/*\n PlayerFamilyManager 玩家工会ID管理器\n */\nvar app = require('app');\n\nvar PlayerFamilyManager = app.BaseClass.extend({\n\n\tInit:function(){\n\t\tthis.JS_Name = \"PlayerFamilyManager\";\n\n\t\tthis.NetManager = app.NetManager();\n\n\t\tthis.OnReload();\n\n\t\tthis.NetManager.RegNetPack(\"family.C2119InitPlayerFamily\", this.OnPack_InitPlayerFamily, this);\n\n\t\t//服务器推送\n\t\tthis.NetManager.RegNetPack(\"S2119_InitPlayerFamily\", this.OnPack_PlayerFamilyInfo, this);\n\n\t\tthis.Log(\"Init\");\n\t},\n\n\t//切换账号\n\tOnReload:function(){\n\n\t\t//{\n\t\t//\t\"familyID\":1000,\n\t\t//\t...\n\t\t//}\n\t\tthis.dataInfo = {}\n\n\t},\n\n\t//-----------事件回调----------------\n\tOnPack_InitPlayerFamily:function(serverPack){\n\t\tthis.OnPack_PlayerFamilyInfo(serverPack);\n\t\tapp.Client.OnEvent(\"InitPlayerFamily\", {});\n\t},\n\n\t//------------封包函数------------------\n\tOnPack_PlayerFamilyInfo:function(serverPack){\n\n\t\t//初始化玩家工会字典\n\t\tthis.dataInfo = serverPack;\n\n\t\tlet familyID = this.GetPlayerFamilyProperty(\"familyID\");\n\t\t//如果工会ID变化,申请工会数据\n\t\tif(familyID){\n\t\t\tapp.FamilyManager().SendGetFamilyInfo();\n\t\t}\n\t\telse{\n\t\t\tapp.FamilyManager().ClearFamilyInfo();\n\t\t}\n\n\t\tapp.Client.OnEvent(\"PlayerFamilyInfo\", {});\n\t},\n\n\t//-------------设置接口---------------------\n\tSetPlayerFamilyProperty:function(property, value){\n\t\tif(!this.dataInfo.hasOwnProperty(property)){\n\t\t\tthis.ErrLog(\"SetPlayerFamilyProperty not find:%s\",property);\n\t\t\treturn\n\t\t}\n\t\tthis.dataInfo[property] = value;\n\t},\n\t//--------------获取接口------------------------\n\tGetPlayerFamilyProperty:function(property){\n\t\tif(!this.dataInfo.hasOwnProperty(property)){\n\t\t\tthis.ErrLog(\"GetPlayerFamilyProperty not find:%s\",property);\n\t\t\treturn\n\t\t}\n\t\treturn this.dataInfo[property];\n\t},\n\n\tGetFamilyDataInfo:function () {\n\t\treturn this.dataInfo;\n\t},\n\n\t//---------------发包接口------------------------\n\t//发送请求初始化管理器数据\n\tSendJoinFamily:function(familyID){\n\t\tthis.NetManager.SendPack(\"family.C2116JoinFamily\", {\"familyID\":familyID});\n\t},\n\n\t//发送请求玩家工会数据\n\tSendInitPlayerFamily:function(){\n\t\tthis.NetManager.SendPack(\"family.C2119InitPlayerFamily\", {});\n\t},\n\n});\n\n\nvar g_PlayerFamilyManager = null;\n\n/**\n * 绑定模块外部方法\n */\nexports.GetModel = function(){\n\tif(!g_PlayerFamilyManager){\n\t\tg_PlayerFamilyManager = new PlayerFamilyManager();\n\t}\n\treturn g_PlayerFamilyManager;\n}"]}