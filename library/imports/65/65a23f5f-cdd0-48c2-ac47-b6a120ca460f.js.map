{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\script\\ui/assets\\script\\ui\\UIShare.js"],"names":["app","require","cc","Class","extends","properties","OnCreateInit","NetManager","RegEvent","Event_ShareSuccess","ShareType","btn_py","GetWndNode","btn_pyq","btn_lineShareLink","ShowShareBtn","OnShow","appName","GetAppName","isShowLineShare","active","event","that","SendPack","success","SysNotifyManager","ShowSysMsg","error","OnClick","btnName","btnNode","title","Client","GetClientConfigProperty","desc","weChatAppShareUrl","heroID","HeroManager","GetHeroProperty","cityId","Config","share","length","SDKManager","Share","console","log","ShareLineLink","ShareFacebookLink","ShareFacebookImage"],"mappings":"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","file":"UIShare.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\ui","sourcesContent":["var app = require(\"app\");\n\ncc.Class({\n    extends: require(\"BaseForm\"),\n\n    properties: {\n\n    },\n    OnCreateInit: function () {\n        this.NetManager = app.NetManager();\n        this.RegEvent(\"ShareSuccess\", this.Event_ShareSuccess, this);\n        this.ShareType = -1;\n\n        this.btn_py = this.GetWndNode(\"bg_create/btn_py\");//微信分享\n        this.btn_pyq = this.GetWndNode(\"bg_create/btn_pyq\"); // 朋友圈\n        this.btn_lineShareLink = this.GetWndNode(\"bg_create/btn_lineShareLink\"); // line 分享 宝岛 大联盟棋牌\n        // 分享按钮\n        this.ShowShareBtn();\n    },\n\n    OnShow: function () {\n        // this.NetManager.SendPack(\"game.CPlayerRebate\",{},function(success){},function(error){\n        //     app.SysNotifyManager().ShowSysMsg(\"系统数据获取出错，请稍后重试\");\n        // });\n    },\n\n    ShowShareBtn: function () {\n        let appName = this.GetAppName();\n        let isShowLineShare = appName == \"baodao\";\n        \n        this.btn_py.active = !isShowLineShare;\n        this.btn_pyq.active = !isShowLineShare;\n        \n        this.btn_lineShareLink.active = isShowLineShare;\n    },\n\n    Event_ShareSuccess: function (event) {\n        if (this.ShareType == 1) {\n            let that = this;\n            this.NetManager.SendPack(\"game.CPlayerReceiveShare\", {}, function (success) {\n                app.SysNotifyManager().ShowSysMsg(\"分享成功获取2个钻石\");\n            }, function (error) {\n                app.SysNotifyManager().ShowSysMsg(\"您今日已经领取过钻石\");\n            });\n        }\n    },\n\n    OnClick: function (btnName, btnNode) {\n        if ('btn_py' == btnName) {\n            let title = app.Client.GetClientConfigProperty(\"WeChatShareTitle\");\n            let desc = app.Client.GetClientConfigProperty(\"WeChatShareDesc\");\n            let weChatAppShareUrl = app.Client.GetClientConfigProperty(\"WeChatAppShareUrl\");\n            let heroID = app.HeroManager().GetHeroProperty(\"pid\");\n            let cityId = app.HeroManager().GetHeroProperty(\"cityId\");\n            weChatAppShareUrl = weChatAppShareUrl + heroID + \"&cityid=\" + cityId;\n            if (app.Config.share && app.Config.share.length > 3) {\n                weChatAppShareUrl = app.Config.share\n            }\n            this.ShareType = 0;\n            this.SDKManager.Share(title, desc, weChatAppShareUrl, \"0\");\n        }\n        else if ('btn_pyq' == btnName) {\n            let title = app.Client.GetClientConfigProperty(\"WeChatShareTitle\");\n            let desc = app.Client.GetClientConfigProperty(\"WeChatShareDesc\");\n            let weChatAppShareUrl = app.Client.GetClientConfigProperty(\"WeChatAppShareUrl\");\n            let heroID = app.HeroManager().GetHeroProperty(\"pid\");\n            let cityId = app.HeroManager().GetHeroProperty(\"cityId\");\n            weChatAppShareUrl = weChatAppShareUrl + heroID + \"&cityid=\" + cityId;\n            if (app.Config.share && app.Config.share.length > 3) {\n                weChatAppShareUrl = app.Config.share\n            }\n            this.ShareType = 1;\n            // app.FormManager().ShowForm(\"UIShareImg\");\n            this.SDKManager.Share(title, desc, weChatAppShareUrl, \"1\");\n        }\n        else if ('btn_lineShareLink' == btnName) {\n            let title = app.Client.GetClientConfigProperty(\"WeChatShareTitle\");\n            let desc = app.Client.GetClientConfigProperty(\"WeChatShareDesc\");\n            let weChatAppShareUrl = app.Client.GetClientConfigProperty(\"WeChatAppShareUrl\");\n            console.log(\"Click_btn_line: cfg weChatAppShareUrl: \", weChatAppShareUrl);\n            let heroID = app.HeroManager().GetHeroProperty(\"pid\");\n            console.log(\"Click_btn_line: heroID: \", heroID);\n            let cityId = app.HeroManager().GetHeroProperty(\"cityId\");\n            weChatAppShareUrl = weChatAppShareUrl + heroID + \"&cityid=\" + cityId;\n            console.log(\"Click_btn_line:\", title);\n            console.log(\"Click_btn_line:\", desc);\n            console.log(\"Click_btn_line:\", weChatAppShareUrl);\n\n            this.SDKManager.ShareLineLink(title, desc, weChatAppShareUrl);\n        }\n        else if ('btn_lineShareImage' == btnName) {\n            // this.SDKManager.ShareScreenLine(); // 目前没用到\n        }\n        else if ('btn_facebookShareLink' == btnName) {\n            let title = app.Client.GetClientConfigProperty(\"WeChatShareTitle\");\n            let desc = app.Client.GetClientConfigProperty(\"WeChatShareDesc\");\n            let weChatAppShareUrl = app.Client.GetClientConfigProperty(\"WeChatAppShareUrl\");\n            console.log(\"Click_btn_facebook: cfg weChatAppShareUrl: \", weChatAppShareUrl);\n            let heroID = app.HeroManager().GetHeroProperty(\"pid\");\n            console.log(\"Click_btn_facebook: heroID: \", heroID);\n            let cityId = app.HeroManager().GetHeroProperty(\"cityId\");\n            weChatAppShareUrl = weChatAppShareUrl + heroID + \"&cityid=\" + cityId;\n            console.log(\"Click_btn_facebook:\", title);\n            console.log(\"Click_btn_facebook:\", desc);\n            console.log(\"Click_btn_facebook:\", weChatAppShareUrl);\n            \n            this.SDKManager.ShareFacebookLink(title, desc, weChatAppShareUrl);\n        }\n        else if ('btn_facebookShareImage' == btnName) {// 调试分享            \n            this.SDKManager.ShareFacebookImage();\n        }\n\n    },\n    // update (dt) {},\n});\n"]}