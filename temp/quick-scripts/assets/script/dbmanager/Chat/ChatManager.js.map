{"version":3,"sources":["ChatManager.js"],"names":["app","require","ChatManager","BaseClass","extend","Init","JS_Name","SysDataManager","NetManager","ShareDefine","ComTool","SysNotifyManager","RegNetPack","OnPack_ChatMessage","defaultEnterChannelList","ChatType_World","ChatType_System","InitChatData","OnReload","systemChatDict","allHeroInfo","worldChatDict","allChatInfo","serverPack","console","log","Client","OnEvent","GetChatChannelDataDict","chatType","userData","chatDict","GetChatInfoByChatID","chatID","hasOwnProperty","ErrLog","GetChatHeroInfo","heroID","GetBaseByQuickId","quickID","playerSex","content","soundName","path","i18n","t","join","data","g_ChatManager","exports","GetModel"],"mappings":"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","file":"ChatManager.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\script\\dbmanager\\Chat","sourcesContent":["/*\n * \tChatManager.js\n * \t聊天管理器\n *\n *\tauthor:cyh\n *\tdate:2017-01-09\n *\tversion:1.0\n *\n * 修改时间 修改人 修改内容:\n *\n *\n */\nvar app = require('app');\n\n\n/*\n * 类方法定义\n */\nvar ChatManager = app.BaseClass.extend({\n\n\t/**\n\t *  初始化\n\t */\n\tInit: function () {\n\t\tthis.JS_Name = \"ChatManager\";\n\t\tthis.SysDataManager = app.SysDataManager();\n\t\tthis.NetManager = app.NetManager();\n\t\tthis.ShareDefine = app.ShareDefine();\n\t\tthis.ComTool = app.ComTool();\n\t\tthis.SysNotifyManager = app.SysNotifyManager();\n\n\t\tthis.NetManager.RegNetPack(\"chatmessage\", this.OnPack_ChatMessage, this);\n\n\t\t//默认加入的频道\n\t\tthis.defaultEnterChannelList = [\n\t\t\t\t\t\t\t\t\t\t\t{\"ChatType\":this.ShareDefine.ChatType_World, \"UserData\":0},\n\t\t\t\t\t\t\t\t\t\t\t{\"ChatType\":this.ShareDefine.ChatType_System, \"UserData\":0}\n\t\t\t\t\t\t\t\t\t\t];\n\n\n\t\tthis.InitChatData();\n\n\t\tthis.OnReload();\n\t},\n\n\t//初始化聊天数据\n\tInitChatData: function(){\n\n\t\t//系统聊天频道\n\t\t//{\n\t\t//\tchatID:{},\n\t\t//}\n\t\tthis.systemChatDict = {};\n\n\t\t//{\n\t\t//\theroID:{\n\t\t//\t\t\t\"HeroName\":\"xx\",\n\t\t//\t\t\t\"VipLv\":0,\n\t\t//\t\t\t\"HeroLv\":100,\n\t\t//\t\t\t\"IconGeneralID\":0,\n\t\t//\t}\n\t\t//}\n\t\tthis.allHeroInfo = {};\n\n\t\t// 世界聊天记录字典\n\t\t//{\n\t\t//\tchatID:{},\n\t\t//}\n\t\tthis.worldChatDict = {};\n\n\n\t\tthis.allChatInfo = {};\n\t},\n\t//--------------回调接口----------------------------\n\t/**\n\t * 重登清理\n\t * @param {}\n\t * @return {}\n\t * @remarks {}\n\t */\n\tOnReload: function () {\n\n\t},\n\t//-----------------收包接口------------------------\n\tOnPack_ChatMessage:function (serverPack) {\n\t   console.log(\"serverPack:\"+serverPack);\n\t\tapp.Client.OnEvent(\"ChatMessage\", serverPack);\n\t},\n\n\n\t//-----------------获取接口--------------------\n\tGetChatChannelDataDict: function(chatType, userData){\n\t\tvar chatDict = {};\n\n\t\tif(chatType == this.ShareDefine.ChatType_World){\n\t\t\tchatDict = this.worldChatDict;\n\t\t}\n\n\t\treturn chatDict\n\t},\n\n\n\tGetChatInfoByChatID:function(chatID){\n\t\t//不存在\n\t\tif(!this.allChatInfo.hasOwnProperty(chatID)){\n\t\t\tthis.ErrLog(\"GetChatInfoByChatID not find:{1}\", chatID);\n\t\t\treturn\n\t\t}\n\n\t\treturn this.allChatInfo[chatID];\n\t},\n\n\tGetChatHeroInfo:function(heroID){\n\t\tif(!this.allHeroInfo.hasOwnProperty(heroID)){\n\t\t\tthis.ErrLog(\"GetChatHeroInfo not find heroID:%s\", heroID);\n\t\t\treturn false\n\t\t}\n\n\t\treturn this.allHeroInfo[heroID];\n\t},\n\tGetBaseByQuickId:function(quickID,playerSex,content){\n\t\tlet soundName = '';\n\t\tlet path = '';\n\t\tif(quickID < 101){\n            switch (quickID){\n                case 1:\n                    content = app.i18n.t(\"UIVoiceStringBieChao\");\n                    soundName = [playerSex,\"_FastVoice_1\"].join(\"\");\n                    break;\n                case 2:\n                    content = app.i18n.t(\"UIVoiceStringBieZou\");\n                    soundName = [playerSex,\"_FastVoice_2\"].join(\"\");\n                    break;\n                case 3:\n                    content = app.i18n.t(\"UIVoiceStringZhaoHu\");\n                    soundName = [playerSex,\"_FastVoice_3\"].join(\"\");\n                    break;\n                case 4:\n                    content = app.i18n.t(\"UIVoiceStringZanLi\");\n                    soundName = [playerSex,\"_FastVoice_4\"].join(\"\");\n                    break;\n                case 5:\n                    content = app.i18n.t(\"UIVoiceStringZanShang\");\n                    soundName = [playerSex,\"_FastVoice_5\"].join(\"\");\n                    break;\n                case 6:\n                    content = app.i18n.t(\"UIVoiceStringCuiCu\");\n                    soundName = [playerSex,\"_FastVoice_6\"].join(\"\");\n                    break;\n                case 7:\n                    content = app.i18n.t(\"UIVoiceStringKuaJiang\");\n                    soundName = [playerSex,\"_FastVoice_7\"].join(\"\");\n                    break;\n                case 8:\n                    content = app.i18n.t(\"UIVoiceStringDaShang\");\n                    soundName = [playerSex,\"_FastVoice_8\"].join(\"\");\n                    break;\n                case 9:\n                    content = app.i18n.t(\"UIVoiceStringLiKai\");\n                    soundName = [playerSex,\"_FastVoice_9\"].join(\"\");\n                    break;\n                case 10:\n                    content = app.i18n.t(\"UIVoiceStringYanChi\");\n                    soundName = [playerSex,\"_FastVoice_10\"].join(\"\");\n                    break;\n                default:\n                    this.ErrLog(\"Event_chatmessage not find(%s)\",quickID);\n                }\n        }\n        else{\n            switch (quickID){\n                case 101:\n                    path = \"face1Action\";\n                    break;\n                case 102:\n                    path = \"face2Action\";\n                    break;\n                case 103:\n                    path = \"face3Action\";\n                    break;\n                case 104:\n                    path = \"face4Action\";\n                    break;\n                case 105:\n                    path = \"face5Action\";\n                    break;\n                case 106:\n                    path = \"face6Action\";\n                    break;\n                case 107:\n                    path = \"face7Action\";\n                    break;\n                case 108:\n                    path = \"face8Action\";\n                    break;\n                case 109:\n                    path = \"face9Action\";\n                    break;\n                case 110:\n                    path = \"face10Action\";\n                    break;\n                case 111:\n                    path = \"face11Action\";\n                    break;\n                case 112:\n                    path = \"face12Action\";\n                    break;\n                case 113:\n                    path = \"face13Action\";\n                    break;\n                case 114:\n                    path = \"face14Action\";\n                    break;\n                case 115:\n                    path = \"face15Action\";\n                break;\n                default:\n                    this.ErrLog(\"Event_chatmessage not find(%s)\",quickID);\n            }\n        }\n        let data = {};\n        data.content = content;\n        data.soundName = soundName;\n        data.path = path;\n        return data;\n\t},\n\t//-----------------发包接口----------------------------\n})\n\nvar g_ChatManager = null;\n\n\n/**\n * 绑定模块外部方法\n */\nexports.GetModel = function(){\n\tif(!g_ChatManager){\n\t\tg_ChatManager = new ChatManager();\n\t}\n\treturn g_ChatManager;\n}"]}