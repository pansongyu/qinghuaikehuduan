{"version":3,"sources":["UIUserInfo.js"],"names":["app","require","cc","Class","extends","properties","sp_head","Sprite","label_name","Label","label_id","label_gold","label_roomCard","label_clubCard","label_ip","label_gps","sp_female","sp_ip","Node","sp_gps","icon_roomCard","icon_coin","icon_clubCard","sp_boy","SpriteFrame","sp_girl","itemsNode","editBox","EditBox","btnCopyNode","OnCreateInit","RegEvent","Event_PlayerAddress","ReqIP","pos","heroIp","OnEvt_ShowInfoDistance","OnEvt_CopyTextNtf","Event_OnUploadImage","WeChatManager","node","on","EditBoxChangeCB","Event_HeroProperty","EditBoxEndCB","string","event","argDict","pid","address","replace","subIndex","indexOf","substring","error","ErrLog","ShowFastCount","ShowRoomCard","ShowClubCard","OnShow","isMobile","HeroAccountManager","GetAccountProperty","active","ShowHero_NameOrID","sys","isNative","ShowEditName","ShowLabelName","ShowSex","SetGiftBtnInteractable","getChildByName","getComponent","HeroManager","GetHeroProperty","ShowPlayerAddress","that","sendPack","NetManager","SendPack","success","detail","locationInfo","Address","updateTime","now","Math","floor","Date","getTime","bEnable","items","children","i","length","btn","Button","interactable","ShowPlayerInfo","room","roomPosMgr","GetRoomPosMgr","allPlayerInfo","GetRoomAllPlayerInfo","GetRoomProperty","playerInfo","ComTool","GetBeiZhuName","GetPid","SetShowIDNode","undefined","WeChatHeadImage1","ShowHeroHead","RoomMgr","GetEnterRoom","distance","parseInt","toString","GetClientPos","gold","heroRoomCard","heroClubCard","heroID","heroName","sex","ShareDefine","HeroSex_Boy","spriteFrame","OnGiftClick","typeJinBi","target","typeCard","label","num","card","ShowSysMsg","itemName","name","data","roomID","productId","substr","CloseForm","code","msg","uploadImgURL","InitHeroHeadImage","SysNotifyManager","Client","OnEvent","console","log","OnClick","btnName","btnNode","str","argList","promisefunc","resolve","reject","NativeManager","CallToNative","bluebird","SetHeroProperty","GetClientConfigProperty"],"mappings":"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","file":"UIUserInfo.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\ui","sourcesContent":["var app = require(\"app\");\ncc.Class({\n    extends: require(\"BaseForm\"),\n\n    properties: {\n        sp_head:cc.Sprite,\n        label_name:cc.Label,\n        label_id:cc.Label,\n        label_gold:cc.Label,\n        label_roomCard:cc.Label,\n        label_clubCard:cc.Label,\n        label_ip:cc.Label,\n        label_gps:cc.Label,\n        sp_female:cc.Sprite,\n        sp_ip:cc.Node,\n        sp_gps:cc.Node,\n        icon_roomCard:cc.Node,\n        icon_coin:cc.Node,\n        icon_clubCard:cc.Node,\n        sp_boy:cc.SpriteFrame,\n        sp_girl:cc.SpriteFrame,\n        itemsNode:cc.Node,\n        editBox:cc.EditBox,\n        btnCopyNode:cc.Node,\n    },\n\n    OnCreateInit: function () {\n        this.RegEvent(\"EVT_PlayerAddress\", this.Event_PlayerAddress);\n        this.ReqIP();\n        this.pos=-1;\n        this.heroIp=0;\n        this.RegEvent(\"SHOWINFODISTANCE\", this.OnEvt_ShowInfoDistance);\n        this.RegEvent(\"OnCopyTextNtf\", this.OnEvt_CopyTextNtf);\n        this.RegEvent(\"OnUploadImage\", this.Event_OnUploadImage, this);\n        // let Gifts = app.SysDataManager().GetTableDict(\"Gift\");\n        // this.giftCfg = [];\n        // for(let key in Gifts){\n        //     let itemNode = cc.instantiate(this.itemPrefab);\n        //     itemNode.name = 'item' + key;\n        //     itemNode.on('click',this.OnGiftClick,this);\n\n        //     let typeStr = 'type' + Gifts[key].Type;\n        //     let typeNode = itemNode.getChildByName(typeStr);\n        //     let numLabel = typeNode.getChildByName('label').getComponent(cc.Label);\n        //     numLabel.string = Gifts[key].Num;\n        //     //typeNode.active = true;\n        //     typeNode.active = false;\n        //     this.itemsNode.addChild(itemNode);\n        //     let imgPath = 'texture/gift/' + Gifts[key].ImageName;\n        //     let iconPath = 'ScrollView/items/' + itemNode.name + '/item_icon'\n        //     this.SetWndImageByFilePath(iconPath,imgPath);\n        // }\n        this.WeChatManager = app.WeChatManager();\n        this.editBox.node.on('editing-did-ended',this.EditBoxChangeCB,this);\n        this.RegEvent(\"HeroProperty\", this.Event_HeroProperty);\n    },\n    EditBoxEndCB:function(){\n        this.editBox.string = this.label_id.string;\n    },\n    Event_PlayerAddress:function(event){\n        let argDict = event;\n        let pid = argDict['pid'];\n        let address = argDict['address'];\n        address = address.replace('/','');\n        try{\n            let subIndex = address.indexOf(':');\n            if(-1 != subIndex)\n                address = address.substring(0,subIndex);\n        }\n        catch(error){\n            this.ErrLog('Address sub error address : ' + address);\n        }\n        this.label_ip.string = address;\n        this.heroIp = address;\n    },\n    Event_HeroProperty:function (event) {\n        let argDict = event;\n        if(argDict[\"Property\"] == \"gold\"){\n            this.ShowFastCount();\n        }\n        else if(argDict[\"Property\"] == \"roomCard\"){\n            this.ShowRoomCard();\n        }else if(argDict[\"Property\"] == \"clubCard\"){\n            this.ShowClubCard();\n        }\n    },\n    OnShow: function (pos=-1) {\n//        app.LocationMgr().setType(\"userinfo\");\n        this.pos = pos;\n        if(pos<0){\n            this.isMobile = app.HeroAccountManager().GetAccountProperty(\"isMobile\");\n            //this.icon_coin.active = true;\n            this.icon_coin.active = false;\n            this.icon_roomCard.active = true;\n            this.icon_clubCard.active = false;\n            this.sp_gps.active = false;\n            this.itemsNode.active = false;\n            this.ShowHero_NameOrID();\n            this.ShowFastCount();\n            this.ShowRoomCard();\n            this.ShowClubCard();\n            if(this.isMobile==1 || !cc.sys.isNative){\n                this.ShowEditName();\n            }else{\n                this.ShowLabelName();\n            }\n        }else{\n            this.isMobile=0;\n            this.sp_gps.active = true;\n            this.icon_roomCard.active = false;\n            this.icon_coin.active = false;\n            this.icon_clubCard.active = false;\n            this.itemsNode.active = true;\n            \n        }\n        this.ShowSex();\n        this.SetGiftBtnInteractable(this.sp_gps.active);\n    },\n    ShowLabelName:function(){\n        this.node.getChildByName(\"EditBox\").active=false;\n        this.node.getChildByName(\"btn_save\").active=false;\n        this.node.getChildByName(\"label_name\").active=true;\n    },\n    ShowEditName:function(){\n        this.node.getChildByName(\"EditBox\").active=true;\n        this.node.getChildByName(\"EditBox\").getComponent(cc.EditBox).string=app.HeroManager().GetHeroProperty(\"name\");\n        this.node.getChildByName(\"btn_save\").active=true;\n        this.node.getChildByName(\"label_name\").active=false;\n    },\n    ShowPlayerAddress:function(pid){\n        if(pid>0){\n            let that=this;\n            let sendPack={\"pid\":pid};\n            app.NetManager().SendPack(\"game.CPlayerLocationInfo\",sendPack,function(success){\n                let detail=success.locationInfo;\n                let address=detail.Address;\n                let updateTime=detail.updateTime;\n                let now=Math.floor(new Date().getTime()/1000);\n                if(now-updateTime>10800){\n                    //3小时内的定位有效\n                    that.label_gps.string =\"未知地址\";\n                    return;\n                }\n                if(address){\n                    that.label_gps.string =\"地址:\"+address;\n                }else{\n                    that.label_gps.string =\"未知地址\";\n                }\n                \n            },function(error){\n                //全部定位获取失败\n                that.label_gps.string =\"未知地址\";\n            });\n        }else{\n            this.label_gps.string =\"未知地址\";\n        }\n        //显示用户ip\n    //    this.SendHttpRequest('http://fb.qicaiqh.com/myip.php', \"?Sign=ddcat\", \"GET\",{});\n    },\n    /*SendHttpRequest:function(serverUrl, argString, requestType, sendPack){\n\n        var url = [serverUrl, argString].join(\"\")\n\n        var dataStr = JSON.stringify(sendPack);\n\n        //每次都实例化一个，否则会引起请求结束，实例被释放了\n        var httpRequest = new XMLHttpRequest();\n\n        httpRequest.timeout = 2000;\n\n\n        httpRequest.open(requestType, url, true);\n        //服务器json解码\n        httpRequest.setRequestHeader(\"Content-Type\", \"application/json\");\n        var that = this;\n        httpRequest.onerror = function(){\n            that.ErrLog(\"httpRequest.error:%s\", url);\n            that.OnConnectHttpFail(serverUrl, httpRequest.readyState, httpRequest.status);\n        };\n        httpRequest.ontimeout = function(){\n            \n        };\n        httpRequest.onreadystatechange = function(){\n\n            //执行成功\n            if (httpRequest.status == 200){\n                if(httpRequest.readyState == 4){\n                    that.OnReceiveHttpPack(serverUrl, httpRequest.responseText);\n                }\n            }\n            else{\n                that.OnConnectHttpFail(serverUrl, httpRequest.readyState, httpRequest.status);\n                that.ErrLog(\"onreadystatechange(%s,%s)\", httpRequest.readyState, httpRequest.status);\n            }\n        };\n        httpRequest.send(dataStr);\n\n    },\n    OnReceiveHttpPack:function(serverUrl, httpResText){\n        try{\n            let serverPack = JSON.parse(httpResText);\n            if(serverPack[\"IsSuccess\"] == 1){\n                this.sp_ip.getChildByName('label_IP').getComponent(cc.Label).string=serverPack.myip;\n            }\n            else{\n               this.sp_ip.getChildByName('label_IP').getComponent(cc.Label).string='未知ip';\n            }\n        }\n        catch (error){\n            this.sp_ip.getChildByName('label_IP').getComponent(cc.Label).string='未知ip';\n        }\n    },\n    OnConnectHttpFail:function(serverUrl, readyState, status){\n       this.sp_ip.getChildByName('label_IP').getComponent(cc.Label).string='未知ip';\n    },*/\n    SetGiftBtnInteractable:function(bEnable){\n        let items = this.itemsNode.children;\n        for(let i=0;i<items.length;i++){\n            let btn = items[i].getComponent(cc.Button);\n            if(btn)\n                btn.interactable = bEnable;\n        }\n    },\n    ShowPlayerInfo:function(room){\n        let roomPosMgr = room.GetRoomPosMgr();\n        let allPlayerInfo = null;\n        if(roomPosMgr)\n            allPlayerInfo = roomPosMgr.GetRoomAllPlayerInfo();\n        else\n            allPlayerInfo = room.GetRoomProperty('posList');\n        let playerInfo = allPlayerInfo[this.pos];\n        this.label_name.string = this.ComTool.GetBeiZhuName(playerInfo[\"pid\"],playerInfo[\"name\"],9);\n        this.label_id.string = this.ComTool.GetPid(playerInfo[\"pid\"]);\n        this.editBox.string = this.label_id.string;\n        this.SetShowIDNode();\n        if(playerInfo[\"playerIP\"]==undefined){\n            this.label_ip.string=\"ip获取失败\"\n        }else{\n            this.label_ip.string = playerInfo[\"playerIP\"];  \n        }\n        let WeChatHeadImage1 = this.sp_head.getComponent(\"WeChatHeadImage\");\n        WeChatHeadImage1.ShowHeroHead(playerInfo[\"pid\"]);\n\n    },\n    //显示距离\n    OnEvt_ShowInfoDistance:function(event){\n        let room = this.RoomMgr.GetEnterRoom();\n        let roomPosMgr = room.GetRoomPosMgr();\n        let distance = parseInt(event[\"distance\"].toString());\n        if(event[\"pos1\"]==roomPosMgr.GetClientPos()&&event[\"pos2\"]==this.pos){\n            this.label_gps.string = \"您距\"+ this.label_name.string +\"的距离：\"+ distance +\"米\";\n        }else if(event[\"pos2\"]==roomPosMgr.GetClientPos()&&event[\"pos1\"]==this.pos){\n            this.label_gps.string = \"您距\"+ this.label_name.string +\"的距离：\"+ distance +\"米\";\n        }\n    },\n    ReqIP:function(){\n        app.NetManager().SendPack('game.CPlayerAddress', {});\n    },\n    ShowFastCount:function () {\n        //let fastCard = app.HeroManager().GetHeroProperty(\"fastCard\");\n        let gold = app.HeroManager().GetHeroProperty('gold');\n        this.label_gold.string = gold;\n    },\n    ShowRoomCard:function () {\n        let heroRoomCard = app.HeroManager().GetHeroProperty(\"roomCard\");\n        this.label_roomCard.string = heroRoomCard;\n    },\n    ShowClubCard:function(){\n        let heroClubCard = app.HeroManager().GetHeroProperty(\"clubCard\");\n        this.label_clubCard.string = heroClubCard;\n    },\n    ShowHero_NameOrID:function () {\n        let heroID = app.HeroManager().GetHeroProperty(\"pid\");\n        let heroName = app.HeroManager().GetHeroProperty(\"name\");\n        this.label_name.string =this.ComTool.GetBeiZhuName(heroID,heroName);\n        this.label_id.string =this.ComTool.GetPid(heroID);// app.i18n.t(\"UIMain_PIDText\",{\"pid\":this.ComTool.GetPid(heroID)});\n        this.editBox.string = this.label_id.string;\n        let WeChatHeadImage1 = this.sp_head.getComponent(\"WeChatHeadImage\");\n        WeChatHeadImage1.ShowHeroHead(heroID);\n        this.SetShowIDNode();\n    },\n    ShowSex:function(){\n    \tlet sex = -1;\n        if(-1 == this.pos)\n            sex = app.HeroAccountManager().GetAccountProperty(\"Sex\");\n        else{\n            let room = this.RoomMgr.GetEnterRoom();\n            sex = room.GetRoomProperty('posList')[this.pos].sex;\n        }\n    \tif (sex == app.ShareDefine().HeroSex_Boy) {\n    \t\tthis.sp_female.spriteFrame = this.sp_boy;\n    \t} else {\n    \t\tthis.sp_female.spriteFrame = this.sp_girl;\n    \t}\n    },\n    OnGiftClick:function(event){\n        if(-1 == this.pos)\n            return;\n        if(!this.RoomMgr)\n            return;\n        let room = this.RoomMgr.GetEnterRoom();\n        if(!room)\n            return;\n        let typeJinBi = event.target.getChildByName('type1');\n        let typeCard = event.target.getChildByName('type6');\n        let label = null;\n        let num = 0;\n        let gold = app.HeroManager().GetHeroProperty('gold');\n        let card = app.HeroManager().GetHeroProperty(\"roomCard\");\n        if(typeJinBi.active){\n            label = typeJinBi.getChildByName('label').getComponent(cc.Label);\n            num = parseInt(label.string);\n            if(num > gold){\n                this.ShowSysMsg(\"WarnFastGoldNotEnough\");\n                return;\n            }\n        }\n        else if(typeCard.active){\n            label = typeCard.getChildByName('label').getComponent(cc.Label);\n            num = parseInt(label.string);\n            if(num > card){\n                this.ShowSysMsg(\"WarnFastCardNotEnough\");\n                return;\n            }\n        }\n\n        let itemName = event.target.name;\n        let data = {};\n        data.roomID = room.GetRoomProperty(\"roomID\");\n        data.pos = this.pos;\n        data.productId = parseInt(itemName.substr(('item').length));\n        app.NetManager().SendPack('game.CPlayerSendGift', data);\n        this.CloseForm();\n    },\n    SetShowIDNode:function(){\n        if(cc.sys.isNative){\n            this.label_id.node.active = true;\n            this.editBox.node.active = false;\n            //this.btnCopyNode.active = true;\n        }\n        else{\n            this.label_id.node.active = false;\n            this.editBox.node.active = true;\n            this.btnCopyNode.active = false;\n        }\n    },\n    OnEvt_CopyTextNtf:function(event){\n        if(0 == event.code)\n            this.ShowSysMsg(\"已复制ID：\"+event.msg);\n        else\n            this.ShowSysMsg(\"复制失败\");\n    },\n    Event_OnUploadImage:function(event){\n        let heroID=app.HeroManager().GetHeroProperty(\"pid\");\n        let uploadImgURL=event.uploadImgURL;\n        this.WeChatManager.InitHeroHeadImage(heroID,uploadImgURL);\n        let WeChatHeadImage1 = this.sp_head.getComponent(\"WeChatHeadImage\");\n        WeChatHeadImage1.ShowHeroHead(heroID);\n        //保存头像给服务端\n        app.NetManager().SendPack(\"player.CPlayerChangeNameAndHeadImg\", {\"name\":'',\"headImg\":uploadImgURL}, function(event){\n            app.SysNotifyManager().ShowSysMsg(\"修改成功\",[],3);\n            app.Client.OnEvent(\"HeroProperty\",{\"Property\":'headimg'});\n         }, function(event){\n                console.log(\"头像保存失败\");\n            }\n        );\n    },\n    OnClick:function(btnName, btnNode){\n        if('btn_copy' == btnName){\n            let str = this.label_id.string;\n            if(cc.sys.isNative){\n                let argList = [{\"Name\":\"msg\",\"Value\":str.toString()}];\n                let promisefunc = function(resolve, reject){\n                    app.NativeManager().CallToNative(\"copyText\", argList);\n                };\n                return new app.bluebird(promisefunc);\n            }\n            else{\n                \n            }\n        }else if(\"btn_save\"==btnName){\n            //保存名字\n            let name=this.node.getChildByName(\"EditBox\").getComponent(cc.EditBox).string;\n            if(name==\"\"){\n                 app.SysNotifyManager().ShowSysMsg(\"请输入名字\",[],3);\n            }\n            app.NetManager().SendPack(\"player.CPlayerChangeNameAndHeadImg\", {\"name\":name,\"headImg\":''}, function(event){\n                app.HeroManager().SetHeroProperty(\"name\",name);\n                app.SysNotifyManager().ShowSysMsg(\"修改成功\",[],3);\n                //刷新大厅名字\n                app.Client.OnEvent(\"HeroProperty\",{\"Property\":'name',\"name\":name});\n            }, function(event){\n                    console.log(\"名字保存失败\");\n               }\n            );\n        }else if(\"btn_head\"){\n            console.log(\"btn_head isMobile:\"+this.isMobile);\n            if(this.isMobile!=1){\n                return;\n            }\n            let uploadImgURL = app.Client.GetClientConfigProperty(\"uploadImgURL\");\n            let argList = [{\"Name\":\"uploadImgURL\", \"Value\":uploadImgURL}];\n            app.NativeManager().CallToNative(\"openPhotoAlbum\", argList);\n        }\n    },\n});\n"]}