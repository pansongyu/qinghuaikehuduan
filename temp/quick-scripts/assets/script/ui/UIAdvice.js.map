{"version":3,"sources":["UIAdvice.js"],"names":["app","require","cc","Class","extends","properties","OnCreateInit","NetManager","AdviceUrl","OnShow","playerID","HeroManager","GetHeroProperty","click_btn_tijiao","toggleGroup","node","getChildByName","stype","getComponent","Toggle","isChecked","proposal","EditBox","string","phone","ShowSysMsg","date","Date","year","getFullYear","month","getMonth","day","getDate","signString","toString","sign","MD5","hex_md5","SendHttpRequest","encodeURI","OnReceiveHttpPack","serverUrl","httpResText","serverPack","JSON","parse","code","CloseForm","error","OnConnectHttpFail","readyState","status","OnClick","btnName","btnNode"],"mappings":"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","file":"UIAdvice.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\ui","sourcesContent":["/*\n UIYinSiZhenCe 登陆界面\n */\nvar app = require(\"app\");\ncc.Class({\n    extends: require(\"BaseForm\"),\n\n    properties: {\n    },\n    OnCreateInit: function () {\n        this.NetManager = app.NetManager();\n        this.AdviceUrl=\"http://qh.qinghuaimajiang.com/proposal/\";\n    },\n\n    OnShow:function () {\n        this.playerID = app.HeroManager().GetHeroProperty(\"pid\"); \n    },\n    click_btn_tijiao:function(){\n        let toggleGroup=this.node.getChildByName(\"ToggleContainer\");\n        let stype=0;\n        if(toggleGroup.getChildByName(\"toggle1\").getComponent(cc.Toggle).isChecked==true){\n            stype=1;\n        }else if(toggleGroup.getChildByName(\"toggle2\").getComponent(cc.Toggle).isChecked==true){\n            stype=2;\n        }else if(toggleGroup.getChildByName(\"toggle3\").getComponent(cc.Toggle).isChecked==true){\n            stype=3;\n        }\n        let proposal=this.node.getChildByName(\"EditBoxContent\").getComponent(cc.EditBox).string;\n        let phone=this.node.getChildByName(\"EditBoxPhone\").getComponent(cc.EditBox).string;\n        if(proposal==\"\"){\n            this.ShowSysMsg(\"请点击输入框填写您宝贵的意见或建议\");\n            return;\n        }\n\n        //找后台验证实名信息是否合法\n        var date = new Date();\n        let year=date.getFullYear();\n        let month=date.getMonth()+1;\n        let day=date.getDate();\n        if(month<10){\n            month=\"0\"+month;\n        }\n        if(day<10){\n            day=\"0\"+day;\n        }\n\n        let signString = this.playerID.toString()+stype.toString()+\"wanzi\"+year.toString()+month.toString()+day.toString();\n        let sign = app.MD5.hex_md5(signString);\n        this.SendHttpRequest(this.AdviceUrl, \"?stype=\"+stype+\"&proposal=\"+encodeURI(proposal)+\"&playerid=\"+this.playerID+\"&phone=\"+phone+\"&sign=\"+sign, \"GET\",{});\n\n\n\n    },\n    OnReceiveHttpPack:function(serverUrl, httpResText){\n        try{\n            let serverPack = JSON.parse(httpResText);\n            if(serverUrl==this.AdviceUrl){\n               if(serverPack.code==200){\n                  //认证成功\n                  this.ShowSysMsg(\"保存成功，非常感觉您的意见建议\");\n                  this.CloseForm();\n               }else if(serverPack.code==300){\n                   this.ShowSysMsg(\"保存失败!请稍后重试\");\n                   return;\n               }else if(serverPack.code==301){\n                   this.ShowSysMsg(\"玩家id，状态，投诉内容缺一不可！\");\n                   return;\n               }else if(serverPack.code==302){\n                   this.ShowSysMsg(\"签名错误！\");\n                   return;\n               }\n            }\n        }\n        catch (error){\n            \n        }\n    },\n    OnConnectHttpFail:function(serverUrl, readyState, status){\n        \n    },\n    //---------点击函数---------------------\n    OnClick:function(btnName, btnNode){\n        if(btnName==\"btn_tijiao\"){\n            this.click_btn_tijiao();\n        }else if(btnName==\"btn_close\"){\n            this.CloseForm();\n        }\n    },\n});\n"]}