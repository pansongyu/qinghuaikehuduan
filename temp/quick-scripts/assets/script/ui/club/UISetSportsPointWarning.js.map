{"version":3,"sources":["UISetSportsPointWarning.js"],"names":["app","require","cc","Class","extends","properties","OnCreateInit","OnShow","data","lb_tip","node","getChildByName","getComponent","Label","isPersonal","string","name","clubId","clubSign","EditBox","sportsPointWarning","InitShareType","warnStatus","isChange","SetIsChange","SetNotChange","ToggleContainer","Toggle","isChecked","GetShareType","toggle1","OnClick","btnName","btnNode","percentStr","ComTool","StrIsNum","sendPack","ClubManager","GetUnionSendPackHead","pid","value","parseFloat","self","NetManager","SendPack","serverPack","SysNotifyManager","ShowSysMsg","CloseForm","opClubId","opPid","createId","ErrLog"],"mappings":"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","file":"UISetSportsPointWarning.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\script\\ui\\club","sourcesContent":["var app = require(\"app\");\ncc.Class({\n    extends: require(\"BaseForm\"),\n\n    properties: {\n\n    },\n\n    OnCreateInit: function () {\n\n    },\n    OnShow: function (data) {\n        this.data = data;\n        let lb_tip = this.node.getChildByName(\"lb_tip\").getComponent(cc.Label);\n        if (typeof(data.isPersonal) != \"undefined\" && data.isPersonal) {\n            //个人的\n             lb_tip.string = \"设置预警值后，该玩家【\"+data.name+\"】比赛分低于预警值将无法游戏\";\n        }else if (typeof(data.clubId) == \"undefined\") {\n            //推广员的\n            lb_tip.string = \"设置预警值后，该推广员（含分支下所有玩家）的总比塞分低于预警值，则该推广员及分支下所有玩家将被禁止游戏\";\n        }else{\n            //赛事的\n            lb_tip.string = \"设置预警值后，该亲友圈【\"+data.name+\"(\"+data.clubSign+\")\"+\"】内所有玩家的总比赛分低于预警值，则该亲友圈的玩家将被禁止游戏\";\n        }\n        this.node.getChildByName(\"PercentEditBox\").getComponent(cc.EditBox).string =this.data.sportsPointWarning;\n        this.InitShareType(data.warnStatus);\n        //初始化比赛分输入框\n        this.isChange=false;\n    },\n    SetIsChange:function(){\n        this.isChange=true;\n    },\n    SetNotChange:function(){\n        this.isChange=true;\n    },\n    InitShareType:function(warnStatus){\n        let ToggleContainer=this.node.getChildByName(\"ToggleContainer\");\n        if(warnStatus==0){\n            ToggleContainer.getChildByName(\"toggle1\").getComponent(cc.Toggle).isChecked=false;\n            ToggleContainer.getChildByName(\"toggle2\").getComponent(cc.Toggle).isChecked=true;\n        }else{\n            ToggleContainer.getChildByName(\"toggle1\").getComponent(cc.Toggle).isChecked=true;\n            ToggleContainer.getChildByName(\"toggle2\").getComponent(cc.Toggle).isChecked=false;\n        }\n    },\n    GetShareType:function(){\n        let ToggleContainer=this.node.getChildByName(\"ToggleContainer\");\n        let toggle1=ToggleContainer.getChildByName(\"toggle2\").getComponent(cc.Toggle).isChecked;\n        if(toggle1){\n            return 0;\n        }\n        return 1;\n    },\n    OnClick:function(btnName, btnNode){\n        if(btnName == \"btn_sure\"){\n            //预警值\n            let warnStatus=this.GetShareType();\n            let percentStr =this.node.getChildByName(\"PercentEditBox\").getComponent(cc.EditBox).string;\n            \n            if (app.ComTool().StrIsNum(percentStr)) {\n                let sendPack = app.ClubManager().GetUnionSendPackHead();\n                if (typeof(this.data.isPersonal) != \"undefined\" && this.data.isPersonal) {\n                    //个人的\n                    sendPack.pid = this.data.pid;\n                    sendPack.value = parseFloat(percentStr);\n                    sendPack.warnStatus=warnStatus;\n                    let self = this;\n                    app.NetManager().SendPack(\"club.CClubPersonalSportsPointWarningChange\",sendPack, function(serverPack){\n                        app.SysNotifyManager().ShowSysMsg(\"成功设置预警值\",[],3);\n                        self.CloseForm();\n                    }, function(){\n                        app.SysNotifyManager().ShowSysMsg(\"设置预警值失败\",[],3);\n                    });\n                }else if (typeof(this.data.clubId) == \"undefined\") {\n                    sendPack.pid = this.data.pid;\n                    sendPack.value = parseFloat(percentStr);\n                    sendPack.warnStatus=warnStatus;\n                    let self = this;\n                    app.NetManager().SendPack(\"club.CClubSportsPointWarningChange\",sendPack, function(serverPack){\n                        app.SysNotifyManager().ShowSysMsg(\"成功设置预警值\",[],3);\n                        self.CloseForm();\n                    }, function(){\n                        app.SysNotifyManager().ShowSysMsg(\"设置预警值失败\",[],3);\n                    });\n                }else{\n                    sendPack.opClubId = this.data.clubId;\n                    sendPack.opPid = this.data.createId;\n                    sendPack.value = parseFloat(percentStr);\n                    sendPack.warnStatus=warnStatus;\n                    let self = this;\n                    app.NetManager().SendPack(\"union.CUnionSportsPointWarningChange\",sendPack, function(serverPack){\n                        app.SysNotifyManager().ShowSysMsg(\"成功设置预警值\",[],3);\n                        self.CloseForm();\n                    }, function(){\n                        app.SysNotifyManager().ShowSysMsg(\"设置预警值失败\",[],3);\n                    });\n                }\n            }else{\n                app.SysNotifyManager().ShowSysMsg(\"请输入纯数字\",[],3);\n            }\n        }else if(btnName == \"btn_close\"){\n            this.CloseForm();\n        }else{\n            this.ErrLog(\"OnClick(%s) not find\", btnName);\n        }\n    },\n\n});\n"]}