{"version":3,"sources":["UIForbidUserList.js"],"names":["app","require","cc","Class","extends","properties","memberlist_scrollView","ScrollView","memberlist_layout","Node","memberlist_demo","OnCreateInit","WeChatManager","OnShow","clubId","groupingId","unionId","active","node","getChildByName","GetMemberList","self","NetManager","SendPack","serverPack","player","ShowMemberList","error","DestroyAllChildren","i","length","isBan","nodePrefab","instantiate","addChild","pid","getComponent","Label","string","ComTool","GetBeiZhuName","name","i18n","t","GetPid","WeChatHeadImage","heroID","headImageUrl","InitHeroHeadImage","OnLoad","ShowHeroHead","ReShowData","FormManager","IsFormShow","GetFormComponentByFormName","ShowForbid","Client","OnEvent","OnClick","btnName","btnNode","CloseForm","parent","removeFromParent","destroy","ShowForm","ErrLog"],"mappings":"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","file":"UIForbidUserList.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\script\\ui\\club","sourcesContent":["/*\n    UIMessage 模态消息界面\n*/\n\nvar app = require(\"app\");\n\ncc.Class({\n    extends: require(\"BaseForm\"),\n\n    properties: {\n    \tmemberlist_scrollView:cc.ScrollView,\n    \tmemberlist_layout:cc.Node,\n    \tmemberlist_demo:cc.Node,\n    },\n\n    //初始化\n    OnCreateInit:function(){\n        this.WeChatManager=app.WeChatManager();\n    },\n    //---------显示函数--------------------\n\n    OnShow:function(clubId,groupingId,unionId = 0){\n        this.clubId=clubId;\n        this.groupingId=groupingId;\n        this.unionId = unionId;\n        this.memberlist_demo.active=false;\n        if (this.unionId > 0) {\n            this.node.getChildByName(\"btn_addByPid\").active = true;\n        }else{\n            this.node.getChildByName(\"btn_addByPid\").active = true;\n        }\n    \tthis.GetMemberList();\n    },\n    GetMemberList:function(){\n        let self=this;\n        if (this.unionId > 0) {\n            app.NetManager().SendPack('union.CUnionGroupingMemberList',{'unionId':this.unionId,'clubId':this.clubId,\"groupingId\":this.groupingId},function(serverPack){\n                    self.player=serverPack;\n                    self.ShowMemberList();\n                },function(error){\n            });\n        }else{\n            app.NetManager().SendPack('club.CClubGroupingMemberList',{'clubId':this.clubId,\"groupingId\":this.groupingId},function(serverPack){\n                    self.player=serverPack;\n                    self.ShowMemberList();\n                },function(error){\n            });\n        }\n    },\n    ShowMemberList:function(){\n        this.DestroyAllChildren(this.memberlist_layout);\n        for(let i=0;i<this.player.length;i++){\n            let player=this.player[i].player;\n            let isBan=this.player[i].isBan;\n            \n            let nodePrefab = cc.instantiate(this.memberlist_demo);\n            nodePrefab.active=true;\n            this.memberlist_layout.addChild(nodePrefab);\n\n            nodePrefab.pid=player.pid;\n            nodePrefab.clubId=this.clubId;\n            nodePrefab.groupingId=this.groupingId;\n\n            nodePrefab.getChildByName('name').getComponent(cc.Label).string=this.ComTool.GetBeiZhuName(player.pid,player.name);\n            nodePrefab.getChildByName('id').getComponent(cc.Label).string=app.i18n.t(\"UIMain_PIDText\",{\"pid\":this.ComTool.GetPid(player.pid)});\n            let WeChatHeadImage = nodePrefab.getChildByName('head').getComponent(\"WeChatHeadImage\");\n            //用户头像创建\n            let heroID = player[\"pid\"];\n            let headImageUrl = player[\"iconUrl\"];\n            if(heroID && headImageUrl){\n                this.WeChatManager.InitHeroHeadImage(heroID, headImageUrl);\n            }\n            WeChatHeadImage.OnLoad();\n                        WeChatHeadImage.ShowHeroHead(heroID,headImageUrl);\n            if(isBan==true || typeof(isBan) == \"undefined\"){\n                nodePrefab.getChildByName('btn_add').active=false;\n                nodePrefab.getChildByName('btn_del').active=true;\n            }else{\n                nodePrefab.getChildByName('btn_add').active=true;\n                nodePrefab.getChildByName('btn_del').active=false;\n            }\n        }\n    },\n    //---------点击函数---------------------\n    ReShowData:function(){\n        if(this.FormManager.IsFormShow(\"ui/club/UIClubForbid\")){\n            this.FormManager.GetFormComponentByFormName(\"ui/club/UIClubForbid\").ShowForbid();\n        }\n        app.Client.OnEvent('OnUnionForbidReShow', null);\n    },\n\tOnClick:function(btnName, btnNode){\n        let self=this;\n\t\tif('btn_close'==btnName){\n        \tthis.CloseForm();\n        }else if('btn_add'==btnName){\n            if (this.unionId == 0) {\n                app.NetManager().SendPack('club.CClubGroupingPidAdd',{'clubId':btnNode.parent.clubId,\"groupingId\":btnNode.parent.groupingId,\"pid\":btnNode.parent.pid},function(serverPack){\n                    let parent=btnNode.parent;\n                    parent.getChildByName('btn_del').active=true;\n                    parent.getChildByName('btn_add').active=false;\n                    self.ReShowData();\n                    },function(error){\n                });\n            }\n        }else if('btn_del'==btnName){\n            if (this.unionId == 0) {\n                app.NetManager().SendPack('club.CClubGroupingPidRemove',{'clubId':btnNode.parent.clubId,\"groupingId\":btnNode.parent.groupingId,\"pid\":btnNode.parent.pid},function(serverPack){\n                    let parent=btnNode.parent;\n                    parent.getChildByName('btn_del').active=false;\n                    parent.getChildByName('btn_add').active=true;\n                    self.ReShowData();\n                    },function(error){\n                });\n            }else{\n                app.NetManager().SendPack('union.CUnionGroupingPidRemove',{'unionId':this.unionId,'clubId':btnNode.parent.clubId,\"groupingId\":btnNode.parent.groupingId,\"pid\":btnNode.parent.pid},function(serverPack){\n                    let parent=btnNode.parent;\n                    parent.removeFromParent();\n                    parent.destroy();\n                    self.ReShowData();\n                },function(error){\n                    \n                });\n            }\n        }else if('btn_addByPid'==btnName){\n            app.FormManager().ShowForm('ui/club/UIForbidAddUser',this.unionId,this.clubId,this.groupingId);\n        }else{\n\t\t\tthis.ErrLog(\"OnClick:%s not find\", btnName);\n\t\t}\n\t},\n});\n"]}