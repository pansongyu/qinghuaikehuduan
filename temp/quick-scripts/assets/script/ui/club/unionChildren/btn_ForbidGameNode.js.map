{"version":3,"sources":["btn_ForbidGameNode.js"],"names":["app","require","cc","Class","extends","Component","properties","onLoad","ComTool","Client","RegEvent","Event_UnionForbidGameReShow","InitData","clubId","unionId","curPage","lastPage","queryStr","node","getChildByName","getComponent","EditBox","string","lb_page","Label","GetPalyerList","isRefresh","sendPack","ClubManager","GetUnionSendPackHead","pageNum","query","GetBeiZhuID","self","NetManager","SendPack","serverPack","length","UpdateScrollView","SysNotifyManager","ShowSysMsg","GetNextPage","memberScrollView","content","ScrollView","scrollToTop","removeAllChildren","demo","active","i","isExist","j","children","pid","child","instantiate","playerData","userNameTemp","name","substr","headImageUrl","WeChatManager","InitHeroHeadImage","WeChatHeadImage","OnLoad","ShowHeroHead","addChild","OnClick_BtnWnd","eventTouch","eventData","SoundManager","PlaySound","btnNode","currentTarget","btnName","OnClick","error","console","log","stack","FormManager","ShowForm","parent","SetWaitForConfirm","msgID","type","msgArgs","cbArgs","ConfirmManager","SetWaitForConfirmForm","OnConFirm","bind","ShowConfirm","clickType"],"mappings":";;;;;;AAAA,IAAIA,MAAMC,QAAQ,KAAR,CAAV;AACAC,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY,EAHP;AAMLC,YAAO,kBAAU;AACb,aAAKC,OAAL,GAAaR,IAAIQ,OAAJ,EAAb;AACAR,YAAIS,MAAJ,CAAWC,QAAX,CAAoB,yBAApB,EAA+C,KAAKC,2BAApD,EAAiF,IAAjF;AACH,KATI;AAULC,cAAS,kBAAUC,MAAV,EAAkBC,OAAlB,EAA2B;AAChC,aAAKD,MAAL,GAAcA,MAAd;AACA,aAAKC,OAAL,GAAeA,OAAf;AACA,aAAKC,OAAL,GAAe,CAAf;AACA,aAAKC,QAAL,GAAgB,CAAhB;AACA,aAAKC,QAAL,GAAgB,EAAhB;AACA,aAAKC,IAAL,CAAUC,cAAV,CAAyB,eAAzB,EAA0CC,YAA1C,CAAuDlB,GAAGmB,OAA1D,EAAmEC,MAAnE,GAA4E,EAA5E;AACA;AACA,YAAIC,UAAU,KAAKL,IAAL,CAAUC,cAAV,CAAyB,MAAzB,EAAiCA,cAAjC,CAAgD,SAAhD,CAAd;AACAI,gBAAQH,YAAR,CAAqBlB,GAAGsB,KAAxB,EAA+BF,MAA/B,GAAwC,KAAKP,OAA7C;AACA,aAAKU,aAAL,CAAmB,IAAnB;AACH,KArBI;AAsBLA,mBAAc,yBAAyB;AAAA,YAAhBC,SAAgB,uEAAN,KAAM;;AACnC,YAAIC,WAAW3B,IAAI4B,WAAJ,GAAkBC,oBAAlB,EAAf;AACAF,iBAASG,OAAT,GAAmB,KAAKf,OAAxB;AACAY,iBAASI,KAAT,GAAiB/B,IAAIQ,OAAJ,GAAcwB,WAAd,CAA0B,KAAKf,QAA/B,CAAjB;AACA,YAAIgB,OAAO,IAAX;AACAjC,YAAIkC,UAAJ,GAAiBC,QAAjB,CAA0B,+BAA1B,EAA0DR,QAA1D,EAAoE,UAASS,UAAT,EAAoB;AACpF,gBAAIA,WAAWC,MAAX,GAAoB,CAAxB,EAA2B;AACvBJ,qBAAKK,gBAAL,CAAsBF,UAAtB,EAAiCV,SAAjC;AACA;AACA,oBAAIH,UAAUU,KAAKf,IAAL,CAAUC,cAAV,CAAyB,MAAzB,EAAiCA,cAAjC,CAAgD,SAAhD,CAAd;AACAI,wBAAQH,YAAR,CAAqBlB,GAAGsB,KAAxB,EAA+BF,MAA/B,GAAwCW,KAAKlB,OAA7C;AACH,aALD,MAKK;AACDkB,qBAAKlB,OAAL,GAAekB,KAAKjB,QAApB;AACH;AACJ,SATD,EASG,YAAU;AACThB,gBAAIuC,gBAAJ,GAAuBC,UAAvB,CAAkC,cAAlC,EAAiD,EAAjD,EAAoD,CAApD;AACH,SAXD;AAYH,KAvCI;AAwCLC,iBAAY,uBAAU;AACrB,aAAK1B,OAAL;AACA,aAAKU,aAAL,CAAmB,KAAnB;AACA,KA3CI;AA4CLa,sBAAiB,0BAASF,UAAT,EAAqBV,SAArB,EAA+B;AAC/C,YAAIgB,mBAAmB,KAAKxB,IAAL,CAAUC,cAAV,CAAyB,kBAAzB,CAAvB;AACA,YAAIwB,UAAUD,iBAAiBvB,cAAjB,CAAgC,MAAhC,EAAwCA,cAAxC,CAAuD,SAAvD,CAAd;AACA,YAAIO,SAAJ,EAAe;AACdgB,6BAAiBtB,YAAjB,CAA8BlB,GAAG0C,UAAjC,EAA6CC,WAA7C;AACAF,oBAAQG,iBAAR;AACA;AACD,YAAIC,OAAO,KAAK7B,IAAL,CAAUC,cAAV,CAAyB,MAAzB,CAAX;AACA4B,aAAKC,MAAL,GAAc,KAAd;AACA,aAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIb,WAAWC,MAA/B,EAAuCY,GAAvC,EAA4C;AACrC;AACA,gBAAIC,UAAU,KAAd;AACA,iBAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIR,QAAQS,QAAR,CAAiBf,MAArC,EAA6Cc,GAA7C,EAAkD;AAC9C,oBAAIR,QAAQS,QAAR,CAAiBD,CAAjB,EAAoBE,GAApB,IAA2BjB,WAAWa,CAAX,EAAcI,GAA7C,EAAkD;AAC9CH,8BAAU,IAAV;AACA;AACH;AACJ;AACD,gBAAIA,OAAJ,EAAa;AACnB,gBAAII,QAAQpD,GAAGqD,WAAH,CAAeR,IAAf,CAAZ;AACGO,kBAAMD,GAAN,GAAYjB,WAAWa,CAAX,EAAcI,GAA1B;AACAC,kBAAME,UAAN,GAAmBpB,WAAWa,CAAX,CAAnB;AACG,gBAAIQ,eAAerB,WAAWa,CAAX,EAAcS,IAAjC;AACA,gBAAID,aAAapB,MAAb,IAAuB,CAA3B,EAA8B;AAC1BoB,+BAAerB,WAAWa,CAAX,EAAcS,IAAd,CAAmBC,MAAnB,CAA0B,CAA1B,EAA4B,CAA5B,IAAiC,KAAhD;AACH;AACJL,kBAAMnC,cAAN,CAAqB,aAArB,EAAoCC,YAApC,CAAiDlB,GAAGsB,KAApD,EAA2DF,MAA3D,GAAoEmC,YAApE;AACAH,kBAAMnC,cAAN,CAAqB,WAArB,EAAkCC,YAAlC,CAA+ClB,GAAGsB,KAAlD,EAAyDF,MAAzD,GAAkEc,WAAWa,CAAX,EAAcI,GAAhF;AACG,gBAAIO,eAAexB,WAAWa,CAAX,EAAcW,YAAjC;AACA,gBAAGA,YAAH,EAAgB;AACZ5D,oBAAI6D,aAAJ,GAAoBC,iBAApB,CAAsC1B,WAAWa,CAAX,EAAcI,GAApD,EAAyDO,YAAzD;AACA,oBAAIG,kBAAkBT,MAAMnC,cAAN,CAAqB,MAArB,EAA6BC,YAA7B,CAA0C,iBAA1C,CAAtB;AACA2C,gCAAgBC,MAAhB;AACAD,gCAAgBE,YAAhB,CAA6B7B,WAAWa,CAAX,EAAcI,GAA3C,EAA+CO,YAA/C;AACH;;AAEPN,kBAAMN,MAAN,GAAe,IAAf;AACAL,oBAAQuB,QAAR,CAAiBZ,KAAjB;AACA;AACD,KAnFI;AAoFL3C,iCAA4B,qCAASyB,UAAT,EAAoB;AAC5C,aAAKrB,OAAL,GAAe,CAAf;AACA,aAAKE,QAAL,GAAgB,EAAhB;AACA,aAAKC,IAAL,CAAUC,cAAV,CAAyB,eAAzB,EAA0CC,YAA1C,CAAuDlB,GAAGmB,OAA1D,EAAmEC,MAAnE,GAA4E,EAA5E;AACA;AACA,YAAIC,UAAU,KAAKL,IAAL,CAAUC,cAAV,CAAyB,MAAzB,EAAiCA,cAAjC,CAAgD,SAAhD,CAAd;AACAI,gBAAQH,YAAR,CAAqBlB,GAAGsB,KAAxB,EAA+BF,MAA/B,GAAwC,KAAKP,OAA7C;AACA,aAAKU,aAAL,CAAmB,IAAnB;AACH,KA5FI;AA6FL;AACA0C,oBAAe,wBAASC,UAAT,EAAqBC,SAArB,EAA+B;AAC1C,YAAG;AACCrE,gBAAIsE,YAAJ,GAAmBC,SAAnB,CAA6B,UAA7B;AACA,gBAAIC,UAAUJ,WAAWK,aAAzB;AACA,gBAAIC,UAAUF,QAAQd,IAAtB;AACA,iBAAKiB,OAAL,CAAaD,OAAb,EAAsBF,OAAtB;AACH,SALD,CAMA,OAAOI,KAAP,EAAa;AACTC,oBAAQC,GAAR,CAAY,oBAAkBF,MAAMG,KAApC;AACH;AACJ,KAxGI;AAyGLJ,aAAQ,iBAASD,OAAT,EAAkBF,OAAlB,EAA0B;AACjC,YAAG,cAAYE,OAAf,EAAuB;AAChB,iBAAK1D,QAAL,GAAgB,KAAKD,OAArB;AACA,iBAAKA,OAAL;AACA,iBAAKU,aAAL,CAAmB,IAAnB;AACH,SAJJ,MAKQ,IAAG,cAAYiD,OAAf,EAAuB;AACxB,gBAAG,KAAK3D,OAAL,IAAc,CAAjB,EAAmB;AACf;AACH;AACD,iBAAKC,QAAL,GAAgB,KAAKD,OAArB;AACA,iBAAKA,OAAL;AACA,iBAAKU,aAAL,CAAmB,IAAnB;AACH,SAPI,MAOC,IAAG,mBAAiBiD,OAApB,EAA4B;AAC9B1E,gBAAIgF,WAAJ,GAAkBC,QAAlB,CAA2B,6BAA3B,EAAyD,KAAKnE,OAA9D,EAAsE,KAAKD,MAA3E;AACH,SAFK,MAEA,IAAG,gBAAc6D,OAAjB,EAAyB;AAC9B,iBAAKzD,QAAL,GAAgBuD,QAAQU,MAAR,CAAe9D,YAAf,CAA4BlB,GAAGmB,OAA/B,EAAwCC,MAAxD;AACG,iBAAKP,OAAL,GAAe,CAAf;AACA,iBAAKC,QAAL,GAAgB,CAAhB;AACH,iBAAKS,aAAL,CAAmB,IAAnB;AACA,SALK,MAKA,IAAI,sBAAoBiD,OAAxB,EAAiC;AACnC,gBAAIlB,aAAagB,QAAQU,MAAR,CAAe1B,UAAhC;AACA,gBAAI7B,WAAW3B,IAAI4B,WAAJ,GAAkBC,oBAAlB,EAAf;AACAF,qBAAS0B,GAAT,GAAeG,WAAWH,GAA1B;AACA,gBAAIpB,OAAO,IAAX;AACAjC,gBAAIkC,UAAJ,GAAiBC,QAAjB,CAA0B,iCAA1B,EAA4DR,QAA5D,EAAsE,UAASS,UAAT,EAAoB;AACtF,oBAAIM,mBAAmBT,KAAKf,IAAL,CAAUC,cAAV,CAAyB,kBAAzB,CAAvB;AACA,oBAAIwB,UAAUD,iBAAiBvB,cAAjB,CAAgC,MAAhC,EAAwCA,cAAxC,CAAuD,SAAvD,CAAd;AACAuB,iCAAiBtB,YAAjB,CAA8BlB,GAAG0C,UAAjC,EAA6CC,WAA7C;AACAF,wBAAQG,iBAAR;AACAb,qBAAKR,aAAL,CAAmB,IAAnB;AACAzB,oBAAIuC,gBAAJ,GAAuBC,UAAvB,CAAkC,UAAlC,EAA6C,EAA7C,EAAgD,CAAhD;AACH,aAPD,EAOG,YAAU;AACTxC,oBAAIuC,gBAAJ,GAAuBC,UAAvB,CAAkC,UAAlC,EAA6C,EAA7C,EAAgD,CAAhD;AACH,aATD;AAUH;AACJ,KA7II;AA8IL;;;;;AAKA2C,uBAAkB,2BAASC,KAAT,EAAeC,IAAf,EAAyC;AAAA,YAArBC,OAAqB,uEAAb,EAAa;AAAA,YAAVC,MAAU,uEAAH,EAAG;;AACvD,YAAIC,iBAAiBxF,IAAIwF,cAAJ,EAArB;AACAA,uBAAeC,qBAAf,CAAqC,KAAKC,SAAL,CAAeC,IAAf,CAAoB,IAApB,CAArC,EAAgEP,KAAhE,EAAuEG,MAAvE;AACAC,uBAAeI,WAAf,CAA2BP,IAA3B,EAAiCD,KAAjC,EAAwCE,OAAxC;AACH,KAvJI;AAwJLI,eAAU,mBAASG,SAAT,EAAoBT,KAApB,EAA2BG,MAA3B,EAAkC;AACxC,YAAG,UAAUM,SAAb,EAAuB;AACnB;AACH;AACJ;AA5JI,CAAT","file":"btn_ForbidGameNode.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\script\\ui\\club\\unionChildren","sourcesContent":["var app = require(\"app\");\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n\n    },\n    onLoad:function(){\n        this.ComTool=app.ComTool();\n        app.Client.RegEvent(\"OnUnionForbidGameReShow\", this.Event_UnionForbidGameReShow, this);\n    },\n    InitData:function (clubId, unionId) {\n        this.clubId = clubId;\n        this.unionId = unionId;\n        this.curPage = 1;\n        this.lastPage = 1;\n        this.queryStr = \"\";\n        this.node.getChildByName(\"searchEditBox\").getComponent(cc.EditBox).string = \"\";\n        //刷新页数\n        let lb_page = this.node.getChildByName(\"page\").getChildByName(\"lb_page\");\n        lb_page.getComponent(cc.Label).string = this.curPage;\n        this.GetPalyerList(true);\n    },\n    GetPalyerList:function(isRefresh=false){\n        let sendPack = app.ClubManager().GetUnionSendPackHead();\n        sendPack.pageNum = this.curPage;\n        sendPack.query = app.ComTool().GetBeiZhuID(this.queryStr);\n        let self = this;\n        app.NetManager().SendPack(\"union.CUnionBanGamePlayerList\",sendPack, function(serverPack){\n            if (serverPack.length > 0) {\n                self.UpdateScrollView(serverPack,isRefresh);\n                //刷新页数\n                let lb_page = self.node.getChildByName(\"page\").getChildByName(\"lb_page\");\n                lb_page.getComponent(cc.Label).string = self.curPage;\n            }else{\n                self.curPage = self.lastPage;\n            }\n        }, function(){\n            app.SysNotifyManager().ShowSysMsg(\"获取禁止游戏成员列表失败\",[],3);\n        });\n    },\n    GetNextPage:function(){\n    \tthis.curPage++;\n    \tthis.GetPalyerList(false);\n    },\n    UpdateScrollView:function(serverPack, isRefresh){\n    \tlet memberScrollView = this.node.getChildByName(\"memberScrollView\");\n    \tlet content = memberScrollView.getChildByName(\"view\").getChildByName(\"content\");\n    \tif (isRefresh) {\n    \t\tmemberScrollView.getComponent(cc.ScrollView).scrollToTop();\n    \t\tcontent.removeAllChildren();\n    \t}\n    \tlet demo = this.node.getChildByName(\"demo\");\n    \tdemo.active = false;\n    \tfor (let i = 0; i < serverPack.length; i++) {\n            //先判断下是否已经存在,对于有可能从前面插入数据的需要差重\n            let isExist = false;\n            for (let j = 0; j < content.children.length; j++) {\n                if (content.children[j].pid == serverPack[i].pid) {\n                    isExist = true;\n                    break;\n                }\n            }\n            if (isExist) continue;\n    \t\tlet child = cc.instantiate(demo);\n\t        child.pid = serverPack[i].pid;\n\t        child.playerData = serverPack[i];\n            let userNameTemp = serverPack[i].name;\n            if (userNameTemp.length >= 4) {\n                userNameTemp = serverPack[i].name.substr(0,8) + \"...\";\n            }\n\t        child.getChildByName(\"lb_userName\").getComponent(cc.Label).string = userNameTemp;\n\t        child.getChildByName(\"lb_userId\").getComponent(cc.Label).string = serverPack[i].pid;\n            let headImageUrl = serverPack[i].headImageUrl;\n            if(headImageUrl){\n                app.WeChatManager().InitHeroHeadImage(serverPack[i].pid, headImageUrl);\n                let WeChatHeadImage = child.getChildByName('head').getComponent(\"WeChatHeadImage\");\n                WeChatHeadImage.OnLoad();\n                WeChatHeadImage.ShowHeroHead(serverPack[i].pid,headImageUrl);\n            }\n            \n    \t\tchild.active = true;\n    \t\tcontent.addChild(child);\n    \t}\n    },\n    Event_UnionForbidGameReShow:function(serverPack){\n        this.curPage = 1;\n        this.queryStr = \"\";\n        this.node.getChildByName(\"searchEditBox\").getComponent(cc.EditBox).string = \"\";\n        //刷新页数\n        let lb_page = this.node.getChildByName(\"page\").getChildByName(\"lb_page\");\n        lb_page.getComponent(cc.Label).string = this.curPage;\n        this.GetPalyerList(true);\n    },\n    //控件点击回调\n    OnClick_BtnWnd:function(eventTouch, eventData){\n        try{\n            app.SoundManager().PlaySound(\"BtnClick\");\n            let btnNode = eventTouch.currentTarget;\n            let btnName = btnNode.name;\n            this.OnClick(btnName, btnNode);\n        }\n        catch (error){\n            console.log(\"OnClick_BtnWnd:\"+error.stack);\n        }\n    },\n    OnClick:function(btnName, btnNode){\n    \tif('btn_next'==btnName){\n            this.lastPage = this.curPage;\n            this.curPage++;\n            this.GetPalyerList(true);\n        }\n        else if('btn_last'==btnName){\n            if(this.curPage<=1){\n                return;\n            }\n            this.lastPage = this.curPage;\n            this.curPage--;\n            this.GetPalyerList(true);\n        }else if('btn_addMember'==btnName){\n            app.FormManager().ShowForm(\"ui/club/UIForbidGameAddUser\",this.unionId,this.clubId);\n        }else if('btn_search'==btnName){\n        \tthis.queryStr = btnNode.parent.getComponent(cc.EditBox).string;\n            this.curPage = 1;\n            this.lastPage = 1;\n        \tthis.GetPalyerList(true);\n        }else if ('btn_cancelForbid'==btnName) {\n            let playerData = btnNode.parent.playerData;\n            let sendPack = app.ClubManager().GetUnionSendPackHead();\n            sendPack.pid = playerData.pid;\n            let self = this;\n            app.NetManager().SendPack(\"union.CUnionBanGamePlayerDelete\",sendPack, function(serverPack){\n                let memberScrollView = self.node.getChildByName(\"memberScrollView\");\n                let content = memberScrollView.getChildByName(\"view\").getChildByName(\"content\");\n                memberScrollView.getComponent(cc.ScrollView).scrollToTop();\n                content.removeAllChildren();\n                self.GetPalyerList(true);\n                app.SysNotifyManager().ShowSysMsg(\"成功取消禁止游戏\",[],3);\n            }, function(){\n                app.SysNotifyManager().ShowSysMsg(\"取消禁止游戏失败\",[],3);\n            });\n        }\n    },\n    /**\n     * 2次确认点击回调\n     * @param curEventType\n     * @param curArgList\n     */\n    SetWaitForConfirm:function(msgID,type,msgArgs=[],cbArgs=[]){\n        let ConfirmManager = app.ConfirmManager();\n        ConfirmManager.SetWaitForConfirmForm(this.OnConFirm.bind(this), msgID, cbArgs);\n        ConfirmManager.ShowConfirm(type, msgID, msgArgs);\n    },\n    OnConFirm:function(clickType, msgID, cbArgs){\n        if('Sure' != clickType){\n            return;\n        }\n    },\n});"]}