{"version":3,"sources":["UIChouJiangShare.js"],"names":["app","require","cc","Class","extends","properties","qian","Node","ledou","fangka","lb_fangka","Label","lb_qian","lb_ledou","touxiang","erweima","OnCreateInit","SDKManager","WeChatHeadImage","getChildByName","getComponent","Event_ChouJiangShareSuccess","FormManager","CloseForm","ShowOneJiangLi","type","num","luckSpr","active","Sprite","spriteFrame","string","OnShow","shareObj","shareType","qianSpr","fangkaSpr","ledouSpr","that","heroID","HeroManager","GetHeroProperty","shareUrl","ComTool","GetPid","imgUrl","loader","load","url","err","texture","Texture2D","frame","SpriteFrame","ErrLog","heroName","OnLoad","ShowHeroHead","scheduleOnce","ShareScreen","ShareScreenDD","ShareScreenMW"],"mappings":"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","file":"UIChouJiangShare.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\ui","sourcesContent":["/*\n    UIMessage 模态消息界面\n*/\n\nvar app = require(\"app\");\n\ncc.Class({\n    extends: require(\"BaseForm\"),\n\n    properties: {\n        \n        qian:cc.Node,\n        ledou:cc.Node,\n        fangka:cc.Node,\n\n        lb_fangka:cc.Label,\n        lb_qian:cc.Label,\n        lb_ledou:cc.Label,\n\n        touxiang:cc.Node,\n\n        erweima:cc.Node,\n\n    },\n\n    //初始化\n    OnCreateInit:function(){\n        this.SDKManager = app.SDKManager();\n        this.WeChatHeadImage = this.touxiang.getChildByName('head_img').getComponent(\"WeChatHeadImage\");\n       \n    },\n    Event_ChouJiangShareSuccess:function(){\n        app.FormManager().CloseForm(\"UIAudio\");\n    },\n    //---------显示函数--------------------\n    ShowOneJiangLi:function(type,num,luckSpr){\n        if(type==2){\n            //钻石\n            this.fangka.active=true;\n            this.fangka.getChildByName(\"icon\").getComponent(cc.Sprite).spriteFrame = luckSpr;\n            this.lb_fangka.string='X'+num;\n        }else if(type==1){\n            //乐豆\n            this.ledou.active=true;\n            this.ledou.getChildByName(\"icon\").getComponent(cc.Sprite).spriteFrame = luckSpr;\n            this.lb_ledou.string='X'+num;\n        }else if(type==8){\n             //话钱\n            this.qian.active=true;\n            this.qian.getChildByName(\"icon\").getComponent(cc.Sprite).spriteFrame = luckSpr;\n            this.lb_qian.string=num+'元';\n        }\n    },\n    OnShow:function(shareObj,shareType){\n        this.fangka.active=false;\n        this.ledou.active=false;\n        this.qian.active=false;\n        this.shareType = shareType;\n        if(shareObj.qian>0){\n            this.ShowOneJiangLi(8,shareObj.qian,shareObj.qianSpr);\n        }\n        if(shareObj.fangka>0){\n            this.ShowOneJiangLi(2,shareObj.fangka,shareObj.fangkaSpr);\n        }\n        if(shareObj.ledou){\n            this.ShowOneJiangLi(1,shareObj.ledou,shareObj.ledouSpr);\n        }\n\n\n        let that=this;\n        let heroID = app.HeroManager().GetHeroProperty(\"pid\"); \n        let shareUrl=\"http://fb.qicaiqh.com/\"+this.ComTool.GetPid(heroID)+\"/\";\n        let imgUrl = \"http://fb.qicaiqh.com/makeQRcode.php?url=\" + shareUrl;\n        cc.loader.load({url:imgUrl,type: 'png'},function (err, texture) {\n                if(texture instanceof cc.Texture2D){\n                    var frame = new cc.SpriteFrame(texture);\n                    that.erweima.getComponent(cc.Sprite).spriteFrame=frame;\n                }\n                else{\n                    that.ErrLog(\"texture not Texture2D\");\n                }\n        });\n\n        let heroName = app.HeroManager().GetHeroProperty(\"name\");\n        this.touxiang.getChildByName('lb_name').getComponent(cc.Label).string = heroName;\n        this.WeChatHeadImage.OnLoad();\n                        WeChatHeadImage.ShowHeroHead(heroID);\n        this.scheduleOnce(this.ShareScreen,1);\n    },\n    ShareScreen:function(){\n        if (this.shareType == 1) {\n            this.SDKManager.ShareScreen('1');\n        }else if (this.shareType == 2) {\n            this.SDKManager.ShareScreenDD();\n        }else if (this.shareType == 3) {\n            this.SDKManager.ShareScreenMW();\n        }\n        \n        this.scheduleOnce(this.CloseForm,3.5);\n    },\n});\n"]}