{"version":3,"sources":["UISign.js"],"names":["app","require","cc","Class","extends","properties","icon_ledou","SpriteFrame","icon_zuanshi","layout","Node","btn_lingqu","Button","jiangli","OnCreateInit","FormManager","signin","SysDataManager","GetTableDict","OnShow","active","ReSetLingQu","that","NetManager","SendPack","event","signCount","isTodaySign","signDay","SetWndImageByFilePath","interactable","i","node","getChildByName","loginNum","loginnum","key","day","Day","type","Type","uniformitemId","UniformitemId","UniCount","Count","ShowJiangLi","count","getComponent","Label","string","Sprite","spriteFrame","OnClick","btnName","eventData","SysNotifyManager","ShowSysMsg","CloseForm","ErrLog"],"mappings":"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","file":"UISign.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\ui","sourcesContent":["/*\n    UIMessage 模态消息界面\n*/\n\nvar app = require(\"app\");\n\ncc.Class({\n    extends: require(\"BaseForm\"),\n\n    properties: {\n        icon_ledou:cc.SpriteFrame, \n        icon_zuanshi:cc.SpriteFrame,\n        layout:cc.Node,\n        btn_lingqu:cc.Button,\n        jiangli:cc.Node,\n    },\n    //初始化\n    OnCreateInit:function(){\n        this.FormManager=app.FormManager();\n        this.signin = this.SysDataManager.GetTableDict(\"signin\");\n    },\n    OnShow:function(){\n    \tthis.jiangli.active=false;\n        this.ReSetLingQu();\n        let that=this;\n        app.NetManager().SendPack(\"game.CPlayerSign\",{\"type\":1}, function(event){\n            let signCount=event.signCount-1;\n            let isTodaySign=event.isTodaySign;\n            \n            that.signDay=signCount;\n            if(isTodaySign){//true为已今日已领取\n                that.SetWndImageByFilePath('btn_lingqu','texture/sign/btn_lingqu02');\n                that.btn_lingqu.interactable = false;\n            }else{\n                that.SetWndImageByFilePath('btn_lingqu','texture/sign/btn_lingqu');\n                that.btn_lingqu.interactable = true;\n            }\n            if(signCount>0){\n                for(let i=1;i<=signCount;i++){\n                    let node=that.layout.getChildByName('day'+i);\n                    node.getChildByName('zhezhao').active=true;\n                }\n            }\n        }, function(){});\n    },\n    ReSetLingQu:function(loginNum){\n        this.loginnum=loginNum;\n        for(let key in this.signin){\n            let day = this.signin[key].Day;\n            let type=this.signin[key].Type;\n            let uniformitemId = this.signin[key].UniformitemId;\n            if(type=='SignIn'){\n                let UniCount=this.signin[key].Count;\n                this.ShowJiangLi(day,UniCount,uniformitemId);\n            }\n        }\n    },\n    ShowJiangLi:function(day,count,uniformitemId){\n        let node=this.layout.getChildByName('day'+day);\n        if(node){\n            node.getChildByName('num').getComponent(cc.Label).string=\"x\"+count;\n            if(uniformitemId == 1){\n                node.getChildByName('icon').getComponent(cc.Sprite).spriteFrame=this.icon_ledou;\n            }\n            else{\n                node.getChildByName('icon').getComponent(cc.Sprite).spriteFrame=this.icon_zuanshi;\n            }\n           \n            node.getChildByName(\"zhezhao\").active=false;\n        }\n    },\n    //---------点击函数---------------------\n\tOnClick:function(btnName, eventData){\n        if('btn_lingqu' == btnName){\n\t        if(!this.signDay>=7){\n\t        \treturn;\n\t        }\n\t        let that=this;\n\t        app.NetManager().SendPack(\"game.CPlayerSign\",{\"type\":2}, function(event){\n\t\t            for(let key in that.signin){\n\t\t\t            let day = that.signin[key].Day;\n                        let type=that.signin[key].Type;\n                        let uniformitemId = that.signin[key].UniformitemId;\n\t\t\t            if(type=='SignIn' && day==(that.signDay+1)){\n                            let UniCount=that.signin[key].Count;\n                            if(uniformitemId == 1){\n                                that.jiangli.getChildByName('bg_icon').getChildByName('icon').getComponent(cc.Sprite).spriteFrame=that.icon_ledou;\n                            }\n                            else{\n                                that.jiangli.getChildByName('bg_icon').getChildByName('icon').getComponent(cc.Sprite).spriteFrame=that.icon_zuanshi;\n                            }\n\t\t\t            \tthat.jiangli.getChildByName('lb_num').getComponent(cc.Label).string='X'+UniCount;\n\t\t\t                that.jiangli.active=true;\n                            that.SetWndImageByFilePath('btn_lingqu','texture/sign/btn_lingqu02');\n                            that.btn_lingqu.interactable = false;\n                            let node=that.layout.getChildByName('day'+(that.signDay+1));\n                            node.getChildByName('zhezhao').active=true;\n\t\t\t            }\n\t\t\t        }\n\t\t      \t}, function(){\n\t\t      \t\tapp.SysNotifyManager().ShowSysMsg(\"已经领取\");\n\t\t      \t});\n        }else if('jiangli'==btnName){\n        \tthis.jiangli.active=false;\n        }\n        else if(btnName == \"btn_close\"){\n            this.CloseForm();\n        }\n\t\telse{\n\t\t\tthis.ErrLog(\"OnClick:%s not find\", btnName);\n\t\t}\n\t},\n});\n"]}