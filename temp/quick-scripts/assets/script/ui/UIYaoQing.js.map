{"version":3,"sources":["UIYaoQing.js"],"names":["app","require","cc","Class","extends","properties","EditBoxID","EditBox","lb_tip","Label","btn_yaoqing","Node","OnCreateInit","WeChatManager","NetManager","RegEvent","Event_CodeError","OnShow","clubId","HeHuoRen","string","active","node","getChildByName","event","codeInfo","ShowSysMsg","ShowUser","data","usernode","heroID","player","headImageUrl","getComponent","ComTool","GetBeiZhuName","name","i18n","t","GetPid","WeChatHeadImage","InitHeroHeadImage","OnLoad","ShowHeroHead","state","ClubManager","Enum_Nomarl","type","click_btn_search","shuru","GetBeiZhuID","isNaN","parseInt","StrIsNum","SysNotifyManager","self","SendPack","serverPack","error","Click_btn_yaoqing","that","sendPack","success","OnClick","btnName","btnNode","CloseForm","ErrLog"],"mappings":"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","file":"UIYaoQing.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\ui","sourcesContent":["var app = require(\"app\");\ncc.Class({\n    extends: require(\"BaseForm\"),\n\n    properties: {\n    \tEditBoxID:cc.EditBox,\n\t\tlb_tip:cc.Label,\n        btn_yaoqing:cc.Node,\n    },\n\n    OnCreateInit: function () {\n        this.WeChatManager=app.WeChatManager();\n        this.NetManager = app.NetManager();\n        this.RegEvent(\"CodeError\", this.Event_CodeError, this);\n        //this.NetManager.RegNetPack(\"game.cplayerrealauthen\", this.OnPack_ShiMing, this);\n    },\n\n    OnShow: function (clubId,HeHuoRen=0) {\n    \tthis.clubId=clubId;\n        this.HeHuoRen=HeHuoRen;\n    \tthis.EditBoxID.string='';\n        this.btn_yaoqing.active = false;\n        this.node.getChildByName('user').active=false;\n        this.lb_tip.string = \"\";\n    },\n    Event_CodeError:function(event){\n        let codeInfo = event;\n        if(codeInfo[\"Code\"] == 5013){\n            this.ShowSysMsg(\"未查找到该玩家\");\n        }else if (codeInfo[\"Code\"] == 6012) {\n            this.ShowSysMsg(\"该玩家已绑定合伙人\");\n        }\n    },\n    ShowUser:function(data){\n        let usernode=this.node.getChildByName('user');\n        usernode.active=true;\n        let heroID = data.player[\"pid\"];\n        usernode.heroID=heroID;\n        let headImageUrl = data.player[\"iconUrl\"];\n        usernode.getChildByName('name').getComponent(cc.Label).string=this.ComTool.GetBeiZhuName(heroID,data.player.name);\n        usernode.getChildByName('id').getComponent(cc.Label).string=app.i18n.t(\"UIMain_PIDText\",{\"pid\":this.ComTool.GetPid(heroID)});\n        let WeChatHeadImage = usernode.getChildByName('head').getComponent(\"WeChatHeadImage\");\n         //用户头像创建\n        if(heroID && headImageUrl){\n            this.WeChatManager.InitHeroHeadImage(heroID, headImageUrl);\n        }\n        WeChatHeadImage.OnLoad();\n                        WeChatHeadImage.ShowHeroHead(heroID);\n        if(this.HeHuoRen==0){\n            if (data.state == app.ClubManager().Enum_Nomarl) {\n                this.lb_tip.string = \"该玩家还不是亲友圈成员，可以邀请玩家进入亲友圈！\";\n                this.btn_yaoqing.active = true;\n            }else{\n                this.lb_tip.string = \"该玩家已经是加入该亲友圈了，无法邀请！\";\n                this.btn_yaoqing.active = false;\n            }\n        }else{\n            if (data.type == 2) {\n                this.lb_tip.string = \"该玩家已绑定了推广员，无需邀请！\";\n                this.btn_yaoqing.active = false;\n            }else if (data.type == 1) {\n                this.lb_tip.string = \"该玩家已在当前亲友圈，无需邀请！\";\n                this.btn_yaoqing.active = false;\n            }else {\n                this.lb_tip.string = \"该玩家不是该亲友圈成员，邀请加入！\";\n                this.btn_yaoqing.active = true;\n            }\n        }\n        \n    },\n    click_btn_search:function(){\n        let shuru = this.ComTool.GetBeiZhuID(this.EditBoxID.string);\n        if(isNaN(parseInt(shuru)) || !app.ComTool().StrIsNum(shuru)){\n            app.SysNotifyManager().ShowSysMsg(\"请输入纯数字的玩家id\", [], 3);\n            return;\n        }\n        let self=this;\n        if(this.HeHuoRen==0){\n            app.NetManager().SendPack('club.CClubFindPIDInfo',{'clubId':this.clubId,\"pid\":shuru},function(serverPack){\n                self.ShowUser(serverPack);\n            },function(error){\n                self.ShowSysMsg(\"未查找到该玩家\");\n            });\n        }else{\n            app.NetManager().SendPack('club.CClubSubordinatePidInfo',{'clubId':this.clubId,\"pid\":shuru},function(serverPack){\n                self.ShowUser(serverPack);\n            },function(error){\n                \n            });\n        }\n        \n    },\n    Click_btn_yaoqing:function(){\n    \tif(this.EditBoxID.string==''){\n    \t\treturn;\n    \t}\n        let that=this;\n        if(this.HeHuoRen==0){\n        \tlet sendPack={\n    \t\t\t\"clubId\":this.clubId,\n    \t\t\t\"pid\":this.EditBoxID.string,\n    \t\t};\n    \t\tthis.NetManager.SendPack(\"club.CClubFindPIDAdd\", sendPack,function(success){\n    \t\t\tthat.ShowSysMsg(\"邀请已发送,等待玩家确认\");\n    \t\t},function(error){\n    \t\t\tthat.ShowSysMsg(\"已邀请或未找到该玩家或同赛事不同亲友圈不能重复拉人或距离退出该亲友圈不到10分钟\");\n    \t\t});\n        }else{\n            let sendPack={\n                \"clubId\":this.clubId,\n                \"partnerPid\":this.HeHuoRen,\n                \"pid\":this.EditBoxID.string,\n            };\n            this.NetManager.SendPack(\"club.CClubSubordinatePidAdd\", sendPack,function(success){\n                that.ShowSysMsg(\"邀请已发送,等待玩家确认\");\n            },function(error){\n                that.ShowSysMsg(\"已邀请或未找到该玩家或同赛事不同亲友圈不能重复拉人或距离退出该亲友圈不到10分钟\");\n            });\n        }\n    },\n    OnClick:function(btnName, btnNode){\n        if(btnName == \"btn_yaoqing\"){\n            this.Click_btn_yaoqing();\n        }else if(btnName == \"btn_search\"){\n            this.click_btn_search();\n        }else if(btnName == \"btn_close\"){\n            this.CloseForm();\n        }else{\n            this.ErrLog(\"OnClick(%s) not find\", btnName);\n        }\n    },\n\n});\n"]}