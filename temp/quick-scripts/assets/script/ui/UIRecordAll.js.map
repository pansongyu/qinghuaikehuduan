{"version":3,"sources":["UIRecordAll.js"],"names":["app","require","cc","Class","extends","properties","UIRecordAll_Child","Prefab","Scrollow","Node","btnNodeGroup","pafabItem","pafabAllItem","lb_page","Label","OnCreateInit","FormManager","ComTool","loopScrollView","getComponent","NetManager","HeroManager","heroID","GetHeroProperty","selectGameType","selectPage","lastSelectPage","OnShow","clubId","unionId","ShowForm","InitgameBtns","Client","GetAllGameId","node","getChildByName","active","ShowRecord","gameType","page","i","children","length","gemePY","ShareDefine","GametTypeID2PinYin","SendPack","OnPack_CPlayerRoomRecord","bind","OnPack_CPlayerRoomRecordFail","serverPack","DestroyAllChildren","gameList","gameIDList","gamePinYin","gameName","GametTypeID2Name","key","instantiate","string","name","addChild","SortRecodeByTime","a","b","endTime","console","log","hasOwnProperty","recodelist","pRoomRecords","sortList","push","sort","everyGameKeys","Object","keys","ScrollViewData","InitScrollData","OnClick","btnName","btnNode","CloseForm","startsWith","replace","toUpperCase","gameID","GametTypeNameDict","ErrLog"],"mappings":"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","file":"UIRecordAll.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\ui","sourcesContent":["/*\n小傅最新修改 2017-10-13 \n */\nvar app = require(\"app\");\ncc.Class({\n    extends: require(\"BaseForm\"),\n\n    properties: {\n        UIRecordAll_Child: cc.Prefab,\n        Scrollow:cc.Node,\n\n        btnNodeGroup:cc.Node,\n        pafabItem:cc.Node,\n        pafabAllItem:cc.Node,\n        lb_page:cc.Label,\n    },\n\n    OnCreateInit: function () {\n       this.FormManager = app.FormManager();\n       this.ComTool = app.ComTool();\n       this.loopScrollView = this.getComponent(\"LoopScrollView\");\n       this.NetManager = app.NetManager();\n       this.HeroManager = app.HeroManager(); \n       this.heroID = app.HeroManager().GetHeroProperty(\"pid\");\n       this.selectGameType = -1;\n       this.selectPage = 1;\n       this.lastSelectPage = 1;\n    },\n    OnShow:function(clubId=0,unionId=0){\n        this.clubId=clubId;\n        this.unionId=unionId;\n        this.FormManager.ShowForm('UITop', \"UIRecordAll\");\n        /*if(0 == clubId){\n            this.NetManager.SendPack(\"game.CPlayerRoomRecord\",{type:1},this.OnPack_CPlayerRoomRecord.bind(this),this.OnPack_CPlayerRoomRecordFail.bind(this));\n        }else{\n            this.NetManager.SendPack(\"club.CClubRoomRecord\",{type:1,clubId:this.clubId},this.OnPack_CPlayerRoomRecord.bind(this),this.OnPack_CPlayerRoomRecordFail.bind(this));\n        }*/\n        // let that=this;\n        // app.NetManager().SendPack('family.CPlayerGameList',{},function(serverPack){\n        //     that.InitgameBtns(serverPack);\n        // },function(serverPack){\n        //     that.InitgameBtns(serverPack);\n        // });\n        this.InitgameBtns({\"gameList\":app.Client.GetAllGameId()});\n        this.node.getChildByName(\"right\").getChildByName(\"btn_tongji\").active=clubId>0;\n    },\n    ShowRecord:function(gameType,page=1){\n        this.selectGameType = gameType;\n        this.selectPage = page;\n        for(let i=0;i<this.btnNodeGroup.children.length;i++){\n            this.btnNodeGroup.children[i].getChildByName('icon').active=false;\n        }\n        if(gameType==-1){\n            this.btnNodeGroup.getChildByName('btn_quanbu').getChildByName('icon').active=true;\n        }else{\n            let gemePY=this.ShareDefine.GametTypeID2PinYin[gameType];\n            this.btnNodeGroup.getChildByName('btn_'+gemePY).getChildByName('icon').active=true;\n        }\n        this.NetManager.SendPack(\"game.CPlayerRoomRecord\",{\"clubId\":this.clubId,'gameType':gameType,'pageNum':page},this.OnPack_CPlayerRoomRecord.bind(this),this.OnPack_CPlayerRoomRecordFail.bind(this));\n    },\n    InitgameBtns:function(serverPack){\n        //this.btnNodeGroup.removeAllChildren();\n        this.DestroyAllChildren(this.btnNodeGroup);\n        this.gameList = {};\n        this.gameList['quanbu']=\"全部\";\n        if(serverPack.gameList && serverPack.gameList!=\"null\"){\n            let gameIDList=serverPack.gameList;\n            for(let i=0;i<gameIDList.length;i++){\n                let gamePinYin=this.ShareDefine.GametTypeID2PinYin[gameIDList[i]];\n                let gameName=this.ShareDefine.GametTypeID2Name[gameIDList[i]];\n                this.gameList[gamePinYin]=gameName;\n            }\n       }else{\n            this.gameList['ddz']='斗地主';\n       }\n       for(let key in this.gameList){\n            let node =null;\n            if(key!='quanbu'){\n                node = cc.instantiate(this.pafabItem);\n                node.getChildByName('icon_off').getComponent(cc.Label).string = this.gameList[key];\n                node.getChildByName('icon').getChildByName('icon_on').getComponent(cc.Label).string = this.gameList[key];\n            }else{\n                node = cc.instantiate(this.pafabAllItem);\n            }\n            node.active = true;\n            node.name = 'btn_' + key;\n            this.btnNodeGroup.addChild(node);\n        }\n        this.ShowRecord(-1);\n\n\n        //this.scroll_Left.scrollToTop();\n    },\n    SortRecodeByTime:function(a,b){\n        // return b.data.endTime - a.data.endTime;\n        return b.endTime - a.endTime;\n    },\n    OnPack_CPlayerRoomRecord:function(serverPack){\n        console.log(\"OnPack_CPlayerRoomRecord serverPack:\",serverPack);\n        if(serverPack.hasOwnProperty('pRoomRecords')){\n            let recodelist=serverPack.pRoomRecords;\n            if (recodelist.length <= 0) {\n                this.selectPage = this.lastSelectPage;\n                return;\n            }\n            app['recodelist']=recodelist;\n            let sortList = [];\n            for(let key in recodelist){\n                sortList.push(recodelist[key]);\n            }\n            sortList.sort(this.SortRecodeByTime);\n            let everyGameKeys = Object.keys(sortList);\n            this.lb_page.string = this.selectPage;\n            this.ScrollViewData(everyGameKeys);\n        }else{\n            this.lb_page.string = \"1\";\n            //this.Scrollow.removeAllChildren();\n            this.DestroyAllChildren(this.Scrollow);\n            return;\n        }\n        \n    },\n    OnPack_CPlayerRoomRecordFail:function(serverPack){\n    \t//this.ScrollViewData({});\n        //this.Scrollow.removeAllChildren();\n        this.DestroyAllChildren(this.Scrollow);\n        return;\n    },\n    ScrollViewData:function(everyGameKeys){\n        this.loopScrollView.InitScrollData(\"UIRecordAll_Child\", this.UIRecordAll_Child, everyGameKeys);\n    },\n    OnClick:function(btnName, btnNode){\n        if(btnName==\"btn_huifang\"){\n            this.FormManager.ShowForm(\"UIReplayCode\");\n        }else if(btnName==\"btn_tongji\"){\n            this.FormManager.ShowForm(\"ui/club/UIClubPlayerRecord\",this.clubId,this.unionId);\n        }else if(btnName==\"btn_close\"){\n            this.CloseForm();\n        }else if(btnName==\"btn_zhanji_next\"){\n            this.lastSelectPage = this.selectPage;\n            this.ShowRecord(this.selectGameType, this.selectPage + 1);\n        }else if(btnName==\"btn_zhanji_last\"){\n            if (this.selectPage <= 1) {\n                return;\n            }\n            this.lastSelectPage = this.selectPage;\n            this.ShowRecord(this.selectGameType, this.selectPage - 1);\n        }else if(btnName.startsWith(\"btn_\")){\n            let gameType=btnName.replace('btn_','');\n            gameType=gameType.toUpperCase();\n            let gameID=-1;\n            if(gameType!='QUANBU' && gameType!='quanbu'){\n                gameID=this.ShareDefine.GametTypeNameDict[gameType];\n            }\n            this.ShowRecord(gameID);\n        }\n        else{\n            this.ErrLog(\"OnClick(%s) not find btnName\",btnName);\n        }\n    },\n});\n"]}