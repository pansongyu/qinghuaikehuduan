{"version":3,"sources":["UIShareImg.js"],"names":["app","require","cc","Class","extends","properties","touxiang","Node","erweima","OnCreateInit","SDKManager","WeChatHeadImage","getChildByName","getComponent","OnShow","heroName","HeroManager","GetHeroProperty","heroID","cityId","weChatAppShareUrl","Client","GetClientConfigProperty","shareUrl","imgUrl","that","loader","load","url","type","err","texture","Texture2D","frame","SpriteFrame","Sprite","spriteFrame","ErrLog","Label","string","OnLoad","ShowHeroHead","scheduleOnce","ShareScreen","CloseForm"],"mappings":";;;;;;AAAA;;;;AAIA,IAAIA,MAAMC,QAAQ,KAAR,CAAV;;AAEAC,GAAGC,KAAH,CAAS;AACLC,aAASH,QAAQ,UAAR,CADJ;;AAGLI,gBAAY;AACRC,kBAASJ,GAAGK,IADJ;AAERC,iBAAQN,GAAGK;AAFH,KAHP;;AAQL;AACAE,kBAAa,wBAAU;AACnB,aAAKC,UAAL,GAAkBV,IAAIU,UAAJ,EAAlB;AACA,aAAKC,eAAL,GAAuB,KAAKL,QAAL,CAAcM,cAAd,CAA6B,UAA7B,EAAyCC,YAAzC,CAAsD,iBAAtD,CAAvB;AAEH,KAbI;AAcLC,YAAO,kBAAU;AACb,YAAIC,WAAWf,IAAIgB,WAAJ,GAAkBC,eAAlB,CAAkC,MAAlC,CAAf;AACA,YAAIC,SAASlB,IAAIgB,WAAJ,GAAkBC,eAAlB,CAAkC,KAAlC,CAAb;AACA,YAAIE,SAAOnB,IAAIgB,WAAJ,GAAkBC,eAAlB,CAAkC,QAAlC,CAAX;AACA,YAAIG,oBAAoBpB,IAAIqB,MAAJ,CAAWC,uBAAX,CAAmC,mBAAnC,CAAxB;;AAGA,YAAIC,WAASH,oBAAkBF,MAAlB,GAAyB,UAAzB,GAAoCC,MAAjD,CAAwD;AACxD,YAAIK,SAAS,8CAA8CD,QAA3D;AACA,YAAIE,OAAO,IAAX;;AAEAvB,WAAGwB,MAAH,CAAUC,IAAV,CAAe,EAACC,KAAIJ,MAAL,EAAYK,MAAM,KAAlB,EAAf,EAAwC,UAAUC,GAAV,EAAeC,OAAf,EAAwB;AACxD,gBAAGA,mBAAmB7B,GAAG8B,SAAzB,EAAmC;AAC/B,oBAAIC,QAAQ,IAAI/B,GAAGgC,WAAP,CAAmBH,OAAnB,CAAZ;AACAN,qBAAKjB,OAAL,CAAaK,YAAb,CAA0BX,GAAGiC,MAA7B,EAAqCC,WAArC,GAAiDH,KAAjD;AACH,aAHD,MAII;AACAR,qBAAKY,MAAL,CAAY,uBAAZ;AACH;AACR,SARD;;AAUA,aAAK/B,QAAL,CAAcM,cAAd,CAA6B,SAA7B,EAAwCC,YAAxC,CAAqDX,GAAGoC,KAAxD,EAA+DC,MAA/D,GAAwExB,QAAxE;AACA,aAAKJ,eAAL,CAAqB6B,MAArB;AACA,aAAK7B,eAAL,CAAqB8B,YAArB,CAAkCvB,MAAlC;AACA,aAAKwB,YAAL,CAAkB,KAAKC,WAAvB,EAAmC,CAAnC;AACH,KAvCI;AAwCLA,iBAAY,uBAAU;AAClB,aAAKjC,UAAL,CAAgBiC,WAAhB,CAA4B,GAA5B;AACA,aAAKD,YAAL,CAAkB,KAAKE,SAAvB,EAAiC,GAAjC;AACH;AA3CI,CAAT","file":"UIShareImg.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\ui","sourcesContent":["/*\n    UIMessage 模态消息界面\n*/\n\nvar app = require(\"app\");\n\ncc.Class({\n    extends: require(\"BaseForm\"),\n\n    properties: {\n        touxiang:cc.Node,\n        erweima:cc.Node,\n    },\n\n    //初始化\n    OnCreateInit:function(){\n        this.SDKManager = app.SDKManager();\n        this.WeChatHeadImage = this.touxiang.getChildByName('head_img').getComponent(\"WeChatHeadImage\");\n       \n    },\n    OnShow:function(){\n        let heroName = app.HeroManager().GetHeroProperty(\"name\");\n        let heroID = app.HeroManager().GetHeroProperty(\"pid\"); \n        let cityId=app.HeroManager().GetHeroProperty(\"cityId\");\n        let weChatAppShareUrl = app.Client.GetClientConfigProperty(\"WeChatAppShareUrl\");  \n\n\n        let shareUrl=weChatAppShareUrl+heroID+\"&cityid=\"+cityId;;\n        let imgUrl = \"http://fb.qicaiqh.com/makeQRcode.php?url=\" + shareUrl;\n        let that = this;\n\n        cc.loader.load({url:imgUrl,type: 'png'},function (err, texture) {\n                if(texture instanceof cc.Texture2D){\n                    var frame = new cc.SpriteFrame(texture);\n                    that.erweima.getComponent(cc.Sprite).spriteFrame=frame;\n                }\n                else{\n                    that.ErrLog(\"texture not Texture2D\");\n                }\n        });\n\n        this.touxiang.getChildByName('lb_name').getComponent(cc.Label).string = heroName;\n        this.WeChatHeadImage.OnLoad();\n        this.WeChatHeadImage.ShowHeroHead(heroID);\n        this.scheduleOnce(this.ShareScreen,1);\n    },\n    ShareScreen:function(){\n        this.SDKManager.ShareScreen('1');\n        this.scheduleOnce(this.CloseForm,3.5);\n    },\n});\n"]}