{"version":3,"sources":["UINoticeBar.js"],"names":["app","require","cc","Class","extends","properties","msg","Node","OnCreateInit","NetManager","speed","msgList","SendPack","GetNoticeMsg","bind","OnShow","argList","Array","prototype","slice","call","arguments","count","runMsg","stopAllActions","length","getComponent","Label","string","node","getChildByName","x","width","y","height","mWidth","moveX","time","self","seq","sequence","moveTo","v2","callFunc","runAction","serverPack","list","alertTime","Math","round","Date","getTime","idx","data","endTime","push","content","clientType","beginTime","checkTime","SysNotifyManager","ShowSysMsg","active"],"mappings":"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","file":"UINoticeBar.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\common","sourcesContent":["/*\n UIDice.js 摇色子界面\n */\n\nvar app = require(\"app\");\n\ncc.Class({\n\textends: require(\"BaseForm\"),\n\n\tproperties: {\n\t\tmsg:cc.Node,\n\t},\n\n\tOnCreateInit:function(){\n\n\t\tthis.NetManager = app.NetManager();\n\t\t\n\t\tthis.speed = 30;\n\n\t\tthis.msgList = [];\n\n\t\tthis.NetManager.SendPack(\"game.CSystemNotice\", {}, this.GetNoticeMsg.bind(this));\n\t},\n\n\tOnShow:function(){\n \n\t\tlet argList = Array.prototype.slice.call(arguments);\n\n\t\tthis.count = 0;\n\n\t\tthis.runMsg();\n\t},\n\n\trunMsg:function(){\n\n\t\tthis.msg.stopAllActions();\n\n\t\tif(!this.msgList.length) return;\n\n\t\tif(this.count >= this.msgList.length){\n\t\t\tthis.count = 0;\n\t\t}\n\n\t\tthis.msg.getComponent(cc.Label).string = this.msgList[this.count];\n\t\t\n\t\tlet node = this.node.getChildByName(\"bg\");\n\n\t\tthis.msg.x = node.width/2 + node.x;\n\t\tthis.msg.y = node.height/2;\n\n\t\tlet mWidth = this.msg.width;\n\n\t\tlet moveX = node.x - node.width/2 - mWidth;\n\n\t\tlet time = (node.width + mWidth)/this.speed;\n\n\t\tlet self = this;\n\n\t\tlet seq = cc.sequence(cc.moveTo(time, cc.v2(moveX,this.msg.y)),cc.callFunc(function(){\n\t\t\tthis.runMsg();\n\t\t}, this));\n\n\t\tthis.msg.runAction(seq);\n\n\t\tthis.count++;\n\t},\n\n\tGetNoticeMsg:function(serverPack){\n\t\tlet list = serverPack;\n\n\t\tif(!list.length) return;\n\n\n\t\tlet alertTime = Math.round(new Date().getTime() / 1000);\n\t\tfor(let idx = 0; idx < list.length; idx++){\n\t\t\tlet data = list[idx];\n\t\t\tlet endTime=data.endTime;\n\n\t\t\tif(alertTime>endTime){\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tthis.msgList.push(data.content);\n\t\t\tif (data.clientType == 3) {\n\t\t\t\tlet beginTime=data.beginTime;\n\t\t\t\tlet checkTime=beginTime-7200;\n\t\t\t\tif(alertTime>checkTime && alertTime<beginTime){\n\t\t\t\t\tapp.SysNotifyManager().ShowSysMsg(data.content);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(this.msgList.length==0){\n\t\t\tthis.node.active=false;\n\t\t}else{\n\t\t\tthis.node.active=true;\n\t\t}\n\n\t\tthis.runMsg();\n\t},\n\n});\n"]}